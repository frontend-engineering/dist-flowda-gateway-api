{"version":3,"file":"main.js","mappings":"iIAAA,UAGO,IAAMA,EAAN,MAAMA,cACX,WAAAC,GAAe,CAGT,EAAAC,G,mDACJ,MAAO,CACLA,GAAI,qBAER,G,GARW,EAAAF,cAAAA,EAIL,eADL,IAAAG,KAAI,S,4JAHMH,EAAa,eADzB,IAAAI,YAAW,S,sCACCJ,E,qGCHb,UACA,UAEA,UACA,UACA,UAiBO,IAAMK,EAAN,MAAMA,YAAA,EAAAA,UAAAA,E,YAAAA,EAAS,eAfrB,IAAAC,QAAO,CACNC,QAAS,CAAC,EAAAC,gBACVC,YAAa,CAAC,EAAAT,eACdU,UAAW,CAMT,CACEC,QAAS,EAAAC,SACTC,SAAU,EAAAC,uBAIHT,E,sFCnBb,gBACA,UAEAU,QAAQC,IAAI,iCACZC,OAAOC,KAAK,EAAAC,oBAAoBC,SAAQC,GAAKN,QAAQC,IAAIK,EAAG,EAAAF,mBAAmBE,MAC/EN,QAAQC,IAAI,iCAEZ,sBAA2BM,GACzBA,EAAUC,KAAK,EAAAC,+BACfF,EAAUG,KAAwC,mBAAmBC,WAAmCC,GAC/FC,GACE,IAAI,EAAAC,OAAOD,IAGxB,C,8HCjBA,UACA,UACA,UACA,UAEa,EAAAE,kBAAoB,IAAI,EAAAC,WACrC,IAAAC,YAAW,EAAAF,mBAEX,MAAMG,GAAW,IAAAC,aAAY,EAAAJ,mBAOtB,IAAMtB,EAAN,MAAMA,eACX,WAAAP,GAAe,GADJ,EAAAO,eAAAA,E,iBAAAA,EAAc,eAL1B,IAAA2B,WACA,IAAA7B,QAAO,CACNI,UAAWuB,EACXG,QAASH,I,sCAEEzB,E,4GCfb,6BACA,0BACA,6BAEa,EAAA6B,iBAAmB,UAAMC,SAEtC,EAAAD,iBAAiBE,aAAaC,QAAQC,KAC9BC,GAAU,EAAD,4CACb,GAAkB,MAAdA,EAAOC,IAAa,OAAOD,EAC/B3B,QAAQ6B,KAAK,eAAgBF,EAAOC,KACpC,MAAOE,EAAMC,GAAQJ,EAAOC,IAAII,MAAM,KAMtC,OALA,UAAQH,KAAK,aAAaF,EAAOM,UAAUH,KAC3C,UAAQD,KAAK,cACb7B,QAAQC,IAAIiC,KAAKC,UAAUC,EAAGC,MAAMN,KACpC,UAAQF,KAAK,cACb7B,QAAQC,IAAIiC,KAAKC,UAAUR,EAAOW,OAC3BX,CACT,MACAY,IACEC,QAAQC,OAAOF,EAAM,IAIzB,EAAAjB,iBAAiBE,aAAakB,SAAShB,KACrCgB,IACE,UAAQb,KAAK,aAAaa,EAASf,OAAOC,OAC1C5B,QAAQC,IAAIiC,KAAKC,UAAUO,EAASJ,OAC7BI,KAET,SAAgBH,G,mDAEd,OAAOC,QAAQC,OAAOF,EACxB,G,iGChCF,gBACA,UAEa,EAAAnC,oBAAqB,IAAAuC,UAASC,QAAQC,IAAK,CACtDC,oBAAqB,EAAAC,EAAEC,SAASC,IAAI,GACpCC,WAAY,EAAAH,EAAEC,SAASC,IAAI,GAC3BE,cAAe,EAAAJ,EAAEC,SAASC,IAAI,GAC9BG,cAAe,EAAAL,EAAEC,SAASC,IAAI,GAC9BI,YAAa,EAAAN,EAAEC,SAASC,IAAI,GAC5BK,YAAa,EAAAP,EAAEC,SAASC,IAAI,I,yGCT9B,gBACA,UACA,UACA,UACA,UACA,UACA,UACA,UAEA,UAEa,EAAAxC,8BAAgC,IAAI,EAAA8C,iBAAgB7C,IAC/DA,EAAoB,EAAA8C,qBAAqBC,gBAAgB,EAAAnC,kBACzDZ,EAAsB,EAAAgD,uBACnBC,GAAG,EAAAC,iBACHC,mBACAC,cAAa,CAAClD,EAASmD,KACtBA,EAAWC,SAAS,CAClB,CACEC,GAAI,aACJpD,KAAM,2BACNqD,aAAc,GAAG,EAAA9D,mBAAmB8C,8BAEtC,CACEe,GAAI,YACJpD,KAAM,+BACNqD,aAAc,GAAG,EAAA9D,mBAAmB+C,oCAEtC,CACEc,GAAI,QACJpD,KAAM,2BACNqD,aAAc,GAAG,EAAA9D,mBAAmBgD,oCAEtC,CACEa,GAAI,cACJpD,KAAM,kBACNqD,aAAc,GAAG,EAAA9D,mBAAmBiD,0BAGjCU,KAEXrD,EAAK,EAAAyD,aAAaC,SAASP,mBAC3BnD,EAAK,EAAA2D,gBAAgBD,SAASP,mBAC9BnD,EAAK,EAAA4D,aAAaF,SAASP,oBAC3B,IAAAU,aAAY7D,EAAM,EAAA8D,WAAW,G,kFC5C/B,0BACA,0BACA,yB,sGCFA,UAEA,UAEa,EAAAC,YAAa,IAAAC,uBAAuC,CAC/DC,MAAO,EACL,IAAAC,eAAc,CACZhD,IAAK,GAAG,EAAAxB,mBAAmB8C,6BACrB,OAAA2B,G,mDACJ,MAAO,CACL,SAAU,iBAEd,G,KAGJC,YAAa,CACXC,MAAO,CAELC,UAAWC,GAAUA,EAErBC,YAAaD,GAAUA,GAEzBE,OAAQ,CAENH,UAAWC,GAAUA,EAErBC,YAAaD,GAAUA,K,iIC1B7B,UACA,UAEA,UACA,UACA,UACA,UACA,UACA,UAmBO,IAAMrB,EAAN,MAAMA,gBAGX,WAAA1E,CAAuCkG,GAoB/B,KAAAC,UAAuB,GAnB7BC,KAAKC,OAASH,EAAcd,EAAYzD,KAC1C,CAEA,QAAAmD,CAASwB,GACHC,MAAMC,QAAQF,GAChBA,EAAKnF,SAAQsF,GAAKL,KAAKM,aAAaD,KAEpCL,KAAKM,aAAaJ,EAEtB,CAEQ,YAAAI,CAAaJ,GACfF,KAAKD,UAAUQ,MAAKF,GAAKA,EAAE1B,KAAOuB,EAAKvB,KACzCqB,KAAKC,OAAOO,KAAK,WAAWN,EAAKvB,4BAGnCqB,KAAKD,UAAUU,KAAKP,EACtB,CAIA,YAAItE,GACF,OAAOoE,KAAKD,SACd,CAEA,OAAAW,CAAQC,GACN,MAAMT,EAAOF,KAAKD,UAAUQ,MAAKF,GAAKA,EAAE1B,KAAOgC,IAC/C,IAAKT,EAAM,MAAM,IAAIU,MAAM,aAAaD,KACxC,OAAOT,CACT,GAjCW,EAAA5B,gBAAAA,E,kBAAAA,EAAe,eAD3B,IAAAG,cAIc,iBAAAoC,QAAO,oB,8CAHTvC,GAqCN,IAAMU,EAAW,EAAjB,MAAMA,YAGX,WAAApF,CACuB,EACQ,EACE,EACJkG,GAHE,KAAAgB,KAAAA,EACQ,KAAAC,MAAAA,EACE,KAAAC,gBAAAA,EAMzC,KAAAC,YAAcjB,KAAKc,KAAKI,OAAO,CAC7BC,SAAUnB,KAAKc,KAAKM,UACjB3B,MACC,EAAAhC,EAAEkC,OAAO,CACP0B,SAAU,EAAA5D,EAAEC,SACZ4D,SAAU,EAAA7D,EAAEC,YAGf6D,UAAS,GAAqB,EAAD,sCAAb,MAAE9B,IAEjB,aADkB,EAAAN,WAAWqC,KAAKL,SAASM,OAAOhC,EAEpD,MAEFiC,WAAY1B,KAAKc,KAAKM,UAAU3B,MAAM,EAAAhC,EAAEkE,OAAOC,OAAYC,GAAQ,EAAD,0CAUhE,MAAO,CACLlD,GAAI,kBACJpD,KAAM,gBACNuG,SAAS,EACTC,SAbe/B,KAAKgB,gBAAgBpF,SAASoG,KAAIC,IACjD,MAAM,aAAErD,GAA0BqD,EAATC,EAAI,SAAKD,EAA5B,kBACN,OAAO,OAAP,wBACKC,GAAI,CACPC,UAAU,EACVC,UAAU,EACVL,SAAU,IAAE,IASlB,MAEAM,gBAAiBrC,KAAKc,KAAKwB,mBAAmB7C,MAAM,EAAAhC,EAAEkC,OAAO,CAAE4C,IAAK,EAAA9E,EAAEC,YAAakE,OAAYC,GAAQ,EAAD,0CACpG,MAAOW,EAAYC,GAAYZ,EAAKpC,MAAM8C,IAAI7F,MAAM,KAC9CgG,QAAiB,EAAAvD,WAAWwD,KAAKC,oBAAoBhB,MAAM,CAAEY,eACnE,OAAO,IAAAK,oBAAmB,CACxBL,aACAC,WACAC,YAEJ,MAEAI,kBAAmB9C,KAAKc,KAAKwB,mBAAmB7C,MAAM,EAAAsD,wBAAwBnB,OAAM,GAA0B,EAAD,sCAAlB,MAAEnC,EAAK,IAAEuD,IAClG,MAAMC,EAAUjD,KAAKgB,gBAAgBN,QAAQjB,EAAMyD,QAM7CC,SAJuBnD,KAAKe,MAAM5E,QAAQ,CAC9CG,IAAK,GAAG2G,EAAQrE,8CAChBjC,OAAQ,SAEuBK,KAAKoG,OAAOpG,KAAKyC,EAAM4D,YAExD,OADAF,EAAUG,UAAY7D,EAAMyD,OACrBC,CACT,MAEAI,gBAAiBvD,KAAKc,KAAKwB,mBAAmB7C,MAAM,EAAA+D,4BAA4B5B,OAAM,GAA0B,EAAD,sCAAlB,MAAEnC,EAAK,IAAEuD,IACpG,MAAMG,QAAkBnD,KAAKyD,UAAUhE,EAAMyD,OAAQzD,EAAM4D,YACrDK,EAAY,EAAAC,kCAAkCC,UAAUnE,GACxDoE,EAAY,EAAAC,gCAAgCF,UAAUnE,GAC5D,IAAImC,EACApF,EACJ,GAAIkH,EAAUK,QACZvH,EAAO,GAAG2G,EAAUa,QAASN,EAAU1G,KAAK2B,KAC5CiD,EAAQ,CAAC,MACJ,KAAIiC,EAAUE,QASnB,MAAM,IAAInD,MAAM,qCARhBpE,EAAO2G,EAAUa,KACjBpC,EAAQ,CACNqC,SAAUJ,EAAU7G,KAAKiH,SACzBC,QAASL,EAAU7G,KAAKkH,QACxBC,MAAM,IAAAC,sBAAqBP,EAAU7G,KAAKmH,MAC1CE,YAAaR,EAAU7G,KAAKqH,YAIhC,CAEA,MAAMpB,EAAUjD,KAAKgB,gBAAgBN,QAAQjB,EAAMyD,QAgBnD,aAVkBlD,KAAKe,MAAM5E,QAAQ,CACnCQ,OAAQ,MACRL,IAAK,GAAG2G,EAAQrE,+BAA+B0F,mBAC7C1H,KAAKC,UAAU,CACb2E,KAAMwB,EAAIxB,KACVhF,OACAoF,gBAIK5E,KAAKoG,OAAOpG,IACzB,MAEAuH,gBAAiBvE,KAAKc,KAAKwB,mBAAmB7C,MAAM,EAAA+E,4BAA4BjD,UAAS,GAA0B,EAAD,sCAAlB,MAAE9B,EAAK,IAAEuD,IACvG,MACMxG,EAAO,UADWwD,KAAKyD,UAAUhE,EAAMyD,OAAQzD,EAAM4D,aACjCW,QAASvE,EAAMd,KACnCsE,EAAUjD,KAAKgB,gBAAgBN,QAAQjB,EAAMyD,QAenD,aATkBlD,KAAKe,MAAM5E,QAAQ,CACnCQ,OAAQ,OACRL,IAAK,GAAG2G,EAAQrE,wBAChB5B,KAAM,CACJwE,KAAMwB,EAAIxB,KACVhF,OACAiI,OAAQhF,EAAMiF,iBAGP1H,KAAKoG,OAAOpG,IACzB,QAnHAgD,KAAKC,OAASH,EAAc,EAAYvE,KAC1C,CAqHM,SAAAkI,CAAUjB,EAAoBa,G,mDAClC,MAAMJ,EAAUjD,KAAKgB,gBAAgBN,QAAQ8B,GAM7C,aAJ6BxC,KAAKe,MAAM5E,QAAQ,CAC9CG,IAAK,GAAG2G,EAAQrE,8CAChBjC,OAAQ,SAEYK,KAAKoG,OAAOpG,KAAKqG,EACzC,G,GAvIW,EAAArE,YAAAA,E,cAAAA,EAAW,iBADvB,IAAAP,cAKI,iBAAAoC,QAAO,EAAAhC,cACP,iBAAAgC,QAAO,EAAA3C,sBACP,iBAAA2C,QAAO,EAAAzC,wBACP,iBAAAyC,QAAO,oB,kCAHsC,mB,OAAA,IAAX,EAAAhC,aAAA,EAAAA,aAAW,gBAEUP,EAAe,YAN9DU,E,kIC/Db,gBAEA,SAAgB2F,EAAuBlF,GACrC,MAAM,WAAE+C,EAAU,SAAEoC,GAAanF,EACjC,MAAO,CACLd,GAAI,GAAG6D,KAAcoC,EAASZ,OAC9BzI,KAAMqJ,EAASrJ,KACf4G,UAAU,EACV0C,IACE1E,MAAMC,QAAQwE,EAAS7C,WAAa6C,EAAS7C,SAAS+C,OAAS,OAC3DC,EACA,UAAUvC,iBAAyB,IAAAwC,cAAaJ,EAASZ,qBAAqBY,EAASrJ,OAC7F6G,WAAUjC,MAAMC,QAAQwE,EAAS7C,WAAa6C,EAAS7C,SAAS+C,OAAS,SAAYC,EACrFhD,SAAU5B,MAAMC,QAAQwE,EAAS7C,WAAa6C,EAAS7C,SAAS+C,OAAS,EAAI,QAAKC,EAEtF,CA4BA,SAAgBE,EAASC,EAAyBC,G,MAChDA,EAAMD,GACFA,EAAKnD,UAAY5B,MAAMC,QAAQ8E,EAAKnD,WAAamD,EAAKnD,SAAS+C,OAAS,IAC7D,QAAb,EAAAI,EAAKnD,gBAAQ,SAAEhH,SAAQqK,IACrBH,EAASG,EAAOD,EAAM,IAG5B,CAhDA,2BAeA,8BAAmC1F,GAKjC,MAAM,WAAE+C,EAAU,SAAEC,EAAQ,SAAEC,GAAajD,EAC3C,GAAgB,MAAZgD,EAA6B,CAI/B,OAHYC,EAASV,KAAIqD,GAChBV,EAAuB,CAAEnC,aAAYoC,SAAUS,KAG1D,CAAO,CACL,IAAIC,EAUJ,OATA5C,EAAS3H,SAAQ6J,GACfK,EAASL,GAAUS,IACbA,EAAKrB,OAASvB,GACZtC,MAAMC,QAAQiF,EAAKtD,YACrBuD,EAAMD,EAAKtD,SAASC,KAAIoD,GAAST,EAAuB,CAAEnC,aAAYoC,SAAUQ,MAEpF,MAGGE,CACT,CACF,EAEA,Y,gHC3CA,UAEA,UAGO,IAAMvG,EAAc,EAApB,MAAMA,eAGX,WAAAnF,CAAuCkG,GAIvC,KAAAyF,cAAuB1D,GAAkD,EAAD,0CACtE,MAAMmB,GAAM,IAAAuC,eAAc1D,GAE1B,OADA,IAAA2D,MAAKxC,EAAK,mBACHA,CACT,IAPEhD,KAAKC,OAASH,EAAc,EAAevE,KAC7C,GALW,EAAAwD,eAAAA,E,iBAAAA,EAAc,iBAD1B,IAAAN,cAIc,iBAAAoC,QAAO,oB,8CAHT9B,E,kHCNb,UACA,UAEA,0BACA,UACA,UAKO,IAAMG,EAAU,EAAhB,MAAMA,WAGX,WAAAtF,CACuB,EACA,EACG,EACGkG,GAHE,KAAAgB,KAAAA,EACA,KAAAG,YAAAA,EACG,KAAAwE,eAAAA,EAMlC,KAAAC,UAAY1F,KAAKc,KAAKI,OAAO,CAC3ByE,MAAO3F,KAAKiB,YAAYA,cAJxBjB,KAAKC,OAASH,EAAc,EAAWvE,KACzC,CAMA,eAAAqK,CAAgBC,EAAuBC,GACrC9F,KAAKC,OAAOtF,IAAI,mBAAmBmL,UAEnCD,EAAIzJ,IACF,IAAI0J,SACJC,EAAYC,wBAAwB,CAClC9E,OAAQlB,KAAK0F,UACbH,cAAevF,KAAKyF,eAAeF,gBAGzC,GA1BW,EAAArG,WAAAA,E,aAAAA,EAAU,iBADtB,IAAAT,cAKI,iBAAAoC,QAAO,EAAAhC,cACP,iBAAAgC,QAAO,EAAA7B,cACP,iBAAA6B,QAAO,EAAA9B,iBACP,iBAAA8B,QAAO,oB,kCAHsC,mB,OAAA,IAAX,EAAAhC,aAAA,EAAAA,aAAW,SACO,mBADP,OACO,IAAX,EAAAG,aAAA,EAAAA,aAAW,SACS,mBADT,OACS,IAAd,EAAAD,gBAAA,EAAAA,gBAAc,qBANrDG,E,yHCVb,UACA,UAGA,UACA,UACA,UAKO,IAAML,EAAW,EAAjB,MAAMA,YAGX,WAAAjF,CAAuCkG,GAIvC,KAAAgB,KAAO,EAAAmF,SACJ3K,UAEAW,OAAO,CACNuD,YAAa,EAAAA,YACb0G,eAAgB,EAAAA,iBAGpB,KAAA9E,UAAYpB,KAAKc,KAAKM,UAEtB,KAAAkB,mBAAqBtC,KAAKc,KAAKM,UAAUhF,KAAI,SAAgByF,G,mDAC3D,MAAMmB,EAAMnB,EAAKmB,IAEjB,IAAIxB,GADJ,IAAAgE,MAAKxC,EAAK,wBAEV,MAAMmD,EAAKC,EAAUpD,EAAIqD,IAAI9G,QAAQ+G,eAErC,IADA,IAAAd,MAAKxC,EAAK,YAAa,CAAEmD,OACrBA,EACF,IACE,MAAMI,QAAgB,EAAApH,WAAWqC,KAAKgF,kBAAkB5E,MAAM,CAAE6E,IAAKN,KACrE,IAAAX,MAAKxC,EAAK,oCAAqCuD,GAC/C,MAAMG,QAAgB,EAAAvH,WAAWqC,KAAKmF,WAAW/E,MAAM,CAAEjD,GAAI4H,EAAa,MAC1E/E,EAAO,EAAAoF,cAAc7J,MAAM2J,EAC7B,CAAE,MAAOG,IACP,IAAArB,MAAKxC,EAAK,oCAAqC6D,EACjD,CAEF,IAAKrF,EACH,MAAM,IAAI,EAAAsF,UAAU,CAAEC,KAAM,iBAG9B,OADA/D,EAAIxB,KAAOA,EACJK,EAAKmF,KAAK,CAAEhE,OACrB,G,IAEA,KAAA9B,OAASlB,KAAKc,KAAKI,OACnB,KAAA+F,aAAejH,KAAKc,KAAKmG,aArCvBjH,KAAKC,OAASH,EAAc,EAAYvE,KAC1C,GAuCF,SAAgB6K,EAAU3G,GACxB,GAAqB,iBAAVA,EAAoB,OAC/B,GAA2B,MAAvBA,EAAM/C,MAAM,KAAK,GAAY,OACjC,IAAI4I,EAAM7F,EAAM/C,MAAM,KAAK,GAC3B,MAAmB,KAAf4I,EAAI4B,SACR5B,EAAMA,EAAI4B,OACE,cAAR5B,GAA+B,SAARA,GACpBA,OAHP,CAIF,CApDa,EAAAzG,YAAAA,E,cAAAA,EAAW,iBADvB,IAAAJ,cAIc,iBAAAoC,QAAO,oB,8CAHThC,GA4Cb,a,kFCvDA,0BACA,0BACA,0BACA,0BACA,wB,gkBCJa,EAAAsI,0BAA4BC,OAAOC,IAAI,uBACvC,EAAAC,wBAA0BF,OAAOC,IAAI,qBACrC,EAAAE,kBAAoBH,OAAOC,IAAI,eAC/B,EAAAG,kBAAoBJ,OAAOC,IAAI,eAC/B,EAAAI,0BAA4BL,OAAOC,IAAI,uBACvC,EAAAK,oBAAsBN,OAAOC,IAAI,iBACjC,EAAAM,oCAAsCP,OAAOC,IAAI,iCACjD,EAAAO,uBAAyBR,OAAOC,IAAI,oBACpC,EAAAQ,UAAYT,OAAO,OACnB,EAAAU,UAAYV,OAAOC,IAAI,OACvB,EAAAU,UAAYX,OAAOC,IAAI,OACvB,EAAAW,0BAA4BZ,OAAOC,IAAI,uBACvC,EAAAY,UAAYb,OAAO,OACnB,EAAAc,gBAAkBd,OAAOC,IAAI,aAC7B,EAAAc,kBAAoBf,OAAOC,IAAI,eAC/B,EAAAe,8BAAgChB,OAAOC,IAAI,2BAC3C,EAAAgB,6BAA+BjB,OAAOC,IAAI,0BAC1C,EAAAiB,kBAAoBlB,OAAOC,IAAI,eAC/B,EAAAkB,sBAAwBnB,OAAOC,IAAI,yBACnC,EAAAmB,6BAA+BpB,OAAOC,IAAI,gCAC1C,EAAAjJ,sBAAwBgJ,OAAOC,IAAI,mBACnC,EAAAnJ,oBAAsBkJ,OAAOC,IAAI,gB,eCb9C,IAAYoB,E,0FAAZ,SAAYA,GACV,mBACA,gBACD,CAHD,CAAYA,IAAK,QAALA,EAAK,KAKJ,EAAAC,WAAa,MACb,EAAAC,WAAa,K,qFCD1B,wBACEC,GAEA,MAAMC,gBAIG,aAAO5M,CAAOwD,GACnB,OAAOO,KAAK4I,OAAO7L,MAAM0C,EAC3B,EAGF,OARgB,gBAAAqJ,UAAW,EACX,gBAAAF,OAASA,EAOlBC,eACT,C,+iDC1BA,gBACA,WACA,IAAAE,WAAU,EAAAtL,GACG,EAAAuL,kBAAoB,EAAAvL,EAAEkC,OAAO,CACxCsJ,aAAc,EAAAxL,EAAEC,SAASwL,QAAQ,CAC/BC,YAAa,6BAEfC,aAAc,EAAA3L,EAAEC,SAASwL,QAAQ,CAC/BC,YAAa,6BAEfE,SAAU,EAAA5L,EAAEC,SAASwL,QAAQ,CAC3BC,YAAa,mBAEfG,QAAS,EAAA7L,EAAEC,SAASwL,QAAQ,CAC1BC,YAAa,uBAEfI,YAAa,EAAA9L,EAAEC,SAASwL,QAAQ,CAC9BC,YAAa,6BAEfK,OAAQ,EAAA/L,EAAEgM,MAAM,CAAC,EAAAhM,EAAEiM,QAAQ,GAAI,EAAAjM,EAAEiM,QAAQ,KAAKR,QAAQ,CACpDC,YAAa,wDAEfQ,eAAgB,EAAAlM,EAAEC,SAASwL,QAAQ,CACjCC,YAAa,qBAIJ,EAAAS,eAAiB,EAAAnM,EAAEkC,OAAO,CACrCkK,UAAW,EAAApM,EAAEC,SAASwL,QAAQ,CAC5BC,YAAa,6BAEfW,UAAW,EAAArM,EAAEC,SAASwL,QAAQ,CAC5BC,YAAa,6BAEfY,YAAa,EAAAtM,EAAEC,SAASwL,QAAQ,CAC9BC,YAAa,+BAEfa,eAAgB,EAAAvM,EAAEC,SAASwL,QAAQ,CACjCC,YAAa,6BAEfE,SAAU,EAAA5L,EAAEC,SAASwL,QAAQ,CAC3BC,YAAa,6BAEfc,cAAe,EAAAxM,EAAEC,SAASwL,QAAQ,CAChCC,YAAa,6BAEfe,gBAAiB,EAAAzM,EAAEC,SAASwL,QAAQ,CAClCC,YAAa,6BAEfgB,eAAgB,EAAA1M,EAAEC,SAASwL,QAAQ,CACjCC,YAAa,+BAEfiB,QAAS,EAAA3M,EAAEC,SAASwL,QAAQ,CAC1BC,YAAa,mBAEfkB,iBAAkB,EAAA5M,EAAE6M,SAASpB,QAAQ,CACnCC,YAAa,kGAEfrE,OAAQ,EAAArH,EAAE6M,SAASpB,QAAQ,CACzBC,YAAa,WAEfoB,MAAO,EAAA9M,EAAE6M,SAASpB,QAAQ,CACxBC,YAAa,WAEfqB,KAAM,EAAA/M,EAAE6M,SAASpB,QAAQ,CACvBC,YAAa,WAEfsB,OAAQ,EAAAhN,EAAE6M,SAASpB,QAAQ,CACzBC,YAAa,iBAEfuB,YAAa,EAAAjN,EAAE6M,SAASpB,QAAQ,CAC9BC,YAAa,iBAEfwB,UAAW,EAAAlN,EAAE6M,SAASpB,QAAQ,CAC5BC,YAAa,iBAEfyB,SAAU,EAAAnN,EAAE6M,SAASpB,QAAQ,CAC3BC,YAAa,6BAEf0B,SAAU,EAAApN,EAAE6M,SAASpB,QAAQ,CAC3BC,YAAa,6BAEf2B,eAAgB,EAAArN,EAAE6M,SAASpB,QAAQ,CACjCC,YAAa,yCAEf4B,OAAQ,EAAAtN,EAAE6M,SAASpB,QAAQ,CACzBC,YAAa,8DAEf6B,gBAAiB,EAAAvN,EAAE6M,SAASpB,QAAQ,CAClCC,YAAa,yCAEf8B,aAAc,EAAAxN,EAAE6M,SAASpB,QAAQ,CAC/BC,YAAa,6BAEf+B,aAAc,EAAAzN,EAAEC,SAASwL,QAAQ,CAC/BC,YAAa,6BAEfgC,WAAY,EAAA1N,EAAEC,SAASwL,QAAQ,CAC7BC,YAAa,iBAEfiC,iBAAkB,EAAA3N,EAAEC,SAASwL,QAAQ,CACnCC,YAAa,iBAEfkC,SAAU,EAAA5N,EAAEC,SAASwL,QAAQ,CAC3BC,YAAa,QAEfmC,SAAU,EAAA7N,EAAEC,SAASwL,QAAQ,CAC3BC,YAAa,6BAEfoC,SAAU,EAAA9N,EAAEC,SAASwL,QAAQ,CAC3BC,YAAa,QAEfK,OAAQ,EAAA/L,EAAE6M,SAASpB,QAAQ,CACzBC,YAAa,wDAEfQ,eAAgB,EAAAlM,EAAE6M,SAASpB,QAAQ,CACjCC,YAAa,qBAIJ,EAAAqC,kBAAoB,EAAA/N,EAAEkC,OAAO,CACxC8L,QAAS,EAAAhO,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,UAGhC,EAAAuC,mBAAqB,EAAAjO,EAAEkC,OAAO,CACzCgM,OAAQ,EAAAlO,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,+BAC1C5N,KAAM,EAAAkC,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,yCACxCpC,KAAM,EAAAtJ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,mCAG7B,EAAAyC,eAAiB,EAAAnO,EAAEkC,OAAO,CACrChB,GAAI,EAAAlB,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,sBACtCpC,KAAM,EAAAtJ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,kCAG7B,EAAA0C,kBAAoB,EAAApO,EAAEkC,OAAO,CACxCmM,aAAc,EAAArO,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,mCAChD4C,aAAc,EAAAtO,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,mCAChDE,SAAU,EAAA5L,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,mBAC5CG,QAAS,EAAA7L,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,uBAC3CI,YAAa,EAAA9L,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC/C6C,OAAQ,EAAAvO,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBAC1CK,OAAQ,EAAA/L,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,wDAC1CQ,eAAgB,EAAAlM,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,qBAGvC,EAAA8C,mBAAqB,EAAAxO,EAAEkC,OAAO,CACzCuM,cAAe,EAAAzO,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,yCACjDgD,cAAe,EAAA1O,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,yCACjDK,OAAQ,EAAA/L,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,wDAC1CQ,eAAgB,EAAAlM,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,qBAGvC,EAAAiD,yBAA2B,EAAA3O,EAAEkC,OAAO,CAC/C0M,QAAS,EAAA5O,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,uBAC3CmD,MAAO,EAAA7O,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BACzCoD,gBAAiB,EAAA9O,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,uKACnDqD,YAAa,EAAA/O,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC/CsD,KAAM,EAAAhP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACxCuD,KAAM,EAAAjP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,uBACxCwD,SAAU,EAAAlP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,+BAGjC,EAAAyD,mBAAqB,EAAAnP,EAAEoP,MAAM,EAAAT,0BAE7B,EAAAU,wBAA0B,EAAArP,EAAEoP,MAAM,EAAAT,0BAElC,EAAAW,0BAA4B,EAAAtP,EAAEoP,MACzC,EAAAT,yBAAyBY,OAAO,CAC9BC,YAAa,EAAAxP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,sCAItC,EAAA+D,kCAAoC,EAAAzP,EAAEoP,MACjD,EAAAT,yBAAyBY,OAAO,CAC9BG,QAAS,EAAA1P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC3CsD,KAAM,EAAAhP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAI/B,EAAAiE,4BAA8B,EAAA3P,EAAEoP,MAC3C,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNM,SAAU,EAAA7P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC5CoE,SAAU,EAAA9P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAIrC,EAAAqE,6BAA+B,EAAA/P,EAAEoP,MAC5C,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNM,SAAU,EAAA7P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC5CoE,SAAU,EAAA9P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC5C8D,YAAa,EAAAxP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,sCAIxC,EAAAsE,8BAAgC,EAAAhQ,EAAEoP,MAC7C,EAAAT,yBAAyBY,OAAO,CAC9BG,QAAS,EAAA1P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC3CsD,KAAM,EAAAhP,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAI/B,EAAAuE,qBAAuB,EAAAjQ,EAAEoP,MACpC,EAAAT,yBAAyBY,OAAO,CAC9BW,WAAY,EAAAlQ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAIrC,EAAAyE,qCAAuC,EAAAnQ,EAAEkC,OAAO,CAC3DkO,UAAW,EAAApQ,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,6BAC7C2E,gBAAiB,EAAArQ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,+BAGxC,EAAA4E,4BAA8B,EAAAtQ,EAAEoP,MAC3C,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNW,WAAY,EAAAlQ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAIvC,EAAA6E,yBAA2B,EAAAvQ,EAAEoP,MACxC,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNW,WAAY,EAAAlQ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAIvC,EAAA8E,2BAA6B,EAAAxQ,EAAEoP,MAAM,EAAAT,0BACrC,EAAA8B,6BAA+B,EAAAzQ,EAAEoP,MAC5C,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNW,WAAY,EAAAlQ,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAGvC,EAAAgF,oCAAsC,EAAA1Q,EAAEoP,MACnD,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNoB,WAAY,EAAA3Q,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAIvC,EAAAkF,0BAA4B,EAAA5Q,EAAEoP,MACzC,EAAAT,yBACGiB,KAAK,CACJZ,MAAM,IAEPO,OAAO,CACNsB,YAAa,EAAA7Q,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BAC/CoE,SAAU,EAAA9P,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,gCAIrC,EAAAoF,8BAAgC,EAAA9Q,EAC1CkC,OAAO,CACN6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,qBAAOsF,QAAS,cAC5DC,UAAW,EAAAjR,EAAEoP,MACX,EAAApP,EAAEkC,OAAO,CACPgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,eAAMsF,QAAS,uBAIrEvF,QAAQ,CACP0F,MAAO,gCACPH,QAAS,CAAED,SAAU,wBAGZ,EAAAK,6BAA+B,EAAApR,EAAEkC,OAAO,CACnD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CuF,UAAW,EAAAjR,EAAEoP,MACX,EAAApP,EAAEkC,OAAO,CACPgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACjD2F,SAAU,EAAArR,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,wCAKhD,EAAA6F,2BAA6B,EAAAvR,EAAEkC,OAAO,CACjD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CwF,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BACjD8F,IAAK,EAAAxR,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCAClD+F,KAAM,EAAAzR,EAAEgM,MAAM,CAAC,EAAAhM,EAAEiM,QAAQ,iBAAQ,EAAAjM,EAAEiM,QAAQ,iBAAQ,EAAAjM,EAAEiM,QAAQ,qBAGlD,EAAAyF,kCAAoC,EAAA1R,EAAEkC,OAAO,CACxDoE,QAAS,EAAAtG,EAAE2R,UAAUlG,QAAQ,CAAEuF,QAAS,SACxCD,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CwF,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BACjD2F,SAAU,EAAArR,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCACvD+F,KAAM,EAAAzR,EAAEgM,MAAM,CAAC,EAAAhM,EAAEiM,QAAQ,iBAAQ,EAAAjM,EAAEiM,QAAQ,iBAAQ,EAAAjM,EAAEiM,QAAQ,mBAC7D2F,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,qCAG1C,EAAAmG,kCAAoC,EAAA7R,EAAEkC,OAAO,CACxDoE,QAAS,EAAAtG,EAAE2R,UAAUlG,QAAQ,CAAEuF,QAAS,UACxCc,QAAS,EAAA9R,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,+BAGhC,EAAAqG,qBAAuB,EAAA/R,EAAEkC,OAAO,CAC3C6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CwF,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,6BACjD2F,SAAU,EAAArR,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCACvDkG,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCACrD+F,KAAM,EAAAzR,EAAEgM,MAAM,CAAC,EAAAhM,EAAEiM,QAAQ,iBAAQ,EAAAjM,EAAEiM,QAAQ,iBAAQ,EAAAjM,EAAEiM,QAAQ,qBAGlD,EAAA+F,4BAA8B,EAAAhS,EAAEkC,OAAO,CAClD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CuF,UAAW,EAAAjR,EAAEoP,MACX,EAAApP,EAAEkC,OAAO,CACPgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACjD2F,SAAU,EAAArR,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCACvDkG,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,wCAK9C,EAAAuG,gCAAkC,EAAAjS,EAAEkC,OAAO,CACtD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CuF,UAAW,EAAAjR,EAAEoP,MACX,EAAApP,EAAEkC,OAAO,CACPgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACjDkG,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,wCAK9C,EAAAwG,gCAAkC,EAAAlS,EAAEkC,OAAO,CACtD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CwF,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACjDkG,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCACrDyG,gBAAiB,EAAAnS,EAAEgM,MAAM,CACvB,EAAAhM,EAAEiM,QAAQ,6BACV,EAAAjM,EAAEiM,QAAQ,6BACV,EAAAjM,EAAEiM,QAAQ,6BACV,EAAAjM,EAAEiM,QAAQ,iCAID,EAAAmG,6BAA+B,EAAApS,EAAEkC,OAAO,CACnD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CuF,UAAW,EAAAjR,EAAEoP,MACX,EAAApP,EAAEkC,OAAO,CACPgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACjDkG,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,wCAK9C,EAAA2G,+BAAiC,EAAArS,EAAEkC,OAAO,CACrD6O,SAAU,EAAA/Q,EAAE6M,SAASpB,QAAQ,CAAEC,YAAa,uBAC5CuF,UAAW,EAAAjR,EAAEoP,MACX,EAAApP,EAAEkC,OAAO,CACPgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,iBACjD2F,SAAU,EAAArR,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,mCACvDkG,OAAQ,EAAA5R,EAAEC,SAASqR,WAAW7F,QAAQ,CAAEC,YAAa,wCAK9C,EAAA4G,0CAA4C,EAAAtS,EAAEkC,OAAO,CAChEgP,cAAe,EAAAlR,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,mBAGtC,EAAA6G,WAAa,EAAAvS,EACvBkC,OAAO,CACNoE,QAAS,EAAAtG,EAAEiM,SAAQ,GACnB6F,QAAS,EAAA9R,EAAEC,WAEZwL,QAAQ,CACP0F,MAAO,eAGE,EAAAqB,cAAgB,EAAAxS,EAC1BkC,OAAO,CACNoE,QAAS,EAAAtG,EAAEiM,SAAQ,GACnB6F,QAAS,EAAA9R,EAAEC,WAEZwL,QAAQ,CACP0F,MAAO,kBAGE,EAAAsB,aAAe,EAAAzS,EAAEC,SAASwL,QAAQ,CAAEuF,QAAS,OAAQtF,YAAa,6BAC/E,MAAMgH,EAAe,EAAA1S,EAAEC,SAASwL,QAAQ,CAAEuF,QAAS,GAAItF,YAAa,uBAEvD,EAAAiH,2BAA6B,EAAA3S,EACvCkC,OAAO,CACNuQ,aAAA,EAAAA,eAEDhH,QAAQ,CAAE0F,MAAO,6BAA8BzF,YAAa,iEAElD,EAAAkH,gCAAkC,EAAA5S,EAC5CkC,OAAO,CACNwQ,aAAc,EAAA1S,EAAEC,SAASwL,QAAQ,CAC/BuF,QAAS,OACTtF,YAAa,6BAEfmH,aAAc,EAAA7S,EAAEoP,MACd,EAAApP,EAAEkC,OAAO,CACPuQ,aAAc,EAAAzS,EAAEC,SAASwL,QAAQ,CAC/BC,YAAa,2BACbsF,QAAS,SAEXS,KAAM,EAAAzR,EAAEC,SAASwL,QAAQ,CACvBC,YAAa,uDACbsF,QAAS,cAKhBvF,QAAQ,CAAE0F,MAAO,kCAAmCzF,YAAa,SAEvD,EAAAoH,4BAA8B,EAAA9S,EACxCoP,MACC,EAAApP,EAAEkC,OAAO,CACPuQ,aAAA,EAAAA,gBAGHhH,QAAQ,CAAE0F,MAAO,8BAA+BzF,YAAa,mFAEnD,EAAAqH,qCAAuC,EAAA/S,EACjDkC,OAAO,CACN8Q,KAAM,EAAAhT,EAAEC,SAASwL,QAAQ,CAAEuF,QAAS,OAAQtF,YAAa,mBAE1DD,QAAQ,CACP0F,MAAO,yCAGE,EAAA8B,UAAY,EAAAjT,EACtBkC,OAAO,CACNgR,OAAQ,EAAAlT,EAAEC,SAASwL,QAAQ,CACzBuF,QAAS,OACTtF,YAAa,qCAGhBD,QAAQ,CACP0F,MAAO,cAGE,EAAAgC,eAAiB,EAAAnT,EAC3BoP,MACC,EAAApP,EAAEkC,OAAO,CACPuQ,aAAA,EAAAA,aACAW,IAAK,EAAApT,EAAE6M,SAASpB,QAAQ,CAAEuF,QAAS,GAAItF,YAAa,gCAGvDD,QAAQ,CACP0F,MAAO,mBAGE,EAAAkC,kBAAoB,EAAArT,EAC9BoP,MACC,EAAApP,EAAEkC,OAAO,CACPuQ,aAAA,EAAAA,aACAW,IAAK,EAAApT,EAAE6M,SAASpB,QAAQ,CAAEuF,QAAS,GAAItF,YAAa,mCACpD4H,IAAK,EAAAtT,EAAE6M,SAASpB,QAAQ,CAAEuF,QAAS,GAAItF,YAAa,sCAGvDD,QAAQ,CACP0F,MAAO,sBAGE,EAAAoC,yBAA2B,EAAAvT,EACrCkC,OAAO,CACN8Q,KAAM,EAAAhT,EAAEC,SAASwL,QAAQ,CAAEuF,QAAS,OAAQtF,YAAa,mBAE1DD,QAAQ,CACP0F,MAAO,6BAGE,EAAAqC,KAAO,EAAAxT,EACjBkC,OAAO,CACNsR,KAAM,EAAAxT,EAAEC,SAASwL,QAAQ,CAAEuF,QAAS,GAAItF,YAAa,WAEtDD,QAAQ,CAAE0F,MAAO,SAEP,EAAAsC,uBAAyB,EAAAzT,EACnCoP,MACC,EAAApP,EAAEkC,OAAO,CACPuQ,aAAA,EAAAA,gBAGHhH,QAAQ,CACP0F,MAAO,yBACPzF,YAAa,6BAGJ,EAAAgI,kCAAoC,EAAA1T,EAC9CoP,MACC,EAAApP,EAAEkC,OAAO,CACPwQ,aAAc,EAAA1S,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,2BAAQsF,QAAS,SACjE6B,aAAc,EAAA7S,EAAEoP,MACd,EAAApP,EAAEkC,OAAO,CACPuQ,aAAc,EAAAA,aACdO,KAAM,EAAAhT,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,wEAK/CD,QAAQ,CACP0F,MAAO,sCAGE,EAAAwC,mCAAqC,EAAAH,KAAK/H,QAAQ,CAC7DC,YAAa,eACbyF,MAAO,uCAGI,EAAAyC,mCAAqC,EAAAJ,KAAK/H,QAAQ,CAC7DC,YAAa,eACbyF,MAAO,uCAGI,EAAA0C,mCAAqC,EAAAL,KAAK/H,QAAQ,CAC7DC,YAAa,eACbyF,MAAO,uCAGI,EAAA2C,mCAAqC,EAAAN,KAAK/H,QAAQ,CAC7DC,YAAa,2BACbyF,MAAO,uCAGI,EAAA4C,4BAA8B,EAAA/T,EACxCkC,OAAO,CACNwQ,aAAcA,EACdG,aAAc,EAAA7S,EAAEoP,MACd,EAAApP,EAAEkC,OAAO,CACPuQ,aAAc,EAAAA,aACduB,UAAW,EAAAhU,EAAEC,SAASwL,QAAQ,CAAEC,YAAa,8CAIlDD,QAAQ,CACP0F,MAAO,8BACPzF,YAAa,kF,2mFC1iBjB,gBACA,UAGA,EAFA,QAEAJ,WAAU,EAAAtL,GAEG,EAAAiU,mBAAqB,EAAAjU,EAAEkC,OAAO,CACzCgS,MAAO,EAAAlU,EAAEgM,MAAM,CAAC,EAAAhM,EAAEC,SAAU,EAAAD,EAAE6M,WAC9BsH,MAAO,EAAAnU,EAAEC,WAGE,EAAAmU,0BAA4B,EAAApU,EAAEkC,OAAO,CAChDmS,YAAa,EAAArU,EAAEC,SACfqU,WAAY,EAAAtU,EAAEC,SACdsU,YAAa,EAAAvU,EAAEC,SACfnC,KAAM,EAAAkC,EAAEC,SACRsG,KAAM,EAAAvG,EAAEC,SACRuU,aAAc,EAAAxU,EAAEC,SAChBwU,YAAa,EAAAzU,EAAEC,WAGJ,EAAAyU,qBAAuB,EAAA1U,EAAEkC,OAAO,CAC3CpE,KAAM,EAAAkC,EAAEC,SACR0U,YAAa,EAAA3U,EAAE4U,KAAK,CAAC,cAActD,WACnCuD,YAAa,EAAA7U,EAAE4U,KAAK,CAAC,YAAa,SAAU,MAAO,UAAW,WAAY,WAAY,YACtFE,OAAQ,EAAA9U,EAAE2R,UAAUL,WACpByD,OAAQ,EAAA/U,EACLkC,OAAO,CACN8S,eAAgB,EAAAf,mBAAmB7E,UAEpCkC,WACH2D,UAAW,EAAAjV,EAAEkC,OAAO,CAClBoS,WAAY,EAAAtU,EAAEC,SACdsU,YAAa,EAAAvU,EAAEC,SACfuU,aAAc,EAAAxU,EAAEC,SAChBiV,eAAgB,EAAAlV,EAAEgM,MAAM,CAAC,EAAAhM,EAAEC,SAAU,EAAAD,EAAEoP,MAAM,EAAApP,EAAEC,UAAW,EAAAD,EAAEsH,cAC5D,kBAAmB,EAAAtH,EAAEC,SACrB,iBAAkB,EAAAD,EAAEC,SACpB,WAAY,EAAAD,EAAE2R,UAAUL,aAE1BkD,aAAc,EAAAxU,EAAEC,SAASqR,WACzB6D,WAAY,EAAAnV,EAAEoP,MACZ,EAAApP,EAAEgM,MAAM,CACN,EAAAhM,EAAEkC,OAAO,CACPkT,SAAU,EAAApV,EAAE2R,YAEd,EAAA3R,EAAEkC,OAAO,CACP6S,OAAQ,EAAA/U,EAAEC,SACV6R,QAAS,EAAA9R,EAAEC,gBAMN,EAAAoV,eAAiB,EAAArV,EAAEkC,OAAO,CACrC2D,UAAW,EAAA7F,EAAEC,SAASqR,WACtBwD,OAAQ,EAAA9U,EAAE2R,UAAUL,WACpBgE,WAAY,EAAAtV,EAAE2R,UAAUL,WACxBmD,YAAa,EAAAzU,EAAEC,SACfnC,KAAM,EAAAkC,EAAEC,SACRsG,KAAM,EAAAvG,EAAEC,SACRsU,YAAa,EAAAvU,EAAEC,SACf,WAAY,EAAAD,EAAEkE,MACdgR,eAAgB,EAAAlV,EAAEgM,MAAM,CAAC,EAAAhM,EAAEC,SAAU,EAAAD,EAAEoP,MAAM,EAAApP,EAAEC,UAAW,EAAAD,EAAEsH,cAC5DkN,aAAc,EAAAxU,EAAEC,SAASsV,WACzBC,oBAAqB,EAAAxV,EAAE2R,UACvB8D,mBAAoB,EAAAzV,EAAEoP,MAAM,EAAApP,EAAEC,UAAUqR,WACxCoE,QAAS,EAAAhB,qBAAqBtF,QAC9BuG,aAAc,EAAAvB,0BAA0BhF,QACxCwG,aAAc,EAAA5V,EAAEkE,QAGL,EAAA2R,oBAAsB,EAAA7V,EAAEkC,OAAO,CAC1C4T,WAAY,EAAA9V,EAAE4U,KAAK,CAAC,OAAQ,WAE5BnD,KAAM,EAAAzR,EAAE4U,KAAK,CAAC,WAAY,WAE1BmB,OAAQ,EAAA/V,EAAEgM,MAAM,CAAC,EAAAhM,EAAEC,SAAU,EAAAD,EAAE6M,aAGpB,EAAAmJ,qBAAuB,EAAAhW,EAAEkC,OAAO,CAC3C4T,WAAY,EAAA9V,EAAE4U,KAAK,CAAC,SAEpBqB,SAAU,EAAAjW,EAAE4U,KAAK,CAAC,KAAM,QAExBsB,WAAY,EAAAlW,EAAEoP,MAAM,EAAAyG,uBAGT,EAAAM,gBAAkB,EAAAnW,EAAEoW,OAAO,EAAAP,qBAE3B,EAAAQ,gBAAkB,EAAArW,EAAEoW,OAAO,EAAAJ,sBAE3B,EAAAM,eAAiB,EAAAtW,EAC3BoW,OAAO,EAAAP,oBAAoBU,GAAG,EAAAP,uBAC9BO,GAAG,EAAAvW,EAAEkC,OAAO,CAAEsU,KAAM,EAAAxW,EAAEC,SAASqR,cAGrB,EAAAmF,aAAe,EAAAzW,EAAEoP,MAC5B,EAAApP,EAAEkC,OAAO,CACPwU,MAAO,EAAA1W,EAAEC,SACTyG,KAAM,EAAA1G,EAAE4U,KAAK,CAAC,MAAO,YAKZ,EAAA+B,mBAAqB,EAAA3W,EAAEkC,OAAO,CACzC0U,GAAI,EAAA5W,EAAEoP,MAAM,EAAApP,EAAEoW,OAAO,EAAApW,EAAEoW,OAAO,EAAApW,EAAE4U,KAAK,CAAC,aAAc,EAAA5U,EAAEC,cAS3C,EAAA4W,eAAiB,EAAA7W,EAAEkC,OAAO,CACrC0B,SAAU,EAAA5D,EAAEC,SACZ4D,SAAU,EAAA7D,EAAEC,SACZ6W,SAAU,EAAA9W,EAAE6M,WAGd,MAAakK,qBAAoB,IAAAC,cAAa,EAAAH,kBAA9C,0BAEa,EAAAI,oBAAsB,EAAAjX,EAAEkC,OAAO,CAC1C0B,SAAU,EAAA5D,EAAEC,SACZ8E,WAAY,EAAA/E,EAAEC,WAGhB,MAAaiX,gCAA+B,IAAAF,cAAa,EAAAC,uBAAzD,gDAEa,EAAAE,eAAiB,EAAAnX,EAAEkC,OAAO,CACrC4U,SAAU,EAAA9W,EAAE6M,SAASyE,WACrB1N,SAAU,EAAA5D,EAAEC,SACZ4D,SAAU,EAAA7D,EAAEC,WAGd,MAAamX,2BAA0B,IAAAJ,cAAa,EAAAG,kBAApD,sCAEa,EAAAE,sBAAwB,EAAArX,EAAEkC,OAAO,CAC5C6C,WAAY,EAAA/E,EAAEC,WAGhB,MAAaqX,kCAAiC,IAAAN,cAAa,EAAAK,yBAA3D,oDAEa,EAAAE,+BAAiC,EAAAvX,EAAEkC,OAAO,CACrDsV,QAAS,EAAAxX,EAAEC,SACX6W,SAAU,EAAA9W,EAAE6M,WAGd,MAAa4K,2CAA0C,IAAAT,cAAa,EAAAO,kCAApE,sEAEa,EAAAG,wBAA0B,EAAA1X,EAAEkC,OAAO,CAC9CsV,QAAS,EAAAxX,EAAEC,SACX6W,SAAU,EAAA9W,EAAE6M,WAGd,MAAa8K,oCAAmC,IAAAX,cAAa,EAAAU,2BAA7D,wDAEa,EAAAE,oBAAsB,EAAA5X,EAAEkC,OAAO,CAC1C2V,OAAQ,EAAA7X,EAAE6M,SACViK,SAAU,EAAA9W,EAAE6M,SACZhJ,SAAU,EAAA7D,EAAEC,WAGD,EAAA6X,qBAAuB,EAAAF,oBAAoBrI,OAAO,CAC7DwI,IAAK,EAAA/X,EAAE6M,WAGT,MAAamL,gCAA+B,IAAAhB,cAAa,EAAAY,uBAAzD,gDAEa,EAAAK,mBAAqB,EAAAjY,EAAEkC,OAAO,CACzCgW,IAAK,EAAAlY,EAAE6M,SACPkL,IAAK,EAAA/X,EAAE6M,SACPsL,OAAQ,EAAAnY,EAAEC,SACVqJ,KAAM,EAAAtJ,EAAEC,SACRsG,KAAM,EAAAvG,EAAEC,WAGV,MAAamY,+BAA8B,IAAApB,cAAa,EAAAiB,sBAAxD,8CAEa,EAAAI,uBAAyB,EAAArY,EAAEkC,OAAO,CAC7C6V,IAAK,EAAA/X,EAAE6M,WAGI,EAAAyL,qBAAuB,EAAAtY,EAAEkC,OAAO,CAC3CgW,IAAK,EAAAlY,EAAE6M,SACPkL,IAAK,EAAA/X,EAAE6M,WAGT,MAAa0L,iCAAgC,IAAAvB,cAAa,EAAAsB,wBAA1D,kDAEa,EAAAE,wBAA0B,EAAAxY,EAAEkC,OAAO,CAC9CuW,MAAO,EAAAzY,EAAEC,WAGX,MAAayY,oCAAmC,IAAA1B,cAAa,EAAAwB,2BAA7D,wDAEA,MAAaG,oDAAmD,IAAA3B,cAC9D,EAAAwB,wBAAwBI,MAAM,EAAAP,2BADhC,wFAIa,EAAAQ,qBAAuB,EAAA7Y,EAAEkC,OAAO,CAC3CuW,MAAO,EAAAzY,EAAEC,SACT6Y,WAAY,EAAA9Y,EAAEC,SACd4D,SAAU,EAAA7D,EAAEC,WAGd,MAAa8Y,iCAAgC,IAAA/B,cAAa,EAAA6B,wBAA1D,kDAEA,MAAaG,iDAAgD,IAAAhC,cAC3D,EAAA6B,qBAAqBD,MAAM,EAAAP,2BAD7B,kFAIa,EAAAY,oBAAsB,EAAAjZ,EAAEkC,OAAO,CAC1CgX,aAAc,EAAAlZ,EAAEC,SAChBkZ,WAAY,EAAAnZ,EAAEC,SACdmZ,cAAe,EAAApZ,EAAEC,SACjBoZ,OAAQ,EAAArZ,EAAEC,SACVqZ,MAAO,EAAAtZ,EAAEC,SACTuX,QAAS,EAAAxX,EAAEC,SACXsZ,UAAW,EAAAvZ,EAAEC,WAIF,EAAAuZ,aAAe,EAAAxZ,EAAEkC,OAAO,CACnCmX,OAAQ,EAAArZ,EAAEC,SACVwZ,SAAU,EAAAzZ,EAAEC,SACZyZ,IAAK,EAAA1Z,EAAE6M,SACP8M,WAAY,EAAA3Z,EAAEC,SACduX,QAAS,EAAAxX,EAAEC,SACX2Z,SAAU,EAAA5Z,EAAEC,SACZ4Z,KAAM,EAAA7Z,EAAEC,SACR6Z,SAAU,EAAA9Z,EAAEC,SACZ8Z,QAAS,EAAA/Z,EAAEC,SACX+Z,UAAW,EAAAha,EAAEoP,MAAM,EAAApP,EAAEC,YAIV,EAAAga,qBAAuB,EAAAja,EAAEkC,OAAO,CAC3CoH,KAAM,EAAAtJ,EAAEC,WAGV,MAAaia,iDAAgD,IAAAlD,cAC3D,EAAAiD,qBAAqBrB,MAAM,EAAAP,2BAD7B,kFAIa,EAAA8B,2BAA6B,EAAAna,EAAEkC,OAAO,CACjDuW,MAAO,EAAAzY,EAAEC,WAGX,MAAama,uCAAsC,IAAApD,cAAa,EAAAmD,8BAAhE,8DAEA,MAAaE,gDAA+C,IAAArD,cAC1D,EAAAmD,2BAA2BvB,MAAM,EAAAP,2BADnC,gFAIA,MAAaiC,iCAAgC,IAAAtD,cAC3C,EAAAmD,2BAA2BvB,MACzB,EAAA5Y,EAAEkC,OAAO,CACPqY,MAAO,EAAAva,EAAEC,eAHf,kDAQa,EAAAua,oCAAsC,EAAAxa,EAAEkC,OAAO,CAC1DuY,aAAc,EAAAza,EAAEC,SAChB4D,SAAU,EAAA7D,EAAEC,WAGd,MAAaya,gDAA+C,IAAA1D,cAAa,EAAAwD,uCAAzE,gFAEA,MAAaG,yDAAwD,IAAA3D,cACnE,EAAAwD,oCAAoC5B,MAAM,EAAAP,2BAD5C,kGAIA,MAAauC,0BAAyB,IAAA5D,cACpC,EAAAwD,oCAAoC5B,MAClC,EAAA5Y,EAAEkC,OAAO,CACPqY,MAAO,EAAAva,EAAEC,eAHf,oCAQa,EAAA4a,4BAA8B,EAAA7a,EAAEkC,OAAO,CAClDpE,KAAM,EAAAkC,EAAEC,SACR6a,MAAO,EAAA9a,EAAE6M,SACTkO,YAAa,EAAA/a,EAAEC,SACf+a,OAAQ,EAAAhb,EAAE6M,SAASyE,WACnB2J,KAAM,EAAAjb,EAAE6M,SAAS0I,WAAWjE,WAC5B4J,wBAAyB,EAAAlb,EAAEkE,MAAMoN,WACjC6J,WAAY,EAAAnb,EAAE6M,SAAS0I,WAAWjE,WAClC8J,SAAU,EAAApb,EAAEC,SAASsV,WAAWjE,WAChC+J,cAAe,EAAArb,EAAE6M,SAAS0I,WAAWjE,WACrCgK,OAAQ,EAAAtb,EAAEC,SAASsV,WAAWjE,WAC9BiK,WAAY,EAAAvb,EAAEC,SAASsV,WAAWjE,aAGpC,MAAakK,qCAAoC,IAAAxE,cAAa,EAAA6D,+BAA9D,0DAEa,EAAAY,wBAA0B,EAAAzb,EAAEkC,OAAO,CAC9CwZ,QAAS,EAAA1b,EAAEkC,OAAO,CAChB6Y,YAAa,EAAA/a,EAAEkE,MACf+W,KAAM,EAAAjb,EAAE6M,SAAS0I,WACjByF,OAAQ,EAAAhb,EAAE6M,SAAS0I,WACnBoG,eAAgB,EAAA3b,EAAE6M,SAAS0I,eAIlB,EAAAqG,wBAA0B,EAAA5b,EAAEkC,OAAO,CAC9CwZ,QAAS,EAAA1b,EAAEkC,OAAO,CAChB6Y,YAAa,EAAA/a,EAAEkE,MACf+W,KAAM,EAAAjb,EAAE6M,SAAS0I,WACjByF,OAAQ,EAAAhb,EAAE6M,SAAS0I,WACnBoG,eAAgB,EAAA3b,EAAE6M,SAAS0I,eAIlB,EAAAsG,iBAAmB,EAAA7b,EAAEkC,OAAO,CACvC6J,OAAQ,EAAA/L,EAAE6M,SACViP,YAAa,EAAA9b,EAAEC,SACf8b,eAAgB,EAAA/b,EAAEC,SAClB+b,MAAO,EAAAhc,EAAEkC,OAAO,CACdmX,OAAQ,EAAArZ,EAAEC,aAMD,EAAAgc,eAAiB,EAAAjc,EAAEkC,OAAO,CACrCoH,KAAM,EAAAtJ,EAAEC,WAGV,MAAaic,2CAA0C,IAAAlF,cAAa,EAAAiF,eAAerD,MAAM,EAAAP,2BAAzF,sEAEa,EAAA8D,mBAAqB,EAAAnc,EAAEkC,OAAO,CACzCka,OAAQ,EAAApc,EAAE4U,KAAK,CAAC,cAActD,WAC9B+K,MAAO,EAAArc,EAAE6M,SAASyE,aAGpB,MAAagL,+BAA8B,IAAAtF,cAAa,EAAAmF,sBAAxD,8CAEA,MAAaI,6CAA4C,IAAAvF,cAAa,EAAAmF,mBAAmBvD,MAAM,EAAAN,yBAA/F,0EAEa,EAAAkE,kBAAoB,EAAAxc,EAAEkC,OAAO,CACxCua,UAAW,EAAAzc,EAAEC,SACboZ,OAAQ,EAAArZ,EAAEC,SAASqR,aAGrB,MAAaoL,2BAA0B,IAAA1F,cAAa,EAAAwF,qBAApD,sCAEA,MAAaG,4CAA2C,IAAA3F,cAAa,EAAAwF,kBAAkB5D,MAAM,EAAAN,yBAA7F,wEAEa,EAAAsE,yBAA2B,EAAA5c,EAAEkC,OAAO,CAC/C2a,QAAS,EAAA7c,EAAEC,SACX6c,KAAM,EAAA9c,EAAEC,SACR8c,MAAO,EAAA/c,EAAE6M,SACTwM,OAAQ,EAAArZ,EAAEC,SAASqR,aAGrB,MAAa0L,qCAAoC,IAAAhG,cAAa,EAAA4F,4BAA9D,0DAEa,EAAAK,uBAAyB,EAAAT,kBAAkBjN,OAAO,CAAE8J,OAAQ,EAAArZ,EAAEC,WAE3E,MAAaid,kCAAiC,IAAAlG,cAAa,EAAAiG,0BAA3D,oDAEa,EAAAE,uBAAyB,EAAAX,kBAAkBjN,OAAO,CAE7D6N,uBAAwB,EAAApd,EAAEC,WAG5B,MAAaod,gCAA+B,IAAArG,cAAa,EAAAmG,0BAAzD,gDAEA,MAAaG,mDAAkD,IAAAtG,cAC7D,EAAAmG,uBAAuBvE,MAAM,EAAAP,2BAD/B,sFAIa,EAAAkF,kBAAoB,EAAAvd,EAAEkC,OAAO,CACxCsb,YAAa,EAAAxd,EAAEC,WAGjB,MAAawd,8BAA6B,IAAAzG,cAAa,EAAAuG,qBAAvD,4CAEa,EAAAG,qBAAuB,EAAA1d,EAAEkC,OAAO,CAC3CpE,KAAM,EAAAkC,EAAEC,SACR4D,SAAU,EAAA7D,EAAEC,WAGd,MAAa0d,iCAAgC,IAAA3G,cAAa,EAAA0G,wBAA1D,kDAEa,EAAAE,sBAAwB,EAAA5d,EAAEkC,OAAO,CAC5CuW,MAAO,EAAAzY,EAAEC,SACT6W,SAAU,EAAA9W,EAAE6M,SACZhJ,SAAU,EAAA7D,EAAEC,WAGd,MAAa4d,kCAAiC,IAAA7G,cAAa,EAAA4G,yBAA3D,oDAEa,EAAAE,2BAA6B,EAAA9d,EAAEkC,OAAO,CACjDhB,GAAI,EAAAlB,EAAE6M,WAGR,MAAakR,uCAAsC,IAAA/G,cAAa,EAAA8G,8BAAhE,8DAEa,EAAAE,yBAA2B,EAAAhe,EACrCkC,OAAO,CACN+b,IAAK,EAAAje,EAAEC,SACPie,IAAK,EAAAle,EAAEC,SAASsV,WAChB1J,QAAS,EAAA7L,EACNkC,OAAO,CACNuW,MAAO,EAAAzY,EAAEC,SACTke,MAAO,EAAAne,EAAEC,SACTme,QAAS,EAAApe,EAAEC,WAEZoe,UACHC,YAAa,EAAAte,EAAEC,SACfyL,YAAa,EAAA1L,EAAEC,WAEhBoe,UAEH,MAAaE,qCAAoC,IAAAvH,cAAa,EAAAgH,4BAA9D,0DAEa,EAAAQ,oBAAsB,EAAAxe,EAChCkC,OAAO,CACN,2BAAM,EAAAlC,EAAEC,SACR,2BAAM,EAAAD,EAAEoP,MAAM,EAAApP,EAAEC,UAChB,eAAI,EAAAD,EAAEC,SACN,eAAI,EAAAD,EAAEC,WAEPoe,UAEH,MAAaI,gCAA+B,IAAAzH,cAAa,EAAAwH,uBAAzD,gDAEa,EAAAE,kBAAoB,EAAA1e,EAC9BkC,OAAO,CACNhB,GAAI,EAAAlB,EAAE6M,SACN/O,KAAM,EAAAkC,EAAEC,SACR0e,OAAQ,EAAAH,sBAETH,UAEH,MAAaO,8BAA6B,IAAA5H,cAAa,EAAA0H,qBAAvD,4CAEa,EAAAG,kBAAoB,EAAA7e,EAC9BkC,OAAO,CACN4c,KAAM,EAAA9e,EAAEC,SACRV,KAAM,EAAAS,EAAEoP,MAAM,EAAAsP,qBAEfL,UAEU,EAAAU,wBAA0B,EAAA/e,EAAEkC,OAAO,CAAEiW,OAAQ,EAAAnY,EAAEC,WAE5D,MAAa+e,oCAAmC,IAAAhI,cAAa,EAAA+H,2BAA7D,wDAEa,EAAAE,mBAAqB,EAAAjf,EAAEkC,OAAO,CAAEgd,GAAI,EAAAlf,EAAEC,WAEnD,MAAakf,+BAA8B,IAAAnI,cAAa,EAAAiI,sBAAxD,8CAEa,EAAAG,YAAc,EAAApf,EAAEkC,OAAO,CAClC0B,SAAU,EAAA5D,EAAEC,SACZ4D,SAAU,EAAA7D,EAAEC,SAASC,IAAI,KAG3B,MAAamf,wBAAuB,IAAArI,cAAa,EAAAoI,eAAjD,gCAEa,EAAAE,0BAA4B,EAAAtf,EAAEkC,OAAO,CAChD6C,WAAY,EAAA/E,EAAEC,WAGhB,MAAasf,sCAAqC,IAAAvI,cAAa,EAAAsI,6BAA/D,4DAEa,EAAAE,cAAgB,EAAAxf,EAAEkC,OAAO,CACpC4U,SAAU,EAAA9W,EAAE6M,WAGd,MAAa4S,0BAAyB,IAAAzI,cAAa,EAAAwI,iBAAnD,oCAGa,EAAAE,mBAAqB,EAAA1f,EAAEkC,OAAO,CACzCpE,KAAM,EAAAkC,EAAEC,SACRsG,KAAM,EAAAvG,EAAEC,SACRiB,GAAI,EAAAlB,EAAEC,WAOK,EAAA0f,eAAsC,EAAAD,mBAAmBnQ,OAAO,CAC3EjL,SAAU,EAAAtE,EAAE4f,MAAK,IAAM,EAAAD,eAAevQ,QAAQkC,eAGhD,MAAauO,2BAA0B,IAAA7I,cAAa,EAAA2I,kBAApD,sCAEa,EAAAG,sBAAwB,EAAA9f,EAAEkC,OAAO,CAC5C6d,OAAQ,EAAA/f,EAAE6M,WAGZ,MAAamT,kCAAiC,IAAAhJ,cAAa,EAAA8I,yBAA3D,oDAEA,MAAMG,EAAc,EAAAjgB,EAAEkC,OAAO,CAC3B4U,SAAU,EAAA9W,EAAEC,SACZigB,cAAe,EAAAlgB,EAAEC,SACjBkgB,YAAa,EAAAngB,EAAEgM,MAAM,CAAC,EAAAhM,EAAE6M,SAAU,EAAA7M,EAAEC,aAGtC,MAAamgB,wBAAuB,IAAApJ,cAAaiJ,KAAjD,gCAEA,MAAMI,EAAoB,EAAArgB,EAAEkC,OAAO,CACjCoe,OAAQ,EAAAtgB,EAAEC,WAGZ,MAAasgB,8BAA6B,IAAAvJ,cAAaqJ,KAAvD,4CAEa,EAAAG,eAAiB,EAAAxgB,EAAEkC,OAAO,CACrCue,WAAY,EAAAzgB,EAAEoP,MAAM,EAAApP,EAAEC,W,8FClgBxB,gBAGA,UASA,UACA,SACA,UACA,UACA,UACA,UACA,UACA,UAEa,EAAAygB,mBAAqB,IAAI,EAAAlgB,iBAAiB7C,KACrD,IAAAgjB,mBAAkBhjB,EAAM,EAAAoM,kBAAmB,EAAA6W,cAC3C,IAAAD,mBAAkBhjB,EAAM,EAAAqM,0BAA2B,EAAA6W,qBAEnDljB,EAAK,EAAAsM,qBAAqBrJ,GAAG,EAAAkgB,eAAehgB,mBAE5CnD,EAA0B,EAAA+L,2BAA2B9I,GAAG,EAAAmgB,qBAAqBjgB,mBAC7EnD,EAAkB,EAAAmM,mBAAmBlJ,GAAG,EAAAogB,aAAalgB,mBAErDnD,EAAwB,EAAAkM,yBAAyBjJ,GAAG,EAAAqgB,mBAAmBC,mBACvEvjB,EAA4C,8BAA8BC,WACxEC,GACUmC,IACN,MAAM+B,EAAclE,EAAQL,UAAU2jB,IAAuB,EAAAtX,yBAE7D,OADA9H,EAAYqf,WAAWphB,GAChB+B,CAAW,IAIxBpE,EAAoC,EAAAuM,qCACjCtJ,GAAG,EAAAygB,+BACHH,kBAAkB,G,mIC1CvB,cAAS,mFAAAnX,iBAAiB,IAAE,qFAAAE,mBAAmB,IAE/C,0BACA,0BACA,0BACA,yBACA,0BACA,0BACA,0BAEA,0BACA,0BACA,0BACA,0BACA,0BACA,wB,4GCfA,UACA,0BACA,UAGA,UACA,UAQO,IAAM2W,EAAW,EAAjB,MAAMA,YAGX,WAAAzkB,CAGsC2Y,EACOwM,EAChBjf,GAFS,KAAAyS,OAAAA,EACO,KAAAwM,oBAAAA,EAG3C/e,KAAKC,OAASH,EAAc,EAAYvE,KAC1C,CAEM,GAAAqjB,CAAII,EAAcC,EAAkBrd,G,mDACxC5B,KAAKC,OAAOtF,IAAI,eAAeiC,KAAKC,UAAUmiB,aAAmBC,aAAoBriB,KAAKC,UAAU+E,OACpG,MAAMsd,QAAqBlf,KAAK+e,oBAAoBI,YAAYF,EAAUrd,GAC1E,GAAIwd,EAAEC,QAAQH,GACZ,MAAO,CAAC,EAEV,MAAM,SAAEI,EAAQ,OAAEzF,EAAM,MAAE0F,GAAUL,EACpC,GAAe,eAAXrF,EAAyB,CAC3B,MAAMvU,QAAYtF,KAAKuS,OAAO+M,GAAUzF,GAAQ0F,GAChD,OAAKja,GAAOA,EAAIka,UAAkB,CAAC,EAC5BJ,EAAE/R,KAAK/H,EAAK,CAAC,aACtB,CACA,GAAe,aAAXuU,EAAuB,CACzB,MAAO7c,EAAM8c,SAAe9Z,KAAKuS,OAAOkN,aAAa,CACnDzf,KAAKuS,OAAO+M,GAAUzF,GAAQ0F,GAC9Bvf,KAAKuS,OAAO+M,GAAUxF,MAAM,CAAE4F,MAAOH,EAAMG,UAE7C,MAAO,CACLC,WAAY,CACVnF,MAAOV,GAET9c,OAEJ,CACF,G,CAEM,GAAA4iB,CAAIZ,EAAcxiB,EAAciI,G,mDACpCzE,KAAKC,OAAOtF,IAAI,eAAeiC,KAAKC,UAAUmiB,cAAoBxiB,cAAiBI,KAAKC,UAAU4H,MAClG,MAAMob,QAAuB7f,KAAK+e,oBAAoBe,cAActjB,EAAMiI,IACpE,SAAE6a,EAAQ,MAAEC,GAAUM,EACtBE,QAAgB/f,KAAKuS,OAAO+M,GAAU3Y,WAAW,CACrD+Y,MAAO,CACL/gB,GAAI4gB,EAAMG,MAAM/gB,IAElBqhB,OAAQZ,EAAEa,UAAUV,EAAMviB,MAAMqI,IAAQ,MAEpC6a,EAAetlB,OAAOC,KAAK0kB,EAAMviB,MAAMmjB,QAAyC,CAACC,EAAKplB,KAC1FolB,EAAIplB,GAAK,CAAC+kB,EAAQ/kB,GAAIukB,EAAMviB,KAAKhC,IAC1BolB,IACN,CAAC,GACE9a,QAAYtF,KAAKuS,OAAO+M,GAAUe,OAAOd,GACzCe,EAAY,CAChBC,QAAShB,EAAMG,MAAM/gB,GACrB6hB,UAAWlB,EACXhK,OAAQ1Y,KAAKC,UAAUmiB,EAAiB,SAAKA,EAAa,KAC1D3d,SAAU2d,EAAmB,UAC7BnF,OAAQ,SACRqG,aAActjB,KAAKC,UAAUqjB,GAC7BO,QAAS,GAEXzgB,KAAKC,OAAOygB,MAAO,SAAS9jB,KAAKC,UAAUyjB,MAC3C,UACQtgB,KAAKuS,OAAOoO,OAAO1kB,OAAO,CAC9Be,KAAMsjB,GAEV,CAAE,MAAOzZ,GACP7G,KAAKC,OAAOO,KAAK,wBAAwB5D,KAAKC,UAAUyjB,KAC1D,CACA,OAAOhb,CACT,G,CAEM,IAAAsb,CAAK5B,EAAcxiB,EAAciI,G,mDACrCzE,KAAKC,OAAOtF,IAAI,kBAAkBiC,KAAKC,UAAUmiB,aAAmBxiB,aAAgBI,KAAKC,UAAU4H,OACnG,MAAMoc,QAAuB7gB,KAAK+e,oBAAoB+B,cAActkB,EAAMiI,IACpE,SAAE6a,EAAQ,MAAEC,GAAUsB,EAE5B,GAAIA,EAAe,YAAa,CAC9B,MAAME,EAAMF,EAAe,YACrBG,EAAQvc,EAAOsc,EAAIxlB,MACnB0lB,EAAeF,EAAIrO,UAAWX,WAS9BpT,SARgBqB,KAAKuS,QAAO,IAAA2O,YAAWD,IAAeta,WAAW,CACrE+Y,MAAO,CACL/gB,GAAIqiB,GAENG,QAAS,CACP,CAAC7B,IAAW,MAGGA,GAAU3gB,GACvB2G,QAAYtF,KAAKuS,OAAO+M,GAAUe,OAAO,CAC7CX,MAAO,CACL/gB,GAAIA,GAEN3B,KAAM,OAAF,wBACCuiB,EAAMviB,MACN,CACDwiB,WAAW,MAKXc,EAAY,CAChBC,QAAS5hB,EACT6hB,UAAWlB,EACXhK,OAAQ1Y,KAAKC,UAAUmiB,EAAiB,SAAKA,EAAa,KAC1D3d,SAAU2d,EAAmB,UAC7BnF,OAAQ,qBACRqG,aAActjB,KAAKC,UAAU0iB,EAAMviB,MACnCyjB,QAAS,GAEXzgB,KAAKC,OAAOygB,MAAO,SAAS9jB,KAAKC,UAAUyjB,MAC3C,UACQtgB,KAAKuS,OAAOoO,OAAO1kB,OAAO,CAC9Be,KAAMsjB,GAEV,CAAE,MAAOzZ,GACP7G,KAAKC,OAAOO,KAAK,wBAAwB5D,KAAKC,UAAUyjB,KAC1D,CACA,OAAOhb,CACT,CAAO,CACL,MAAMA,QAAYtF,KAAKuS,OAAO+M,GAAUrjB,OAAOsjB,GACzCe,EAAY,CAChBC,QAASjb,EAAI3G,GACb6hB,UAAWlB,EACXhK,OAAQ1Y,KAAKC,UAAUmiB,EAAiB,SAAKA,EAAa,KAC1D3d,SAAU2d,EAAmB,UAC7BnF,OAAQ,SACRqG,aAActjB,KAAKC,UAAU0iB,EAAMviB,MACnCyjB,QAAS,GAEXzgB,KAAKC,OAAOygB,MAAO,SAAS9jB,KAAKC,UAAUyjB,MAC3C,UACQtgB,KAAKuS,OAAOoO,OAAO1kB,OAAO,CAC9Be,KAAMsjB,GAEV,CAAE,MAAOzZ,GACP7G,KAAKC,OAAOO,KAAK,wBAAwB5D,KAAKC,UAAUyjB,KAC1D,CAEA,OAAOhb,CACT,CACF,G,CAEM,MAAA8b,CAAOpC,EAAcC,G,mDACzBjf,KAAKC,OAAOtF,IAAI,oBAAoBiC,KAAKC,UAAUmiB,aAAmBC,KACtE,MAAMoC,QAAuBrhB,KAAK+e,oBAAoBuC,6BAA6BrC,IAC7E,SAAEK,EAAQ,MAAEC,SAAgBvf,KAAK+e,oBAAoBwC,cAActC,GACzE,IAAK,MAAMjkB,KAAKJ,OAAOC,KAAKwmB,GAAiB,CAC3C,MAAMG,EAAMH,EAAermB,GAC3B,GAA8B,aAA1BwmB,EAAI,kBAAkC,CAOxC,UANkBxhB,KAAKuS,QAAO,IAAA2O,YAAWlmB,IAAIymB,SAAS,CACpD/B,MAAO,CACLF,WAAW,EACX,CAACgC,EAAIjmB,MAAOgkB,EAAMG,MAAM/gB,OAGpBmG,OAAS,EACf,MAAM,IAAIlE,MAAM,gDAAa4gB,EAAIE,wCAErC,CACF,CAEA,MAAM3B,QAAgB/f,KAAKuS,OAAO+M,GAAU3Y,WAAW,CACrD+Y,MAAO,CACL/gB,GAAI4gB,EAAMG,MAAM/gB,MAGd2G,QAAYtF,KAAKuS,OAAO+M,GAAUe,OAAOd,GAEzCe,EAAY,CAChBC,QAAShB,EAAMG,MAAM/gB,GACrB6hB,UAAWlB,EACXhK,OAAQ1Y,KAAKC,UAAUmiB,EAAiB,SAAKA,EAAa,KAC1D3d,SAAU2d,EAAmB,UAC7BnF,OAAQ,cACRqG,aAActjB,KAAKC,UAAUkjB,GAC7BU,QAAS,GAEXzgB,KAAKC,OAAOygB,MAAO,SAAS9jB,KAAKC,UAAUyjB,MAC3C,UACQtgB,KAAKuS,OAAOoO,OAAO1kB,OAAO,CAC9Be,KAAMsjB,GAEV,CAAE,MAAOzZ,GACP7G,KAAKC,OAAOO,KAAK,wBAAwB5D,KAAKC,UAAUyjB,KAC1D,CACA,OAAOhb,CACT,G,GA9LW,EAAA+Y,YAAAA,E,cAAAA,EAAW,iBADvB,IAAA5f,cAOI,iBAAAoC,QAAO,EAAA8gB,qBACP,iBAAA9gB,QAAO,EAAAsG,4BACP,iBAAAtG,QAAO,oB,4DARCwd,E,+HCbb,UACA,UAGO,IAAMS,EAA6B,EAAnC,MAAMA,8BAGX,WAAAllB,CAAuCkG,GACrCE,KAAKC,OAASH,EAAc,EAA8BvE,KAC5D,CAEA,SAAAqmB,CAAUniB,GACR,MAAMoiB,EAAOpiB,EAAMqiB,uBAAuB9f,KAAK+f,GACtCnnB,OAAOonB,OACZ,CACEzmB,KAAMwmB,EAAExmB,KACR+W,YAAayP,EAAE7S,MAEjB6S,EAAEE,kBAGN,OAAOrnB,OAAOonB,OACZ,CACEzmB,MAAM,IAAA2mB,aAAYziB,EAAMlE,MACxByI,MAAM,IAAAme,QAAO1iB,EAAMlE,MACnB2W,aAAa,IAAAlN,cAAavF,EAAMlE,MAChCyW,YAAa,KACbmB,QAAS0O,EACTtP,QAAQ,EACRQ,YAAY,GAEdtT,EAAMwiB,eAEV,GA7BW,EAAAnD,8BAAAA,E,gCAAAA,EAA6B,iBADzC,IAAArgB,cAIc,iBAAAoC,QAAO,oB,8CAHTie,E,qHCJb,UAGA,UAIO,IAAMR,EAAmB,EAAzB,MAAMA,oBAIX,WAAA1kB,CAC6BkG,EACmBsiB,EACPC,GADO,KAAAD,mBAAAA,EACP,KAAAC,IAAAA,EAEvCriB,KAAKC,OAASH,EAAc,EAAoBvE,KAClD,CAEA,SAAAkI,GACE/I,QAAQ4nB,KAAK,mBACb,MAAM1Z,EAAShO,OAAOC,KAAKmF,KAAKqiB,KAAKlC,QAAO,CAACC,EAAUplB,KACrD,MAAM6L,EAAI7G,KAAKqiB,IAAIrnB,GACnB,GAAI,CAAC,aAAaunB,QAAQ1b,EAAEjN,YAAY2B,OAAS,EAAG,CAClD,MAAMiE,EAAcQ,KAAKoiB,mBAAmBvb,GAC5CuZ,EAAIplB,GAAKwE,EAAYgjB,cAAcC,SAASznB,EAC9C,MACEgF,KAAKC,OAAOhD,MAAM,aAAcjC,GAElC,OAAOolB,CAAG,GACT,CAAC,GAGJ,OAFApgB,KAAK0iB,YAAc9Z,EACnBlO,QAAQioB,QAAQ,mBACT/Z,CACT,CAEM,cAAAga,G,mDACJ,OAAK5iB,KAAK0iB,YAKD1iB,KAAK0iB,aAHZ1iB,KAAKC,OAAOtF,IAAI,0CACTqF,KAAKyD,YAIhB,G,GArCW,EAAA6a,oBAAAA,E,sBAAAA,EAAmB,iBAD/B,IAAA7f,cAMI,iBAAAoC,QAAO,oBACP,iBAAAA,QAAO,+BACP,iBAAAA,QAAO,EAAAgiB,wB,8DAPCvE,E,gFCRb,gBAKA,gBAAqB7Z,GACnB,OAAO,EAAAhH,EAAEqlB,UAAU/T,WAAWgU,SAASnmB,KAAKC,UAAU4H,GACxD,C,qHCNA,UAEA,UAEA,UACA,0BAOA,UASO,IAAM+Z,EAAmB,EAAzB,MAAMA,oBAGX,WAAA5kB,CACqCopB,EACQC,EAChBnjB,GAFQ,KAAAkjB,YAAAA,EACQ,KAAAC,cAAAA,EAG3CjjB,KAAKC,OAASH,EAAc,EAAoBvE,KAClD,CAEA,cAAA2nB,CAAeC,EAA4BC,GACzC,IAAIC,EAAsB,GAkB1B,OAhBEA,EADY,MAAVF,EACUC,EACTjQ,QAASK,QAAOuO,IAGXA,aAAC,EAADA,EAAI,cAG0B,IAAzBA,EAAE,YAAYxP,QAGH,IAAbwP,EAAExP,SAEVvQ,KAAI+f,GAAKA,EAAExmB,OAEF4nB,EAAOzmB,MAAM,KAEpB2mB,EAAUlD,QAAO,CAACC,EAA8BkD,KACrDlD,EAAIkD,IAAO,EACJlD,IACN,CAAC,EACN,CAEM,WAAAjB,CACJF,EACArd,G,mDAaA5B,KAAKC,OAAOygB,MAAO,2BAA2BzB,aAAoBriB,KAAKC,UAAU+E,MAEjF,MAAM2hB,GAAa,IAAAC,WAAUvE,GAC7B,GAA0B,IAAtBsE,EAAWze,OAAc,OAAO5H,QAAQumB,QAAQ,CAAC,GACrD,MAAMC,EAAOH,EAAWA,EAAWze,OAAS,GAEtC6e,EAASJ,EAAWA,EAAWze,OAAS,GAE9C,IAAI8e,EAAeF,EAAKpE,SACpBuE,EAAqBH,EAAK5Q,eAC9B,MAAM4P,QAAoB1iB,KAAKijB,cAAcL,iBAE7C,GAAIe,EAA8B,CAChC,MACMG,EADepB,EAAYiB,EAAO7Q,gBACXM,aAAa7S,MAAKihB,GAAOA,EAAIxd,OAAS0f,EAAKK,SACpED,IACFD,EAAqBC,aAAO,EAAPA,EAAS5R,YAC9B0R,EAAexE,EAAE4E,MAAMF,EAAQ/R,YAEnC,CACA,MAAMqR,EAAoBV,EAAYmB,GAEtC,IAAIhK,EACA0F,EAAQ,CAAC,EAEb,MAAM0E,EAAcriB,EAAc,OAC5BuhB,EAASnjB,KAAKkjB,eAClBe,GAAgBA,EAAYL,GAC5BR,GAGIjC,EAA+B,CAAC,EAetC,GAbgC,iBAArBvf,EAAe,SAAuC,KAArBA,EAAe,SACzDA,EAAe,QAAElF,MAAM,KAAK3B,SAASmpB,IAEnC,MAAMC,EAAiBnkB,KAAKokB,aAAa1B,EAAaU,EAAmBc,GACnEG,EAAYrkB,KAAKkjB,eAAee,EAAYC,GAAgBd,GAClEjC,EAAQ+C,GAAO,CAGblE,OAAQ,OAAF,wBAAOqE,GAAcF,GAC5B,IAIU,MAAXT,EAAK/kB,GAAY,CACnBkb,EAAS,aAET0F,EAAQ,CACNG,MAAO,CACL/gB,SAHcqB,KAAKgjB,YAAYsB,QAAQV,EAAcF,EAAK/kB,KAK5DqhB,OAAQ,OAAF,sCAAOmD,GAAWhC,GAAY,CAAE3B,WAAW,IAErD,KAAO,CACL,MAAMhM,EAASxT,KAAKukB,2BAA2B7B,EAAaU,EAAmBxhB,GAEzE4iB,EAAUxkB,KAAKykB,iBAAiB7iB,GAEtCiY,EAAS,WACT,MAAM6K,EAAO9iB,EAAe,SAAK+iB,OAAO/iB,EAAe,SAAK,GAAK+iB,OAAO/iB,EAAgB,eAAKmD,EACvF6f,EAAOhjB,EAAgB,SAAI+iB,OAAO/iB,EAAgB,eAAKmD,EAC7D,GAAIwe,EAAWze,OAAS,EAAG,CAEzB,MAAM+f,EAAYtB,EAAWA,EAAWze,OAAS,GAEjDya,GAAQ,IAAAuF,QACN,CACEpF,MAAO,OAAF,OACA,CACD,CAAC,GAAGmF,EAAUvF,cAAeuF,EAAUlmB,GACvC6gB,WAAW,GAEVhM,GAELgR,UACAE,OACAE,OACA5E,OAAQ,OAAF,wBAAOmD,GAAWhC,IAE1B,EAAA4D,YAEJ,MACExF,GAAQ,IAAAuF,QACN,CACEpF,MAAO,OAAF,OACA,CACDF,WAAW,GAEVhM,GAELgR,UACAE,OACAE,OACA5E,OAAQ,OAAF,wBAAOmD,GAAWhC,IAE1B,EAAA4D,YAGN,CACA,MAAMzf,EAAM,CACVuU,SACA0F,QACAD,SAAUsE,GAGZ,OADA5jB,KAAKC,OAAOygB,MAAO,qBAAqB9jB,KAAKC,UAAUyI,MAChDA,CACT,G,CAEA,gBAAAmf,CAAiB7iB,GACf,IAAIuC,EACJ,OAAkB,MAAdvC,EAAMuC,KAGD,CAAC,CAAE6gB,UAAW,UAFrB7gB,EAAOvC,EAAMuC,KAKC,MAAZA,EAAK,GACA,CAAC,CAAE,CAACA,EAAK8gB,MAAM,IAAK,SAEpB,CAAC,CAAE,CAAC9gB,GAAO,QAEtB,CASA,YAAAigB,CAAa1B,EAA8C5P,EAAiCoS,GAC1F,MAAMf,EAAiB,CAAC,EACxB,GAAIrR,GAAkBA,EAAeK,QAAS,CAE5C,MAAMgS,EAAYrS,EAAeK,QAAQ5S,MACvC6kB,GAA2B,cAApBA,EAAI9S,aAA+B8S,EAAI1S,UAAW,qBAAuBwS,IAElF,GAAIC,EAAW,CAGb,MAAM,WAAEpT,EAAU,eAAEY,GAAmBwS,EAAUzS,UAE3C2S,EAAY3C,EAAY3Q,EAAa,kBAC3C,IAAIuT,EAAwB,GAE1BA,EAD4B,iBAAnB3S,EACK,CAACA,GAEAA,GAA+B,GAEhD2S,EAAYvqB,SAAQsK,IAElB,MAAMkgB,EAASF,EAAUlS,QAAS5S,MAAK6kB,GAAOA,EAAI7pB,OAAS8J,IAC3D,GAAc,MAAVkgB,EACF,MAAM,IAAI3kB,MAAM,WAAWmR,6BAAsC1M,MAC5D,GAA2B,cAAvBkgB,EAAOjT,YAA6B,CAE7C,MAAMK,EAAiB4S,EAAQ7S,UAAWC,eACpC6S,EAAgBD,EAAQ7S,UAAW,mBAEzC,IAAI+S,EAEFA,EADEtlB,MAAMC,QAAQuS,GACEA,EAEA,CAACA,GAErB,MAAMqN,EAASyF,EAAgBtF,QAAO,CAACC,EAAKkD,KAC1ClD,EAAIkD,IAAO,EACJlD,IACN,CAAC,GAEJ+D,EAAUqB,GAAiB,CACzBxF,OAAQplB,OAAOonB,OACb,CACErjB,IAAI,GAENqhB,GAGN,IAEJ,CACF,CACA,OAAOmE,CACT,CAUA,0BAAAI,CACE7B,EACA5P,EACAlR,GAEA,GAAIA,EAAMyC,YACR,OAAOrE,KAAK0lB,mCAAmC9jB,EAAMyC,aAChD,GAAIzC,EAAM4R,QAAUrT,MAAMC,QAAQwB,EAAM4R,SAAW5R,EAAM4R,OAAO1O,OAAS,EAAG,CAEjF,MAAM0O,EAAS5R,EAAM4R,OACfmS,EAASnS,EAAOoS,WAAUvgB,GAAwB,iBAATA,GAA8B,QAATA,IAC9DwgB,EAAQrS,EAAOoS,WAAUvgB,GAAwB,iBAATA,GAA8B,OAATA,IAC7DC,EAAW,CAAC,EAElB,GAAe,IAAXqgB,EAEF,GADArgB,EAAS,IAAI,IACE,IAAXugB,EAAc,CACErS,EAAOyR,MAAM,GACrBlqB,SAAQsK,GAAQC,EAAS,IAAE7E,KAAKT,KAAK8lB,sBAAsBpD,EAAa5P,EAAgBzN,KACpG,KAAO,CACamO,EAAOyR,MAAM,EAAGY,GACxB9qB,SAAQsK,GAAQC,EAAS,IAAE7E,KAAKT,KAAK8lB,sBAAsBpD,EAAa5P,EAAgBzN,MAClGC,EAAQ,GAAI,GACKkO,EAAOyR,MAAMY,EAAQ,GAC7B9qB,SAAQsK,GAAQC,EAAQ,GAAE7E,KAAKT,KAAK8lB,sBAAsBpD,EAAa5P,EAAgBzN,KAClG,KACK,IAAc,IAAVwgB,EAaT,MAAM,IAAIjlB,MAAM,gBAXhB,GADA0E,EAAQ,GAAI,IACI,IAAZqgB,EAAe,CACAnS,EAAOyR,MAAM,GACrBlqB,SAAQsK,GAAQC,EAAQ,GAAE7E,KAAKT,KAAK8lB,sBAAsBpD,EAAa5P,EAAgBzN,KAClG,KAAO,CACYmO,EAAOyR,MAAM,EAAGU,GACxB5qB,SAAQsK,GAAQC,EAAQ,GAAE7E,KAAKT,KAAK8lB,sBAAsBpD,EAAa5P,EAAgBzN,MAChGC,EAAS,IAAI,GACKkO,EAAOyR,MAAMU,EAAS,GAC9B5qB,SAAQsK,GAAQC,EAAS,IAAE7E,KAAKT,KAAK8lB,sBAAsBpD,EAAa5P,EAAgBzN,KACpG,CAGF,CACA,OAAOC,CACT,CAAO,OACM,MAAX1D,EAAMmkB,GACN5lB,MAAMC,QAAQ0S,EAAeI,qBAC7BJ,EAAeI,mBAAmBpO,OAAS,EAEpC,CACLuP,GAAIvB,EAAeI,mBAAmBiN,QAAO,CAACC,EAAKkD,KACjDlD,EAAI3f,KAAK,CAAE,CAAC6iB,GAAM,CAAE0C,SAAUpkB,EAAMmkB,KAC7B3F,IACN,KAGE,CAAC,CAEZ,CAEA,kCAAAsF,CAAmCO,GACjC,MAAMC,EAAY,EAAAtS,gBAAgBhQ,UAAUqiB,GAC5C,GAAIC,EAAUniB,QACZ,OAAOqb,EAAEa,UAAUiG,EAAUlpB,MAAM,CAACiF,EAAGjH,KAC9B,CACL,CAACiH,EAAEiN,MAAOjN,EAAEuR,WAGX,CACL,MAAM0S,EAAY,EAAApS,gBAAgBlQ,UAAUqiB,GAC5C,GAAIC,EAAUniB,QAAS,CACrB,MAAMuB,EAA2B,CAAC,EAClC,IAAK,MAAMtK,KAAKJ,OAAOC,KAAKqrB,EAAUlpB,MAAO,CAC3C,MAAMqI,EAAO6gB,EAAUlpB,KAAKhC,GAC5B,GAAsB,OAAlBqK,EAAKqO,SAAmB,CACZ,MAAVpO,EAAI+O,KACN/O,EAAI+O,GAAK,IAEX,IAAK,MAAM8R,KAAQ9gB,EAAKsO,WACtBrO,EAAI+O,GAAG5T,KAAK,CACV,CAACzF,GAAI,CACH,CAACmrB,EAAKjX,MAAOiX,EAAK3S,SAI1B,CACF,CACA,OAAOlO,CACT,CACE,MAAO,CAAC,CAEZ,CACF,CAEM,aAAAwa,CAAcb,EAAkBxa,G,mDACpCzE,KAAKC,OAAOygB,MAAO,aAAazB,YAAmBriB,KAAKC,UAAU4H,MAElE,MAAM2hB,GAAW,IAAA5C,WAAUvE,IACrB,SAAEK,EAAQ,GAAE3gB,EAAE,eAAEmU,GAAmBsT,EAASA,EAASthB,OAAS,GAC9D4d,QAAoB1iB,KAAKijB,cAAcL,iBAE7C5iB,KAAKqmB,qBAAqB3D,EAAa5P,EAAgBrO,GACvD,MAAMa,EAAM,CACVga,WACAC,MAAO,CACLG,MAAO,CAAE/gB,GAAIA,GACb3B,KAAMyH,IAIV,OADAzE,KAAKC,OAAOygB,MAAO9jB,KAAKC,UAAUyI,IAC3BA,CACT,G,CAGM,4BAAAgc,CAA6BrC,G,mDACjC,MAAMmH,GAAW,IAAA5C,WAAUvE,IACrB,OAAE8E,EAAM,eAAEjR,GAAmBsT,EAASA,EAASthB,OAAS,GACxD4d,QAAoB1iB,KAAKijB,cAAcL,iBACvCQ,EAAoBV,EAAY5P,GACtC,GAAsC,MAAlCsQ,EAAkBhQ,aACpB,MAAO,CAAC,EAuBV,OArBYgQ,EAAkBhQ,aAAa+M,QAAO,CAACC,EAAKkD,KACtD,MAAMgD,EAAY5D,EAAYY,EAAIvR,WAAa,kBAC/C,GAAiB,MAAbuU,EACF,MAAM,IAAI1lB,MAAM,GAAGkS,uBAAoCwQ,EAAIvR,sBAE7D,MAAMwU,EAASD,EAAUnT,QAAS5S,MAChCimB,GAAyB,cAAnBA,EAAGlU,aAA+BkU,EAAG9T,UAAWX,cAAe,IAAAmQ,aAAY6B,KAEnF,GAAc,MAAVwC,EACF,MAAM,IAAI3lB,MAAM,+BAElB,MAA4C,aAAxC2lB,EAAO7T,UAAW,mBACpB0N,EAAIkD,EAAIvR,YAAc,CACpB,iBAAkBwU,EAAO7T,UAAW,kBACpCnX,KAAMgrB,EAAOhrB,KACbmmB,mBAAoB4E,EAAUrU,cAEzBmO,GAEFA,CAAG,GACT,CAAC,EAEN,G,CAEM,aAAAmB,CAActC,G,mDAClB,MAAMmH,GAAW,IAAA5C,WAAUvE,IACrB,SAAEK,EAAQ,OAAEyE,EAAM,GAAEplB,EAAE,eAAEmU,GAAmBsT,EAASA,EAASthB,OAAS,GACtE4d,QAAoB1iB,KAAKijB,cAAcL,iBACvCQ,EAAoBV,EAAY5P,GACtC,IACIqO,EAqBAsF,EAtBAC,EAAqB,CAAC,EAuB1B,GArBsC,MAAlCtD,EAAkBhQ,eACpBsT,EAAgBtD,EAAkBhQ,aAAa+M,QAAO,CAACC,EAAKkD,KAC1D,MACMiD,EADY7D,EAAYY,EAAIvR,WAAa,kBACtBoB,QAAS5S,MAChCimB,GAAyB,cAAnBA,EAAGlU,aAA+BkU,EAAG9T,UAAWX,cAAe,IAAAmQ,aAAY6B,KAEnF,GAAc,MAAVwC,EACF,MAAM,IAAI3lB,MAAM,+BASlB,MAP4C,aAAxC2lB,EAAO7T,UAAW,oBACpB0N,EAAIkD,EAAI/nB,MAAQ,CACdorB,IAAK,IAEQ,MAAXxF,IAAiBA,EAAU,CAAC,GAChCA,EAAQmC,EAAI/nB,OAAQ,GAEf6kB,CAAG,GACT,CAAC,IAII,MAANzhB,EACF,MAAM,IAAIiC,MAAM,UAAU0e,cAE1BmH,QAAYzmB,KAAKgjB,YAAYsB,QAAQhF,EAAU3gB,GAEjD,MAAM2G,EAAM,CACVga,WACAC,MAAO,CACLG,MAAO,CACL/gB,GAAI8nB,GAENzpB,KAAMpC,OAAOonB,OACX,CACExC,WAAW,GAEbkH,GAEFvF,YAIJ,OADAnhB,KAAKC,OAAOygB,MAAO9jB,KAAKC,UAAUyI,IAC3BA,CACT,G,CAEA,qBAAAwgB,CACEpD,EACA5P,EACAzN,GAGA,MAAMrK,EAAIJ,OAAOC,KAAKwK,GAAM,GAE5BA,EAAKrK,GAAKokB,EAAEwH,QAAgCvhB,EAAKrK,IAAI,CAACA,EAAGiH,KACvD,OAAQjH,GACN,IAAK,KACH,MAAO,SACT,IAAK,MACH,MAAO,MACT,QACE,OAAOA,EACX,IAGFqK,EAAKrK,GAAKokB,EAAEa,UAA2C5a,EAAKrK,IAAIiH,IAE9D,MAAM4kB,EAAK7rB,EAAE0B,MAAM,KACnB,IAAI0oB,EACJ,GAAkB,IAAdyB,EAAG/hB,OAAc,CACnB,MAAMgiB,EAAShU,EAAeK,QAAS5S,MAAK6kB,GACf,cAApBA,EAAI9S,aAA+B8S,EAAI1S,UAAW,qBAAuBmU,EAAG,KAGrFzB,EADkB1C,EAAYoE,EAAQpU,UAAWX,WAAa,kBAC9CoB,QAAS5S,MAAK8E,GAAQA,EAAK9J,OAASsrB,EAAG,IACzD,MACEzB,EAAMtS,EAAeK,QAAS5S,MAAK8E,GAAQA,EAAK9J,OAASP,IAE3D,OAAIoqB,GAAO,CAAC,SAAU,YAAY7C,QAAQ6C,EAAI9S,cAAiB,EACtDrQ,GACE,IAAA8kB,cAAa9kB,GACf0iB,OAAO1iB,GAEPA,CACT,IAIF,MAAMqD,EAAM,CAAC,EAIb,OAHA,IAAAvK,SAAQsK,GAAM,CAACsM,EAAOqV,MACpB,IAAAL,KAAIrhB,EAAK0hB,EAAIC,QAAQ,MAAO,KAAMtV,EAAM,IAEnCrM,CACT,CAEM,aAAAwb,CAAc7B,EAAkBxa,G,mDACpC,MAAM2hB,GAAW,IAAA5C,WAAUvE,IAErB,SAAEK,EAAQ,eAAExM,GAAmBsT,EAASA,EAASthB,OAAS,GAC1D4d,QAAoB1iB,KAAKijB,cAAcL,iBAC7C5iB,KAAKqmB,qBAAqB3D,EAAa5P,EAAgBrO,GACvD,MAGMyiB,EAHoBxE,EAAY5P,GAGDK,QAASK,QAAO4R,GACxB,cAApBA,EAAI9S,aAA+B8S,EAAI1S,UAAW,cAG3D,GAA0B,IAAtBwU,EAAWpiB,OACb,MAAO,CACL+U,OAAQ,SACRyF,SAAUA,EACVC,MAAO,CACLviB,KAAMyH,IAGL,GAAIyiB,EAAWpiB,OAAS,EAC7B,MAAM,IAAIlE,MAAM,mCACX,CACL,MAAMumB,EAAYD,EAAW,GAE7B,MAAO,CACLrN,OAAQ,SACRyF,SAAUA,EACVC,MAAO,CACLviB,KAAMyH,GAER,WAAY0iB,EAEhB,CACF,G,CAEA,oBAAAd,CAAqB3D,EAAuD5P,EAAwBrO,GAElG,MAAM2iB,EAA2B,GAC3BhE,EAAoBV,EAAY5P,GAElCsQ,GACFxoB,OAAOC,KAAK4J,GAAQ1J,SAASC,I,MAC3B,MAAMqsB,EAAQjE,EAAkBjQ,SAAWiQ,EAAkBjQ,QAAQ5S,MAAK6kB,GAAOA,EAAI7pB,OAASP,IAC9F,GAAIqsB,GAA+B,cAAtBA,EAAM/U,YAA6B,CAC9C,MAAMkT,EAA+B,QAAf,EAAA6B,EAAM3U,iBAAS,eAAG,mBACpC8S,GACF4B,EAAe3mB,KAAK+kB,EAExB,KAGJ4B,EAAersB,SAAQC,WACdyJ,EAAOzJ,EAAE,GAEpB,GAniBW,EAAAwjB,oBAAAA,E,sBAAAA,EAAmB,iBAD/B,IAAA/f,cAKI,iBAAAoC,QAAO,EAAA0G,oBACP,iBAAA1G,QAAO,EAAA4G,4BACP,iBAAA5G,QAAO,oB,4DANC2d,E,6GCtBb,UACA,UACA,UAIO,IAAMC,EAAW,EAAjB,MAAMA,YAGX,WAAA7kB,CAGsC2Y,EACTzS,GADS,KAAAyS,OAAAA,EAGpCvS,KAAKC,OAASH,EAAc,EAAYvE,KAC1C,CAEM,OAAA+oB,CAAQhF,EAAkB3gB,G,mDAC9B,MAAM2oB,GAAY,IAAApF,aAAY5C,GAI9B,MAAwB,eAHLtf,KAAKuS,OAAOgV,YACVC,SAASF,GAAWnE,OAAO5iB,MAAM8E,GAA4B,OAAdA,EAAK9J,OAE1D2T,MAAgC,iBAAPvQ,EAAkB8oB,SAAS9oB,GAAMA,CAC3E,G,GAlBW,EAAA8f,YAAAA,E,cAAAA,EAAW,iBADvB,IAAAhgB,cAOI,iBAAAoC,QAAO,EAAA8gB,qBACP,iBAAA9gB,QAAO,oB,qDAPC4d,E,+GCLb,UAGA,UAIO,IAAMF,EAAa,EAAnB,MAAMA,cAIX,WAAA3kB,CAC6BkG,EACmBsiB,EACPC,GADO,KAAAD,mBAAAA,EACP,KAAAC,IAAAA,EAEvCriB,KAAKC,OAASH,EAAc,EAAcvE,KAC5C,CAEA,SAAAkI,GACE/I,QAAQ4nB,KAAK,mBACb,MAAM1Z,EAAShO,OAAOC,KAAKmF,KAAKqiB,KAAKlC,QAAO,CAACC,EAAUplB,KACrD,MAAM6L,EAAI7G,KAAKqiB,IAAIrnB,GACnB,GAAI,CAAC,aAAaunB,QAAQ1b,EAAEjN,YAAY2B,OAAS,EAAG,CAClD,MAAMiE,EAAcQ,KAAKoiB,mBAAmBvb,GAC5CuZ,EAAIplB,GAAKwE,EAAYgjB,cAAcC,SAASznB,EAC9C,MACEgF,KAAKC,OAAOhD,MAAM,aAAcjC,GAElC,OAAOolB,CAAG,GACT,CAAC,GAGJ,OAFApgB,KAAK0iB,YAAc9Z,EACnBlO,QAAQioB,QAAQ,mBACT/Z,CACT,CAEM,cAAAga,G,mDACJ,OAAK5iB,KAAK0iB,YAKD1iB,KAAK0iB,aAHZ1iB,KAAKC,OAAOtF,IAAI,0CACTqF,KAAKyD,YAIhB,G,GArCW,EAAA8a,cAAAA,E,gBAAAA,EAAa,iBADzB,IAAA9f,cAMI,iBAAAoC,QAAO,oBACP,iBAAAA,QAAO,+BACP,iBAAAA,QAAO,EAAAgiB,wB,8DAPCtE,E,mHCPb,UAEA,UACA,UAGO,IAAMG,EAAiB,EAAvB,MAAMA,kBAKX,WAAA9kB,CAAuCkG,GACrCE,KAAKC,OAASH,EAAc,EAAkBvE,KAChD,CAEA,UAAAsjB,CAAWphB,GACTuC,KAAK0nB,QAAUjqB,CACjB,CAEA,WAAA+kB,GACE,IAAKxiB,KAAK0nB,QAAS,CACjB,MAAMC,EAAS,6BAEf,MADA3nB,KAAKC,OAAOhD,MAAM0qB,GACZ,IAAI/mB,MAAM+mB,EAClB,CAEA,OADA3nB,KAAK4nB,YAAa,IAAAC,cAAa7nB,KAAK0nB,SAC7B1nB,IACT,CAEA,QAAAyiB,CAASpf,G,QACP,MAAMykB,GAAO,IAAI,qBAAuBnB,IAAI3mB,KAAK4nB,YAAYG,SAE7D,IAAKD,EAAK9jB,KAAM,MAAM,IAAIpD,MAAM,YAAYhE,KAAKC,UAAUirB,MAC3D,OAAO,OAAP,wBACKA,GAAI,CACP5V,YAAa7O,EACb8P,QAAqB,QAAZ,EAAA2U,EAAK3U,eAAO,eACjBK,QAAOwU,GAAgB,cAAXA,EAAEzsB,OACfyG,KAAIojB,I,MACH,OAAO,OAAP,sCACKA,GAGCA,EAAY,aAAW,CAC3B7S,UAC4B,QAA1B,EAAC6S,aAAG,EAAHA,EAAc,mBAAW,eAAE7S,SAA8C,UAAnC6S,EAAY,YAAY7S,cAA6BxN,GAAS,IAG7GqO,aAA+B,QAAjB,EAAA0U,EAAK1U,oBAAY,eAAEpR,KAAIwf,GAC5B,OAAP,wBACKA,GAAG,CACNtP,aAAa,IAAA+V,uBAAsBzG,EAAIzP,iBAI/C,GAjDW,EAAA2M,kBAAAA,E,oBAAAA,EAAiB,iBAD7B,IAAAjgB,cAMc,iBAAAoC,QAAO,oB,8CALT6d,E,6FCLb,gCAAqCva,GACnC,OAAkB,MAAXA,EAAK,GAA+B,QAAjBA,EAAK,GAAGA,KAAiBA,EAAK,GAAGgQ,MAAQ,IAAMhQ,EAAK,GAAGgQ,WAASpP,CAC5F,C,qGCJA,MAAMmjB,EAAwC,CAC5C,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,QAGL,SAASC,EAAMC,GACb,MAAO,mBACOF,EAAcE,8FAM9B,CAEA,iBAAsBC,GACpB,MAAO,CAAC,YAAaF,EAAM,GAAI,GAAIE,EACrC,EAEA,gBAAqBA,GACnB,MAAO,CAAC,WAAYF,EAAM,GAAI,GAAIE,EACpC,EAEA,gBAAqBA,GACnB,MAAO,CAAC,WAAYF,EAAM,GAAI,GAAIE,EACpC,EAEA,iBAAsBA,GACpB,MAAO,CAAC,YAAaF,EAAM,GAAI,GAAIE,EACrC,C,qFC/BA,MAAaC,oBAAoB1nB,MAG/B,WAAAhH,CAAYmN,EAAcwI,EAAiBgZ,GACzCC,MAAM5rB,KAAKC,UAAU,CAAEkK,KAAMA,EAAMwI,aACnCvP,KAAKuP,QAAU3S,KAAKC,UAAU,CAAEkK,OAAMwI,UAASgZ,SACjD,EANF,yB,wHCAA,6BACA,6BACA,6BAEA,6BAEA,UAAMvb,OAAO,WACb,UAAMA,OAAO,WACb,UAAMA,OAAO,WAEb,yBAA8BrP,GAC5B,MACM2H,GADM,eAAQmjB,GAAG,iBAAiBC,IAAI/qB,EAAK,UAAU6U,OAAO,yBAClDmW,MAAM,iBACtB,OAAW,MAAPrjB,EACK,GAEAA,EAAI,GAAG2hB,QAAQ3hB,EAAI,GAAIA,EAAI,GAAGsjB,SAAS,EAAG,KAAO,MAE5D,EAEA,wBAA6BC,GAC3B,OAAO,eAAQJ,GAAG,iBAAiBC,IAAIG,EAAK,OAAOC,QACrD,C,kLCtBA,yBACA,0BAEAC,EAAKC,gBAAgB,SAAU,QAC/BD,EAAKE,cAAc,SAAU,QAC7BF,EAAKC,gBAAgB,QAAS,OAC9BD,EAAKE,cAAc,QAAS,OAC5BF,EAAKC,gBAAgB,QAAS,OAC9BD,EAAKE,cAAc,QAAS,OAG5BF,EAAKC,gBAAgB,iBAAkB,gBACvCD,EAAKE,cAAc,iBAAkB,gBAGrC,MAAMC,EAAM,uCAENC,EAAU,kBAUhB,SAAgBpC,EAAapV,GAC3B,OAAOwX,EAAQC,KAAKzX,EACtB,CAEA,SAAgBuQ,EAAYle,GAC1B,OAAOob,EAAEiK,UAAUjK,EAAEkK,UAAUP,EAAKQ,SAASvlB,KAAQijB,QAAQ,KAAM,GACrE,CAWA,SAAgBjiB,EAAahB,GAE3B,OAAOke,EADG6G,EAAKQ,SAASvlB,IACA,gBAC1B,CApBA,iBAIA,gBAIA,kBAAuBsjB,GACrB,OAAOyB,EAAKS,OAAOpK,EAAEqK,UAAUnC,GACjC,EAOA,iBAKA,iCAAsCA,GAEpC,OADUyB,EAAKQ,SAASjC,GACb,gBACb,EAEA,qBAA0B9qB,GACxB,MAAMktB,EAAOltB,EAAKmsB,MAAMO,GAExB,GAAY,MAARQ,EAAc,CAYhB,OAXaA,EAAK1nB,KAAIqD,IACpB,MAAOia,EAAU3gB,GAAM0G,EAAK3I,MAAM,KAE5BitB,EAAIZ,EAAKQ,SAASjK,GACxB,MAAO,CACLA,SAAUF,EAAEkK,UAAUK,GACtB7W,eAAgB9N,EAAasa,GAC7ByE,OAAQzE,EACR3gB,GAAIooB,EAAapoB,GAAMygB,EAAEwK,SAASjrB,GAAMA,EACzC,GAGL,CACE,MAAO,EAEX,C,gGCvEA,kCAAuC+jB,EAA8CzH,GACnF,MAAMjgB,EAAIJ,OAAOC,KAAK6nB,GAAaniB,MAAKvF,GAC/B0nB,EAAY1nB,GAAGiX,eAAiBgJ,IAEzC,OAAIjgB,EACK0nB,EAAY1nB,GAEZ,IAEX,C,WCXA6uB,EAAO9tB,QAAU+tB,QAAQ,iB,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,gB,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,iB,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,e,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,e,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,e,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,gC,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,Q,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,U,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,Q,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,8B,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,wB,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,mB,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,wB,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,Y,UCAzBD,EAAO9tB,QAAU+tB,QAAQ,e,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,S,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,a,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,e,UCAzBD,EAAO9tB,QAAU+tB,QAAQ,Y,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,K,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,S,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,Q,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,M,WCAzBD,EAAO9tB,QAAU+tB,QAAQ,M,GCCrBC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBllB,IAAjBmlB,EACH,OAAOA,EAAanuB,QAGrB,IAAI8tB,EAASE,EAAyBE,GAAY,CAGjDluB,QAAS,CAAC,GAOX,OAHAouB,EAAoBF,GAAUJ,EAAQA,EAAO9tB,QAASiuB,GAG/CH,EAAO9tB,OACf,C,wFCtBA,UACA,UAEA,UACA,UACA,UACA,UAEA,0BAEA,W,4CACE,MAAM8J,QAAY,EAAAukB,YAAYnuB,OAAO,EAAAjC,WAErC6L,EAAIwkB,aACJ,MAAMvkB,EAAe,qBACrBD,EAAIykB,gBAAgBxkB,GAEPD,EAAI+Y,IAAI,EAAA1f,YAChB0G,gBAAgBC,EAAKC,GAE1BD,EAAIzJ,KAAI,CAACiK,EAAKkkB,EAAKvjB,KACjB,GAAIX,EAAImkB,YAAYC,SAAS,eAC3BF,EAAI/gB,OAAO,KAAKkhB,WACX,GAAIrkB,EAAI/J,IAAIimB,QAAQ,IAAIzc,2BAAwC,EAAG,CACxE,MACM6kB,EADU,EAAAC,WAAWC,6BACPC,CAAQzkB,GAC5B,GAAIskB,EACF,IACiBlkB,EAAIskB,OAAOJ,EAAa,EAAA7vB,mBAAmB0C,qBAExDwJ,IAEAujB,EAAI/gB,OAAO,KAAKse,KAAK,CACnBvY,QAAS,wBAGf,CAAE,MAAO1I,GACP0jB,EAAI/gB,OAAO,KAAKse,KAAK,CACnBvY,QAAS,wBAEb,MAEAgb,EAAI/gB,OAAO,KAAKse,KAAK,CACnBvY,QAAS,wBAGf,MACEvI,GACF,IAIFnB,EAAIzJ,IACF,IAAI0J,yBACJ,IAAAklB,uBAAsB,CACpBC,SAAU,QACVC,OAAQ,EAAApwB,mBAAmBkD,YAC3BmtB,cAAc,EACd,UAAAC,CAAWC,GAETA,EAASC,UAAU,eAAgB,oBACnCD,EAASC,UAAU,SAAU,mBAC/B,EACAC,YAAa,CACX,CAAC,KAAKzlB,yBAAqC,mBAKjD,MAAM0lB,EAAOluB,QAAQC,IAAIkuB,MAAQ,WAC3B5lB,EAAI6lB,OAAOF,GACjB,EAAAhwB,OAAOb,IAAI,4DAAkD6wB,KAAQ1lB,IACvE,G,CAEA6lB,E","sources":["webpack://@flowda-projects/flowda-gateway-api/./src/app/app.controller.ts","webpack://@flowda-projects/flowda-gateway-api/./src/app/app.module.ts","webpack://@flowda-projects/flowda-gateway-api/./src/loadModule.ts","webpack://@flowda-projects/flowda-gateway-api/./src/services/services.module.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/axios.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/flowda-gateway-env.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/flowdaGatewayTrpcServer.module.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/index.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/trpc-client.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/trpc/hello.router.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/trpc/hello.utils.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/trpc/trpc.context.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/trpc/trpc.router.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-gateway-trpc-server/src/trpc/trpc.service.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared-types/src/index.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared-types/src/symbols.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared-types/src/types.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared-types/src/zod-utils.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared-types/src/zods-wms.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared-types/src/zods.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/flowdaShared.module.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/index.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/data/data.service.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/dynamicTableSchemaTransformer.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/legacySchemaService.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/meta.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/prismaSchema.service.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/prismaUtils.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/schema.service.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/services/schema/schemaTransformer.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/utils/ag-grid-utils.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/utils/browser-log-utils.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/utils/custom-error.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/utils/dayjs-utils.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/utils/matchPath.ts","webpack://@flowda-projects/flowda-gateway-api/../../libs/flowda-shared/src/utils/schema-utils.ts","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@flowda/schema\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@flowda/types\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@nestjs/common\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@nestjs/core\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@trpc/client\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@trpc/server\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"@trpc/server/adapters/express\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"axios\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"consola\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"dayjs\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"dayjs/plugin/advancedFormat\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"dayjs/plugin/timezone\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"dayjs/plugin/utc\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"http-proxy-middleware\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"inversify\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"jsonwebtoken\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"lodash\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"nestjs-zod\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"passport-jwt\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"pluralize\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"qs\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"radash\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"tslib\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"znv\"","webpack://@flowda-projects/flowda-gateway-api/external commonjs \"zod\"","webpack://@flowda-projects/flowda-gateway-api/webpack/bootstrap","webpack://@flowda-projects/flowda-gateway-api/./src/main.ts"],"sourcesContent":["import { Controller, Get } from '@nestjs/common'\n\n@Controller('/apps')\nexport class AppController {\n  constructor() {}\n\n  @Get('/__hi')\n  async hi() {\n    return {\n      hi: 'flowda-gateway-api',\n    }\n  }\n}\n","import { Module } from '@nestjs/common'\nimport { APP_PIPE } from '@nestjs/core'\n\nimport { AppController } from './app.controller'\nimport { ServicesModule } from '../services/services.module'\nimport { ZodValidationPipe } from 'nestjs-zod'\n\n@Module({\n  imports: [ServicesModule],\n  controllers: [AppController],\n  providers: [\n    // todo 需要网关特有的 ExceptionFilter\n    // {\n    //   provide: APP_FILTER,\n    //   useClass: AppExceptionFilter,\n    // },\n    {\n      provide: APP_PIPE,\n      useClass: ZodValidationPipe,\n    },\n  ],\n})\nexport class AppModule {}\n","/* eslint-disable @typescript-eslint/no-var-requires */\n\nimport { interfaces } from 'inversify'\nimport { FLOWDA_GATEWAY_ENV, flowdaGatewayTrpcServerModule } from '@flowda-projects/flowda-gateway-trpc-server'\nimport { Logger, LoggerService } from '@nestjs/common'\n\nconsole.log('---------- ENV --------------')\nObject.keys(FLOWDA_GATEWAY_ENV).forEach(k => console.log(k, FLOWDA_GATEWAY_ENV[k]))\nconsole.log('---------- ENV --------------')\n\nexport function loadModule(container: interfaces.Container) {\n  container.load(flowdaGatewayTrpcServerModule)\n  container.bind<interfaces.Factory<LoggerService>>('Factory<Logger>').toFactory<LoggerService, [string]>(context => {\n    return name => {\n      return new Logger(name)\n    }\n  })\n}\n","import { Global, Module } from '@nestjs/common'\nimport { Container } from 'inversify'\nimport { getServices } from '@flowda/schema'\nimport { loadModule } from '../loadModule'\n\nexport const servicesContainer = new Container()\nloadModule(servicesContainer)\n\nconst services = getServices(servicesContainer)\n\n@Global()\n@Module({\n  providers: services,\n  exports: services,\n})\nexport class ServicesModule {\n  constructor() {}\n}\n","import axios from 'axios'\nimport * as qs from 'qs'\nimport consola from 'consola'\n\nexport const axiosApiInstance = axios.create()\n\naxiosApiInstance.interceptors.request.use(\n  async config => {\n    if (config.url == null) return config\n    console.info(`url        :`, config.url)\n    const [path, qstr] = config.url.split('?')\n    consola.info(`request : ${config.method} ${path}`)\n    consola.info(`query   : `)\n    console.log(JSON.stringify(qs.parse(qstr)))\n    consola.info(`data    : `)\n    console.log(JSON.stringify(config.data))\n    return config\n  },\n  error => {\n    Promise.reject(error)\n  },\n)\n\naxiosApiInstance.interceptors.response.use(\n  response => {\n    consola.info(`response: ${response.config.url}`)\n    console.log(JSON.stringify(response.data))\n    return response\n  },\n  async function (error) {\n    // console.error(error)\n    return Promise.reject(error)\n  },\n)\n","import { parseEnv } from 'znv'\nimport { z } from 'zod'\n\nexport const FLOWDA_GATEWAY_ENV = parseEnv(process.env, {\n  ACCESS_TOKEN_SECRET: z.string().min(1),\n  FLOWDA_URL: z.string().min(1),\n  CMS_ADMIN_URL: z.string().min(1),\n  YONGCHENG_URL: z.string().min(1),\n  TIANBAO_URL: z.string().min(1),\n  C7_REST_URL: z.string().min(1),\n})\n","import { ContainerModule } from 'inversify'\nimport { bindService } from '@flowda/schema'\nimport { TrpcService } from './trpc/trpc.service'\nimport { TrpcRouter } from './trpc/trpc.router'\nimport { ContextFactory } from './trpc/trpc.context'\nimport { GatewayRegister, HelloRouter } from './trpc/hello.router'\nimport { AxiosInstanceSymbol, GatewayRegisterSymbol } from '@flowda-projects/flowda-shared-types'\nimport { FLOWDA_GATEWAY_ENV } from './flowda-gateway-env'\nimport { AxiosInstance } from 'axios'\nimport { axiosApiInstance } from './axios'\n\nexport const flowdaGatewayTrpcServerModule = new ContainerModule(bind => {\n  bind<AxiosInstance>(AxiosInstanceSymbol).toConstantValue(axiosApiInstance)\n  bind<GatewayRegister>(GatewayRegisterSymbol)\n    .to(GatewayRegister)\n    .inSingletonScope()\n    .onActivation((context, injectable) => {\n      injectable.register([\n        {\n          id: 'superadmin',\n          name: '基础服务',\n          trpcEndpoint: `${FLOWDA_GATEWAY_ENV.FLOWDA_URL}/flowda-api/trpc`,\n        },\n        {\n          id: 'cms_admin',\n          name: 'CMS 管理后台',\n          trpcEndpoint: `${FLOWDA_GATEWAY_ENV.CMS_ADMIN_URL}/cms-admin-api/trpc`,\n        },\n        {\n          id: 'ycdev',\n          name: '永成测试',\n          trpcEndpoint: `${FLOWDA_GATEWAY_ENV.YONGCHENG_URL}/yongcheng-api/trpc`,\n        },\n        {\n          id: 'tianbao_uat',\n          name: '天宝UAT',\n          trpcEndpoint: `${FLOWDA_GATEWAY_ENV.TIANBAO_URL}/api/trpc`,\n        },\n      ])\n      return injectable\n    })\n  bind(TrpcService).toSelf().inSingletonScope()\n  bind(ContextFactory).toSelf().inSingletonScope()\n  bind(HelloRouter).toSelf().inSingletonScope()\n  bindService(bind, TrpcRouter)\n})\n","export * from './flowdaGatewayTrpcServer.module'\nexport * from './trpc/trpc.router'\nexport * from './flowda-gateway-env'\n","import { createTRPCProxyClient, httpBatchLink } from '@trpc/client'\nimport type { AppRouter as FlowdaAppRouter } from '@flowda-projects/flowda-services-trpc-server'\nimport { FLOWDA_GATEWAY_ENV } from './flowda-gateway-env'\n\nexport const flowdaTrpc = createTRPCProxyClient<FlowdaAppRouter>({\n  links: [\n    httpBatchLink({\n      url: `${FLOWDA_GATEWAY_ENV.FLOWDA_URL}/flowda-api/trpc`,\n      async headers() {\n        return {\n          'x-from': 'flowda-gateway',\n        }\n      },\n    }),\n  ],\n  transformer: {\n    input: {\n      // on client\n      serialize: object => object,\n      // on server -> resolver\n      deserialize: object => object,\n    },\n    output: {\n      // on server -> client\n      serialize: object => object,\n      // on client\n      deserialize: object => object,\n    },\n  },\n})\n","import { inject, injectable } from 'inversify'\nimport { TrpcService } from './trpc.service'\nimport type { LoggerService } from '@nestjs/common'\nimport { z } from 'zod'\nimport { flowdaTrpc } from '../trpc-client'\nimport { AxiosInstanceSymbol, GatewayRegisterSymbol } from '@flowda-projects/flowda-shared-types'\nimport { convertSortAgToMotor } from '@flowda-projects/flowda-shared'\nimport { convertMenuToTheia } from './hello.utils'\nimport {\n  findManyResourceDataInputSchema,\n  findUniqueResourceDataInputSchema,\n  getResourceDataInputSchema,\n  getResourceInputSchema,\n  putResourceDataInputSchema,\n} from '@flowda/types'\nimport type { AxiosInstance } from 'axios'\n\ntype Service = {\n  /**\n   * @description 对应租户名称\n   */\n  id: string\n  name: string\n  trpcEndpoint: string\n}\n\n@injectable()\nexport class GatewayRegister {\n  private readonly logger\n\n  constructor(@inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService) {\n    this.logger = loggerFactory(HelloRouter.name)\n  }\n\n  register(serv: Service | Service[]) {\n    if (Array.isArray(serv)) {\n      serv.forEach(s => this.registerItem(s))\n    } else {\n      this.registerItem(serv)\n    }\n  }\n\n  private registerItem(serv: Service) {\n    if (this._services.find(s => s.id === serv.id)) {\n      this.logger.warn(`service ${serv.id} is already registered`)\n      return\n    }\n    this._services.push(serv)\n  }\n\n  private _services: Service[] = []\n\n  get services() {\n    return this._services\n  }\n\n  getTrpc(serviceId: string) {\n    const serv = this._services.find(s => s.id === serviceId)\n    if (!serv) throw new Error(`Not found ${serviceId}`)\n    return serv\n  }\n}\n\n@injectable()\nexport class HelloRouter {\n  private readonly logger\n\n  constructor(\n    @inject(TrpcService) private trpc: TrpcService,\n    @inject(AxiosInstanceSymbol) private axios: AxiosInstance,\n    @inject(GatewayRegisterSymbol) private gatewayRegister: GatewayRegister,\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n  ) {\n    this.logger = loggerFactory(HelloRouter.name)\n  }\n\n  helloRouter = this.trpc.router({\n    validate: this.trpc.procedure\n      .input(\n        z.object({\n          username: z.string(),\n          password: z.string(),\n        }),\n      )\n      .mutation(async ({ input }) => {\n        const ret = await flowdaTrpc.user.validate.mutate(input)\n        return ret\n      }),\n\n    createRoot: this.trpc.procedure.input(z.any()).query(async opts => {\n      const services = this.gatewayRegister.services.map(v => {\n        const { trpcEndpoint, ...rest } = v\n        return {\n          ...rest,\n          selected: false,\n          expanded: false,\n          children: [],\n        }\n      })\n      return {\n        id: 'WorkspaceNodeId',\n        name: 'WorkspaceNode',\n        visible: false,\n        children: services,\n      }\n    }),\n\n    resolveChildren: this.trpc.protectedProcedure.input(z.object({ pid: z.string() })).query(async opts => {\n      const [tenantName, parentId] = opts.input.pid.split('.')\n      const menuData = await flowdaTrpc.menu.getMenuByTenantName.query({ tenantName })\n      return convertMenuToTheia({\n        tenantName,\n        parentId,\n        menuData,\n      })\n    }),\n\n    getResourceSchema: this.trpc.protectedProcedure.input(getResourceInputSchema).query(async ({ input, ctx }) => {\n      const service = this.gatewayRegister.getTrpc(input.tenant)\n      // const schemaCache = await service.trpc.schema.getSchemaCache.query({})\n      const schemaCacheRes = await this.axios.request({\n        url: `${service.trpcEndpoint}/schema.getSchemaCache?input={}`,\n        method: 'get',\n      })\n      const theSchema = schemaCacheRes.data.result.data[input.schemaName]\n      theSchema.namespace = input.tenant\n      return theSchema\n    }),\n\n    getResourceData: this.trpc.protectedProcedure.input(getResourceDataInputSchema).query(async ({ input, ctx }) => {\n      const theSchema = await this.getSchema(input.tenant, input.schemaName)\n      const uniqParam = findUniqueResourceDataInputSchema.safeParse(input)\n      const manyParam = findManyResourceDataInputSchema.safeParse(input)\n      let query: any\n      let path: string\n      if (uniqParam.success) {\n        path = `${theSchema.slug!}/${uniqParam.data.id}`\n        query = {}\n      } else if (manyParam.success) {\n        path = theSchema.slug!\n        query = {\n          pageSize: manyParam.data.pageSize,\n          current: manyParam.data.current,\n          sort: convertSortAgToMotor(manyParam.data.sort),\n          filterModel: manyParam.data.filterModel,\n        }\n      } else {\n        throw new Error(`getResourceData input parse error`)\n      }\n\n      const service = this.gatewayRegister.getTrpc(input.tenant)\n      // return service.trpc.data.get.query({\n      //   user: ctx.user,\n      //   path,\n      //   query,\n      // })\n      const res = await this.axios.request({\n        method: 'get',\n        url: `${service.trpcEndpoint}/data.get?input=${encodeURIComponent(\n          JSON.stringify({\n            user: ctx.user,\n            path,\n            query,\n          }),\n        )}`,\n      })\n      return res.data.result.data\n    }),\n\n    putResourceData: this.trpc.protectedProcedure.input(putResourceDataInputSchema).mutation(async ({ input, ctx }) => {\n      const theSchema = await this.getSchema(input.tenant, input.schemaName)\n      const path = `${theSchema.slug!}/${input.id}`\n      const service = this.gatewayRegister.getTrpc(input.tenant)\n      // return service.trpc.data.put.mutate({\n      //   user: ctx.user,\n      //   path,\n      //   values: input.updatedValue,\n      // })\n      const res = await this.axios.request({\n        method: 'post',\n        url: `${service.trpcEndpoint}/data.put`,\n        data: {\n          user: ctx.user,\n          path,\n          values: input.updatedValue,\n        },\n      })\n      return res.data.result.data\n    }),\n  })\n\n  async getSchema(tenantName: string, schemaName: string) {\n    const service = this.gatewayRegister.getTrpc(tenantName)\n    // const schemaCache = await service.trpc.schema.getSchemaCache.query({})\n    const schemaCacheRes = await this.axios.request({\n      url: `${service.trpcEndpoint}/schema.getSchemaCache?input={}`,\n      method: 'get',\n    })\n    return schemaCacheRes.data.result.data[schemaName]\n  }\n}\n","import { menuItemSchemaDto } from '@flowda-projects/flowda-shared-types'\nimport { toSchemaName } from '@flowda-projects/flowda-shared'\n\nexport function mapMenuItemToTheiaMenu(input: { tenantName: string; menuItem: menuItemSchemaDto }) {\n  const { tenantName, menuItem } = input\n  return {\n    id: `${tenantName}.${menuItem.slug}`,\n    name: menuItem.name,\n    selected: false,\n    uri:\n      Array.isArray(menuItem.children) && menuItem.children.length > 0\n        ? undefined\n        : `grid://${tenantName}?schemaName=${toSchemaName(menuItem.slug)}&displayName=${menuItem.name}`,\n    expanded: Array.isArray(menuItem.children) && menuItem.children.length > 0 ? false : undefined,\n    children: Array.isArray(menuItem.children) && menuItem.children.length > 0 ? [] : undefined,\n  }\n}\n\nexport function convertMenuToTheia(input: {\n  tenantName: string\n  parentId: string | undefined\n  menuData: menuItemSchemaDto[]\n}) {\n  const { tenantName, parentId, menuData } = input\n  if (parentId == null /* 一级菜单 */) {\n    const ret = menuData.map(item => {\n      return mapMenuItemToTheiaMenu({ tenantName, menuItem: item })\n    })\n    return ret\n  } else {\n    let ret\n    menuData.forEach(menuItem =>\n      traverse(menuItem, item => {\n        if (item.slug === parentId) {\n          if (Array.isArray(item.children)) {\n            ret = item.children.map(child => mapMenuItemToTheiaMenu({ tenantName, menuItem: child }))\n          }\n        }\n      }),\n    )\n    return ret\n  }\n}\n\nexport function traverse(tree: menuItemSchemaDto, visit: (item: menuItemSchemaDto) => void) {\n  visit(tree)\n  if (tree.children && Array.isArray(tree.children) && tree.children.length > 0) {\n    tree.children?.forEach(child => {\n      traverse(child, visit)\n    })\n  }\n}\n","import * as trpcExpress from '@trpc/server/adapters/express'\nimport { inject, injectable } from 'inversify'\nimport { LoggerService } from '@nestjs/common'\nimport { createContext, diag } from '@flowda/schema'\n\n@injectable()\nexport class ContextFactory {\n  private readonly logger\n\n  constructor(@inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService) {\n    this.logger = loggerFactory(ContextFactory.name)\n  }\n\n  createContext = async (opts: trpcExpress.CreateExpressContextOptions) => {\n    const ctx = createContext(opts)\n    diag(ctx, `[createContext]`)\n    return ctx\n  }\n}\n\nexport type Context = Awaited<ReturnType<typeof ContextFactory.prototype.createContext>>\n","import { inject, injectable } from 'inversify'\nimport { TrpcService } from './trpc.service'\nimport type { INestApplication, LoggerService } from '@nestjs/common'\nimport * as trpcExpress from '@trpc/server/adapters/express'\nimport { ContextFactory } from './trpc.context'\nimport { HelloRouter } from './hello.router'\n\n// import { createOpenApiExpressMiddleware } from 'trpc-openapi'\n\n@injectable()\nexport class TrpcRouter {\n  private readonly logger\n\n  constructor(\n    @inject(TrpcService) private trpc: TrpcService,\n    @inject(HelloRouter) private helloRouter: HelloRouter,\n    @inject(ContextFactory) private contextFactory: ContextFactory,\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n  ) {\n    this.logger = loggerFactory(TrpcRouter.name)\n  }\n\n  appRouter = this.trpc.router({\n    hello: this.helloRouter.helloRouter,\n  })\n\n  applyMiddleware(app: INestApplication, globalPrefix: string) {\n    this.logger.log(`applyMiddleware ${globalPrefix}/trpc`)\n    // app.use(`/${globalPrefix}/trpc-api`, createOpenApiExpressMiddleware({ router: this.appRouter }))\n    app.use(\n      `/${globalPrefix}/trpc`,\n      trpcExpress.createExpressMiddleware({\n        router: this.appRouter,\n        createContext: this.contextFactory.createContext,\n      }),\n    )\n  }\n}\n\nexport type AppRouter = TrpcRouter[`appRouter`]\n","import { initTRPC, TRPCError } from '@trpc/server'\nimport { inject, injectable } from 'inversify'\nimport { Context } from './trpc.context'\nimport { LoggerService } from '@nestjs/common'\nimport { diag, errorFormatter, transformer } from '@flowda/schema'\nimport { flowdaTrpc } from '../trpc-client'\nimport { ctxUserSchema } from '@flowda/types'\n\n// import { OpenApiMeta } from 'trpc-openapi'\n\n@injectable()\nexport class TrpcService {\n  private readonly logger\n\n  constructor(@inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService) {\n    this.logger = loggerFactory(TrpcService.name)\n  }\n\n  trpc = initTRPC\n    .context<Context>()\n    // .meta<OpenApiMeta>()\n    .create({\n      transformer: transformer,\n      errorFormatter: errorFormatter,\n    })\n\n  procedure = this.trpc.procedure\n\n  protectedProcedure = this.trpc.procedure.use(async function (opts) {\n    const ctx = opts.ctx\n    diag(ctx, `[protectedProcedure]`)\n    let user\n    const at = processAt(ctx.req.headers.authorization)\n    diag(ctx, `processAt`, { at })\n    if (at) {\n      try {\n        const payload = await flowdaTrpc.user.verifyAccessToken.query({ jwt: at })\n        diag(ctx, `flowdaTrpc.user.verifyAccessToken`, payload)\n        const userRet = await flowdaTrpc.user.findUnique.query({ id: payload['uid'] })\n        user = ctxUserSchema.parse(userRet)\n      } catch (e) {\n        diag(ctx, `flowdaTrpc.user.verifyAccessToken`, e)\n      }\n    }\n    if (!user) {\n      throw new TRPCError({ code: 'UNAUTHORIZED' })\n    }\n    ctx.user = user\n    return opts.next({ ctx })\n  })\n\n  router = this.trpc.router\n  mergeRouters = this.trpc.mergeRouters\n}\n\nexport function processAt(input: any) {\n  if (typeof input !== 'string') return undefined\n  if (input.split(' ')[1] == null) return undefined\n  let ret = input.split(' ')[1]\n  if (ret.trim() === '') return undefined\n  ret = ret.trim()\n  if (ret === 'undefined' || ret === 'null') return undefined\n  return ret\n}\n","export * from './symbols'\nexport * from './types'\nexport * from './zods'\nexport * from './zods-wms'\nexport * from './zod-utils'\n","export const PrismaSchemaServiceSymbol = Symbol.for('PrismaSchemaService')\nexport const SchemaTransformerSymbol = Symbol.for('SchemaTransformer')\nexport const PrismaUtilsSymbol = Symbol.for('PrismaUtils')\nexport const DataServiceSymbol = Symbol.for('DataService')\nexport const LegacySchemaServiceSymbol = Symbol.for('LegacySchemaService')\nexport const SchemaServiceSymbol = Symbol.for('SchemaService')\nexport const DynamicTableSchemaTransformerSymbol = Symbol.for('DynamicTableSchemaTransformer')\nexport const FlowdaTrpcClientSymbol = Symbol.for('FlowdaTrpcClient')\nexport const APISymbol = Symbol('API')\nexport const URLSymbol = Symbol.for('URL')\nexport const ENVSymbol = Symbol.for('ENV')\nexport const K3CloudIdentifyInfoSymbol = Symbol.for('K3CloudIdentifyInfo')\nexport const COSSymbol = Symbol('COS')\nexport const SmsClientSymbol = Symbol.for('SmsClient')\nexport const WechatOAuthSymbol = Symbol.for('WechatOAuth')\nexport const DynamicTableDataServiceSymbol = Symbol.for('DynamicTableDataService')\nexport const DynamicTableDefServiceSymbol = Symbol.for('DynamicTableDefService')\nexport const MenuServiceSymbol = Symbol.for('MenuService')\nexport const WechatpayNodeV3Symbol = Symbol.for('WechatpayNodeV3Symbol')\nexport const WechatpayNodeV3FactorySymbol = Symbol.for('WechatpayNodeV3FactorySymbol')\nexport const GatewayRegisterSymbol = Symbol.for('GatewayRegister')\nexport const AxiosInstanceSymbol = Symbol.for('AxiosInstance')\n","export type TFilterFormValue =\n  | string\n  | {\n      column: string | undefined\n      condition: string | undefined\n      value: string | undefined\n    }\n\nexport enum EPlan {\n  Free = 1,\n  VIP = 2,\n}\n\nexport const Serial_Min = 10001\nexport const Serial_Max = 99999\n","// 从 https://github.com/risen228/nestjs-zod 提取\n// 提取的原因是去掉 nestjs 等 node 依赖\nimport { ZodSchema, ZodTypeDef } from 'zod'\n\nexport interface ZodDto<TOutput = any, TDef extends ZodTypeDef = ZodTypeDef, TInput = TOutput> {\n  new (): TOutput\n\n  isZodDto: true\n  schema: ZodSchema<TOutput, TDef, TInput>\n\n  create(input: unknown): TOutput\n}\n\nexport function createZodDto<TOutput = any, TDef extends ZodTypeDef = ZodTypeDef, TInput = TOutput>(\n  schema: ZodSchema<TOutput, TDef, TInput>,\n) {\n  class AugmentedZodDto {\n    public static isZodDto = true\n    public static schema = schema\n\n    public static create(input: unknown) {\n      return this.schema.parse(input)\n    }\n  }\n\n  return AugmentedZodDto as unknown as ZodDto<TOutput, TDef, TInput>\n}\n","import { extendZod } from '@flowda/schema'\nimport { z } from 'zod'\nextendZod(z)\nexport const wmsCustomerSchema = z.object({\n  customerCode: z.string().openapi({\n    description: '客户编号',\n  }),\n  customerName: z.string().openapi({\n    description: '客户名称',\n  }),\n  masterId: z.string().openapi({\n    description: '货主id',\n  }),\n  contact: z.string().openapi({\n    description: '联系人',\n  }),\n  contactInfo: z.string().openapi({\n    description: '联系方式',\n  }),\n  status: z.union([z.literal(1), z.literal(9)]).openapi({\n    description: '状态1、启用 0、禁用',\n  }),\n  organizationId: z.string().openapi({\n    description: '组织Id',\n  }),\n})\n\nexport const wmsGoodsSchema = z.object({\n  goodsCode: z.string().openapi({\n    description: '货物编号',\n  }),\n  goodsName: z.string().openapi({\n    description: '货物名称',\n  }),\n  goodsTypeId: z.string().openapi({\n    description: '货物类型id',\n  }),\n  goodsAttribute: z.string().openapi({\n    description: '货物属性',\n  }),\n  masterId: z.string().openapi({\n    description: '货主信息',\n  }),\n  specification: z.string().openapi({\n    description: '规格型号',\n  }),\n  measurementUnit: z.string().openapi({\n    description: '计量单位',\n  }),\n  goodsPackageId: z.string().openapi({\n    description: '包装规格id',\n  }),\n  batchId: z.string().openapi({\n    description: '批次id',\n  }),\n  goodsInspectMode: z.number().openapi({\n    description: '货物检验方式1、全检2、抽检3、免检',\n  }),\n  length: z.number().openapi({\n    description: '长',\n  }),\n  width: z.number().openapi({\n    description: '宽',\n  }),\n  high: z.number().openapi({\n    description: '高',\n  }),\n  volume: z.number().openapi({\n    description: '体积',\n  }),\n  grossWeight: z.number().openapi({\n    description: '毛重',\n  }),\n  netWeight: z.number().openapi({\n    description: '净重',\n  }),\n  minStock: z.number().openapi({\n    description: '最低库存',\n  }),\n  maxStock: z.number().openapi({\n    description: '最高库存',\n  }),\n  maxStorageTime: z.number().openapi({\n    description: '最长储存时间',\n  }),\n  isAuto: z.number().openapi({\n    description: '是否自动化1、是 0、否',\n  }),\n  choppedQuantity: z.number().openapi({\n    description: '剁型每层数量',\n  }),\n  choppedLayer: z.number().openapi({\n    description: '剁型层数',\n  }),\n  goodsPicture: z.string().openapi({\n    description: '货物图片',\n  }),\n  fSeitBrand: z.string().openapi({\n    description: '品牌',\n  }),\n  fSeitCasePackage: z.string().openapi({\n    description: '封装',\n  }),\n  fSeitMsl: z.string().openapi({\n    description: 'MSL',\n  }),\n  fRefCost: z.string().openapi({\n    description: '单位成本',\n  }),\n  fSeitMpn: z.string().openapi({\n    description: 'MPN',\n  }),\n  status: z.number().openapi({\n    description: '状态1、启用 0、禁用',\n  }),\n  organizationId: z.number().openapi({\n    description: '组织id',\n  }),\n})\n\nexport const wmsGoodsMslSchema = z.object({\n  mslCode: z.string().openapi({ description: 'MSL' }),\n})\n\nexport const wmsGoodsUtilSchema = z.object({\n  unitId: z.string().openapi({ description: '计量单位id' }),\n  name: z.string().openapi({ description: '计量单位名称' }),\n  code: z.string().openapi({ description: '计量单位code' }),\n})\n\nexport const wmsStockSchema = z.object({\n  id: z.string().openapi({ description: 'erp仓库id' }),\n  code: z.string().openapi({ description: 'erp仓库编码' }),\n})\n\nexport const wmsSupplierSchema = z.object({\n  supplierCode: z.string().openapi({ description: '供应商编号' }),\n  supplierName: z.string().openapi({ description: '供应商名称' }),\n  masterId: z.string().openapi({ description: '货主id' }),\n  contact: z.string().openapi({ description: '联系人' }),\n  contactInfo: z.string().openapi({ description: '联系方式' }),\n  remark: z.string().openapi({ description: '备注' }),\n  status: z.number().openapi({ description: '状态1、启用 0、禁用' }),\n  organizationId: z.string().openapi({ description: '组织Id' }),\n})\n\nexport const wmsGoodsTypeSchema = z.object({\n  goodsTypeCode: z.string().openapi({ description: '货物类型编号' }),\n  goodsTypeName: z.string().openapi({ description: '货物类型名称' }),\n  status: z.number().openapi({ description: '状态1、启用 0、禁用' }),\n  organizationId: z.string().openapi({ description: '组织Id' }),\n})\n\nexport const wmsWarehousingItemSchema = z.object({\n  FBillNo: z.string().openapi({ description: '单据号' }),\n  FDate: z.string().openapi({ description: '入库日期' }),\n  FDocumentStatus: z.string().openapi({ description: '单据状态 Z：暂存，A：创建，B：审核，C：已审核，D：重新审核' }),\n  FMaterialId: z.string().openapi({ description: '物料编码' }),\n  FQty: z.string().openapi({ description: '数量' }),\n  FLot: z.string().openapi({ description: '批次号' }),\n  FStockId: z.string().openapi({ description: '仓库编码' }),\n})\n\nexport const wmsOEMReturnSchema = z.array(wmsWarehousingItemSchema)\n\nexport const wmsOEMWarehousingSchema = z.array(wmsWarehousingItemSchema)\n\nexport const wmsOtherWarehousingSchema = z.array(\n  wmsWarehousingItemSchema.extend({\n    FSupplierId: z.string().openapi({ description: '供应商编码' }),\n  }),\n)\n\nexport const wmsProduceReturnWarehousingSchema = z.array(\n  wmsWarehousingItemSchema.extend({\n    FAPPQty: z.string().openapi({ description: '申请数量' }),\n    FQty: z.string().openapi({ description: '实退数量' }),\n  }),\n)\n\nexport const wmsProduceWarehousingSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FMustQty: z.string().openapi({ description: '应收数量' }),\n      FRealQty: z.string().openapi({ description: '实收数量' }),\n    }),\n)\n\nexport const wmsPurchaseWarehousingSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FMustQty: z.string().openapi({ description: '应收数量' }),\n      FRealQty: z.string().openapi({ description: '实收数量' }),\n      FSupplierId: z.string().openapi({ description: '供应商编码' }),\n    }),\n)\n\nexport const wmsSubReturnWarehousingSchema = z.array(\n  wmsWarehousingItemSchema.extend({\n    FAPPQty: z.string().openapi({ description: '申请数量' }),\n    FQty: z.string().openapi({ description: '实退数量' }),\n  }),\n)\n\nexport const wmsPRDFeedMtrlSchema = z.array(\n  wmsWarehousingItemSchema.extend({\n    FActualQty: z.string().openapi({ description: '实发数量' }),\n  }),\n)\n\nexport const wmsUpdateWarehousingAuditToErpSchema = z.object({\n  orderType: z.number().openapi({ description: '单据类型' }),\n  sourceOrderCode: z.string().openapi({ description: '来源单据' }),\n})\n\nexport const wmsOEMAddOutWarehouseSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FActualQty: z.string().openapi({ description: '实发数量' }),\n    }),\n)\n\nexport const wmsOEMOutWarehouseSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FActualQty: z.string().openapi({ description: '实发数量' }),\n    }),\n)\n\nexport const wmsOtherOutWarehouseSchema = z.array(wmsWarehousingItemSchema)\nexport const wmsProduceOutWarehouseSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FActualQty: z.string().openapi({ description: '实发数量' }),\n    }),\n)\nexport const wmsPurchaseReturnOutWarehouseSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FRMREALQTY: z.string().openapi({ description: '实退数量' }),\n    }),\n)\n\nexport const wmsSaleOutWarehouseSchema = z.array(\n  wmsWarehousingItemSchema\n    .omit({\n      FQty: true,\n    })\n    .extend({\n      FCustomerID: z.string().openapi({ description: '客户编码' }),\n      FRealQty: z.string().openapi({ description: '实发数量' }),\n    }),\n)\n\nexport const wcsNoticeMouldIntoStockSchema = z\n  .object({\n    noticeId: z.number().openapi({ description: '单据号', example: 'XSCK00001' }),\n    goodsList: z.array(\n      z.object({\n        containerCode: z.string().openapi({ description: '箱码', example: 'containerCode' }),\n      }),\n    ),\n  })\n  .openapi({\n    title: 'wcsNoticeMouldIntoStockSchema',\n    example: { noticeId: '单据号' },\n  })\n\nexport const wcsNoticeMouldOutStockSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  goodsList: z.array(\n    z.object({\n      containerCode: z.string().openapi({ description: '箱码' }),\n      startLoc: z.string().optional().openapi({ description: '模具源库位' }),\n    }),\n  ),\n})\n\nexport const wmsMouldGetMouldTypeSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  containerCode: z.string().openapi({ description: '单个箱码' }),\n  loc: z.string().optional().openapi({ description: '单个箱库位' }),\n  type: z.union([z.literal('类型1'), z.literal('类型2'), z.literal('类型3')]),\n})\n\nexport const wmsMouldGetMouldTypeOutput1Schema = z.object({\n  success: z.boolean().openapi({ example: 'true' }),\n  noticeId: z.number().openapi({ description: '单据号' }),\n  containerCode: z.string().openapi({ description: '单个箱码' }),\n  startLoc: z.string().optional().openapi({ description: '箱初始库位' }),\n  type: z.union([z.literal('类型1'), z.literal('类型2'), z.literal('类型3')]),\n  endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n})\n\nexport const wmsMouldGetMouldTypeOutput2Schema = z.object({\n  success: z.boolean().openapi({ example: 'false' }),\n  message: z.string().openapi({ description: '失败原因' }),\n})\n\nexport const wmsMouldFinishSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  containerCode: z.string().openapi({ description: '单个箱码' }),\n  startLoc: z.string().optional().openapi({ description: '箱初始库位' }),\n  endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n  type: z.union([z.literal('类型1'), z.literal('类型2'), z.literal('类型3')]),\n})\n\nexport const wcsNoticeMaterialSendSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  goodsList: z.array(\n    z.object({\n      containerCode: z.string().openapi({ description: '箱码' }),\n      startLoc: z.string().optional().openapi({ description: '箱初始库位' }),\n      endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n    }),\n  ),\n})\n\nexport const wcsNoticeProductIntoStockSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  goodsList: z.array(\n    z.object({\n      containerCode: z.string().openapi({ description: '箱码' }),\n      endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n    }),\n  ),\n})\n\nexport const wcsNoticePlasticIntoStockSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  containerCode: z.string().openapi({ description: '箱码' }),\n  endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n  instructionType: z.union([\n    z.literal('上架指令1'),\n    z.literal('上架指令2'),\n    z.literal('上架指令3'),\n    z.literal('上架指令4'),\n  ]),\n})\n\nexport const wcsNoticeProduceReturnSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  goodsList: z.array(\n    z.object({\n      containerCode: z.string().openapi({ description: '箱码' }),\n      endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n    }),\n  ),\n})\n\nexport const wcsNoticeProductOutStockSchema = z.object({\n  noticeId: z.number().openapi({ description: '单据号' }),\n  goodsList: z.array(\n    z.object({\n      containerCode: z.string().openapi({ description: '箱码' }),\n      startLoc: z.string().optional().openapi({ description: '箱初始库位' }),\n      endLoc: z.string().optional().openapi({ description: '箱目标库位' }),\n    }),\n  ),\n})\n\nexport const callbackNoticePlasticIntoStockInputSchema = z.object({\n  containerCode: z.string().openapi({ description: '箱码' }),\n})\n\nexport const okResponse = z\n  .object({\n    success: z.literal(true),\n    message: z.string(),\n  })\n  .openapi({\n    title: 'okResponse',\n  })\n\nexport const notOkResponse = z\n  .object({\n    success: z.literal(false),\n    message: z.string(),\n  })\n  .openapi({\n    title: 'notOkResponse',\n  })\n\nexport const materialCode = z.string().openapi({ example: 'todo', description: '物料编码' })\nconst documentCode = z.string().openapi({ example: '', description: '单据号' })\n\nexport const srmGetDeliverDocListByCode = z\n  .object({\n    materialCode,\n  })\n  .openapi({ title: 'srmGetDeliverDocListByCode', description: '物料编码从二维码提取' })\n\nexport const srmGetDeliverDocListByCodeOkRes = z\n  .object({\n    documentCode: z.string().openapi({\n      example: 'todo',\n      description: '送货单号',\n    }),\n    materialList: z.array(\n      z.object({\n        materialCode: z.string().openapi({\n          description: '物料编码',\n          example: 'todo',\n        }),\n        type: z.string().openapi({\n          description: '物料类型（区分 VMI）',\n          example: 'todo',\n        }),\n      }),\n    ),\n  })\n  .openapi({ title: 'srmGetDeliverDocListByCodeOkRes', description: 'todo' })\n\nexport const apsCheckMaterialRequirement = z\n  .array(\n    z.object({\n      materialCode,\n    }),\n  )\n  .openapi({ title: 'srmCheckMaterialRequirement', description: '支持批量获取，覆盖集码场景' })\n\nexport const oaRequestMaterialNoExceedRequirement = z\n  .object({\n    note: z.string().openapi({ example: 'todo', description: '备注' }),\n  })\n  .openapi({\n    title: 'oaRequestMaterialNoExceedRequirement',\n  })\n\nexport const oaNotPass = z\n  .object({\n    reason: z.string().openapi({\n      example: 'todo',\n      description: '不通过原因',\n    }),\n  })\n  .openapi({\n    title: 'oaNotPass',\n  })\n\nexport const sapCheckMinMax = z\n  .array(\n    z.object({\n      materialCode,\n      qty: z.number().openapi({ example: 12, description: '物料数量' }),\n    }),\n  )\n  .openapi({\n    title: 'srmCheckMinMax',\n  })\n\nexport const sapCheckMinMaxRes = z\n  .array(\n    z.object({\n      materialCode,\n      qty: z.number().openapi({ example: 12, description: '当前库存量' }),\n      max: z.number().openapi({ example: 20, description: '最大库存量' }),\n    }),\n  )\n  .openapi({\n    title: 'sapCheckMinMaxRes',\n  })\n\nexport const oaRequestMaxStockApprove = z\n  .object({\n    note: z.string().openapi({ example: 'todo', description: '备注' }),\n  })\n  .openapi({\n    title: 'oaRequestMaxStockApprove',\n  })\n\nexport const todo = z\n  .object({\n    todo: z.string().openapi({ example: '', description: 'todo' }),\n  })\n  .openapi({ title: 'todo' })\n\nexport const sapGetQualityAssurance = z\n  .array(\n    z.object({\n      materialCode,\n    }),\n  )\n  .openapi({\n    title: 'sapGetQualityAssurance',\n    description: '支持批量',\n  })\n\nexport const getTodoPreReceiptInventoryFormRes = z\n  .array(\n    z.object({\n      documentCode: z.string().openapi({ description: '预收单号', example: 'todo' }),\n      materialList: z.array(\n        z.object({\n          materialCode: materialCode,\n          note: z.string().openapi({ description: '距离上次送货6个月以上' }),\n        }),\n      ),\n    }),\n  )\n  .openapi({\n    title: 'getTodoPreReceiptInventoryFormRes',\n  })\n\nexport const getQmsStatusByDocumentCodeType1Res = todo.openapi({\n  description: '退库',\n  title: 'getQmsStatusByDocumentCodeType1Res',\n})\n\nexport const getQmsStatusByDocumentCodeType2Res = todo.openapi({\n  description: '损耗',\n  title: 'getQmsStatusByDocumentCodeType2Res',\n})\n\nexport const getQmsStatusByDocumentCodeType3Res = todo.openapi({\n  description: '合格',\n  title: 'getQmsStatusByDocumentCodeType3Res',\n})\n\nexport const getQmsStatusByDocumentCodeType4Res = todo.openapi({\n  description: '让步接收',\n  title: 'getQmsStatusByDocumentCodeType4Res',\n})\n\nexport const getMaterialReturnRequestRes = z\n  .object({\n    documentCode: documentCode,\n    materialList: z.array(\n      z.object({\n        materialCode: materialCode,\n        isPlastic: z.string().openapi({ description: '是否是塑胶件' }),\n      }),\n    ),\n  })\n  .openapi({\n    title: 'getMaterialReturnRequestRes',\n    description: '包括工单退料和不合格品退料',\n  })\n","import { z } from 'zod'\nimport { createZodDto } from './zod-utils'\nimport { extendZod } from '@flowda/schema'\n\nextendZod(z)\n\nexport const selectOptionSchema = z.object({\n  value: z.union([z.string(), z.number()]),\n  label: z.string(),\n})\n\nexport const resourceAssociationSchema = z.object({\n  foreign_key: z.string(),\n  model_name: z.string(),\n  primary_key: z.string(),\n  name: z.string(),\n  slug: z.string(),\n  display_name: z.string(),\n  schema_name: z.string(),\n})\n\nexport const resourceColumnSchema = z.object({\n  name: z.string(),\n  access_type: z.enum(['read_only']).optional(),\n  column_type: z.enum(['reference', 'string', 'tag', 'integer', 'datetime', 'textarea', 'boolean']),\n  prisma: z.boolean().optional(),\n  format: z\n    .object({\n      select_options: selectOptionSchema.array(),\n    })\n    .optional(),\n  reference: z.object({\n    model_name: z.string(),\n    primary_key: z.string(),\n    display_name: z.string(),\n    display_column: z.union([z.string(), z.array(z.string()), z.undefined()]),\n    'x-relationField': z.string(),\n    'x-onSoftDelete': z.string(),\n    'x-unique': z.boolean().optional(),\n  }),\n  display_name: z.string().optional(),\n  validators: z.array(\n    z.union([\n      z.object({\n        required: z.boolean(),\n      }),\n      z.object({\n        format: z.string(),\n        message: z.string(),\n      }),\n    ]),\n  ),\n})\n\nexport const resourceSchema = z.object({\n  namespace: z.string().optional(),\n  prisma: z.boolean().optional(),\n  is_dynamic: z.boolean().optional(),\n  schema_name: z.string(),\n  name: z.string(),\n  slug: z.string(),\n  primary_key: z.string(),\n  'x-legacy': z.any(),\n  display_column: z.union([z.string(), z.array(z.string()), z.undefined()]),\n  display_name: z.string().nullable(),\n  display_primary_key: z.boolean(),\n  searchable_columns: z.array(z.string()).optional(),\n  columns: resourceColumnSchema.array(),\n  associations: resourceAssociationSchema.array(),\n  __jsonschema: z.any(),\n})\n\nexport const agFilterInnerSchema = z.object({\n  filterType: z.enum(['text', 'number']),\n  // filterType: z.string(),\n  type: z.enum(['contains', 'equals']),\n  // type: z.string(),\n  filter: z.union([z.string(), z.number()]),\n})\n\nexport const agFilterInner2Schema = z.object({\n  filterType: z.enum(['text']),\n  // filterType: z.string(),\n  operator: z.enum(['OR', 'AND']),\n  // operator: z.string(),\n  conditions: z.array(agFilterInnerSchema),\n})\n\nexport const agFilter1Schema = z.record(agFilterInnerSchema)\nexport type TAgFilter1Schema = z.infer<typeof agFilter1Schema>\nexport const agFilter2Schema = z.record(agFilterInner2Schema)\n\nexport const agFilterSchema = z\n  .record(agFilterInnerSchema.or(agFilterInner2Schema))\n  .or(z.object({ _ref: z.string().optional() }))\nexport type TAgFilterSchema = z.infer<typeof agFilterSchema>\n\nexport const agSortSchema = z.array(\n  z.object({\n    colId: z.string(),\n    sort: z.enum(['asc', 'desc']),\n  }),\n)\nexport type TAgSortSchema = z.infer<typeof agSortSchema>\n\nexport const prismaFilterSchema = z.object({\n  OR: z.array(z.record(z.record(z.enum(['contains']), z.string()))),\n})\nexport type IPrismaFilterSchema = z.infer<typeof prismaFilterSchema>\n\nexport type IResourceSchema = z.infer<typeof resourceSchema>\nexport type IResourceAssociationSchema = z.infer<typeof resourceAssociationSchema>\nexport type ISchemaSelectOption = z.infer<typeof selectOptionSchema>\nexport type IResourceColumnSchema = z.infer<typeof resourceColumnSchema>\n\nexport const registerSchema = z.object({\n  username: z.string(),\n  password: z.string(),\n  tenantId: z.number(),\n})\n\nexport class RegisterDto extends createZodDto(registerSchema) {}\n\nexport const accountExistsSchema = z.object({\n  username: z.string(),\n  tenantName: z.string(),\n})\n\nexport class AccountExistsSchemaDto extends createZodDto(accountExistsSchema) {}\n\nexport const validateSchema = z.object({\n  tenantId: z.number().optional(),\n  username: z.string(),\n  password: z.string(),\n})\n\nexport class validateSchemaDto extends createZodDto(validateSchema) {}\n\nexport const getTenantByNameSchema = z.object({\n  tenantName: z.string(),\n})\n\nexport class GetTenantByNameSchemaDto extends createZodDto(getTenantByNameSchema) {}\n\nexport const findByUnionIdAndTenantIdSchema = z.object({\n  unionid: z.string(),\n  tenantId: z.number(),\n})\n\nexport class FindByUnionIdAndTenantIdSchemaDto extends createZodDto(findByUnionIdAndTenantIdSchema) {}\n\nexport const registerByUnionIdSchema = z.object({\n  unionid: z.string(),\n  tenantId: z.number(),\n})\n\nexport class RegisterByUnionIdSchemaDto extends createZodDto(registerByUnionIdSchema) {}\n\nexport const resetPasswordSchema = z.object({\n  userId: z.number(),\n  tenantId: z.number(),\n  password: z.string(),\n})\n\nexport const _resetPasswordSchema = resetPasswordSchema.extend({\n  tid: z.number(),\n})\n\nexport class resetPasswordSchemaDto extends createZodDto(resetPasswordSchema) {}\n\nexport const verifyMobileSchema = z.object({\n  uid: z.number(),\n  tid: z.number(),\n  mobile: z.string(),\n  code: z.string(),\n  slug: z.string(),\n})\n\nexport class verifyMobileSchemaDto extends createZodDto(verifyMobileSchema) {}\n\nexport const tenantJwtPayloadSchema = z.object({\n  tid: z.number(),\n})\n\nexport const userJwtPayloadSchema = z.object({\n  uid: z.number(),\n  tid: z.number(),\n})\n\nexport class userJwtPayloadSchemaDto extends createZodDto(userJwtPayloadSchema) {}\n\nexport const customerPreSignupSchema = z.object({\n  email: z.string(),\n})\n\nexport class customerPreSignupSchemaDto extends createZodDto(customerPreSignupSchema) {}\n\nexport class customerPreSignupTenantJwtPayloadSchemaDto extends createZodDto(\n  customerPreSignupSchema.merge(tenantJwtPayloadSchema),\n) {}\n\nexport const customerSignupSchema = z.object({\n  email: z.string(),\n  verifyCode: z.string(),\n  password: z.string(),\n})\n\nexport class customerSignupSchemaDto extends createZodDto(customerSignupSchema) {}\n\nexport class customerSignupTenantJwtPayloadSchemaDto extends createZodDto(\n  customerSignupSchema.merge(tenantJwtPayloadSchema),\n) {}\n\nexport const wxGetAccessTokenRes = z.object({\n  access_token: z.string(),\n  expires_in: z.string(),\n  refresh_token: z.string(),\n  openid: z.string(),\n  scope: z.string(),\n  unionid: z.string(),\n  create_at: z.string(),\n})\nexport type TWxGetAccessTokenRes = z.infer<typeof wxGetAccessTokenRes>\n\nexport const wxGetUserRes = z.object({\n  openid: z.string(),\n  nickname: z.string(),\n  sex: z.number(),\n  headimgurl: z.string(),\n  unionid: z.string(),\n  language: z.string(),\n  city: z.string(),\n  province: z.string(),\n  country: z.string(),\n  privilege: z.array(z.string()),\n})\nexport type TWxGetUser = z.infer<typeof wxGetUserRes>\n\nexport const wxValidateUserSchema = z.object({\n  code: z.string(),\n})\n\nexport class wxValidateUserTenantJwtPayloadSchemaDto extends createZodDto(\n  wxValidateUserSchema.merge(tenantJwtPayloadSchema),\n) {}\n\nexport const generateRecoveryCodeSchema = z.object({\n  email: z.string(),\n})\n\nexport class generateRecoveryCodeSchemaDto extends createZodDto(generateRecoveryCodeSchema) {}\n\nexport class generateRecoveryCodeTenantJwtSchemaDto extends createZodDto(\n  generateRecoveryCodeSchema.merge(tenantJwtPayloadSchema),\n) {}\n\nexport class GenerateRecoveryCodeDto extends createZodDto(\n  generateRecoveryCodeSchema.merge(\n    z.object({\n      appId: z.string(),\n    }),\n  ),\n) {}\n\nexport const resetPasswordWithRecoveryCodeSchema = z.object({\n  recoveryCode: z.string(),\n  password: z.string(),\n})\n\nexport class resetPasswordWithRecoveryCodeSchemaDto extends createZodDto(resetPasswordWithRecoveryCodeSchema) {}\n\nexport class resetPasswordWithRecoveryCodeTenantJwtSchemaDto extends createZodDto(\n  resetPasswordWithRecoveryCodeSchema.merge(tenantJwtPayloadSchema),\n) {}\n\nexport class ResetPasswordDto extends createZodDto(\n  resetPasswordWithRecoveryCodeSchema.merge(\n    z.object({\n      appId: z.string(),\n    }),\n  ),\n) {}\n\nexport const productCreateManyItemSchema = z.object({\n  name: z.string(),\n  price: z.number(),\n  productType: z.string(),\n  amount: z.number().optional(),\n  plan: z.number().nullable().optional(),\n  extendedDescriptionData: z.any().optional(),\n  restricted: z.number().nullable().optional(),\n  fileSize: z.string().nullable().optional(),\n  storeDuration: z.number().nullable().optional(),\n  hasAds: z.string().nullable().optional(),\n  tecSupport: z.string().nullable().optional(),\n})\n\nexport class SdkProductCreateManyItemDto extends createZodDto(productCreateManyItemSchema) {}\n\nexport const updatePaidProfileSchema = z.object({\n  product: z.object({\n    productType: z.any(),\n    plan: z.number().nullable(),\n    amount: z.number().nullable(),\n    validityPeriod: z.number().nullable(),\n  }),\n})\n\nexport const updateFreeProfileSchema = z.object({\n  product: z.object({\n    productType: z.any(),\n    plan: z.number().nullable(),\n    amount: z.number().nullable(),\n    validityPeriod: z.number().nullable(),\n  }),\n})\n\nexport const wxPayQuerySchema = z.object({\n  status: z.number(),\n  trade_state: z.string(),\n  transaction_id: z.string(),\n  payer: z.object({\n    openid: z.string(),\n  }),\n})\n\nexport type TWxPayQuery = z.infer<typeof wxPayQuerySchema>\n\nexport const fwhLoginSchema = z.object({\n  code: z.string(),\n})\n\nexport class fwhLoginTenantJwtPayloadSchemaDto extends createZodDto(fwhLoginSchema.merge(tenantJwtPayloadSchema)) {}\n\nexport const amountUpdateSchema = z.object({\n  action: z.enum(['decrement']).optional(),\n  count: z.number().optional(),\n})\n\nexport class amountUpdateSchemaDto extends createZodDto(amountUpdateSchema) {}\n\nexport class amountUpdateUserJwtPayloadSchemaDto extends createZodDto(amountUpdateSchema.merge(userJwtPayloadSchema)) {}\n\nexport const createOrderSchema = z.object({\n  productId: z.string(),\n  openid: z.string().optional(),\n})\n\nexport class SdkCreateOrderDto extends createZodDto(createOrderSchema) {}\n\nexport class createOrderUserJwtPayloadSchemaDto extends createZodDto(createOrderSchema.merge(userJwtPayloadSchema)) {}\n\nexport const transactionsNativeSchema = z.object({\n  orderId: z.string(),\n  desc: z.string(),\n  total: z.number(),\n  openid: z.string().optional(),\n})\n\nexport class transactionsNativeSchemaDto extends createZodDto(transactionsNativeSchema) {}\n\nexport const createOrderJSAPISchema = createOrderSchema.extend({ openid: z.string() })\n\nexport class SdkCreateOrderInJSAPIDto extends createZodDto(createOrderJSAPISchema) {}\n\nexport const createQuickOrderSchema = createOrderSchema.extend({\n  // 快捷创建需要客户端提供一个匿名 Token\n  anonymousCustomerToken: z.string(),\n})\n\nexport class SdkCreateQuickOrderDto extends createZodDto(createQuickOrderSchema) {}\n\nexport class createQuickOrderTenantJWTPayloadSchemaDto extends createZodDto(\n  createQuickOrderSchema.merge(tenantJwtPayloadSchema),\n) {}\n\nexport const appCreateV4Schema = z.object({\n  displayName: z.string(),\n})\n\nexport class appCreateV4SchemaDto extends createZodDto(appCreateV4Schema) {}\n\nexport const validateTenantSchema = z.object({\n  name: z.string(),\n  password: z.string(),\n})\n\nexport class validateTenantSchemaDto extends createZodDto(validateTenantSchema) {}\n\nexport const validateByEmailSchema = z.object({\n  email: z.string(),\n  tenantId: z.number(),\n  password: z.string(),\n})\n\nexport class validateByEmailSchemaDto extends createZodDto(validateByEmailSchema) {}\n\nexport const _resetTenantPasswordSchema = z.object({\n  id: z.number(),\n})\n\nexport class _resetTenantPasswordSchemaDto extends createZodDto(_resetTenantPasswordSchema) {}\n\nexport const customerExtendDataSchema = z\n  .object({\n    biz: z.string(),\n    icp: z.string().nullable(),\n    contact: z\n      .object({\n        email: z.string(),\n        phone: z.string(),\n        address: z.string(),\n      })\n      .partial(),\n    companyName: z.string(),\n    description: z.string(),\n  })\n  .partial()\n\nexport class customerExtendDataSchemaDto extends createZodDto(customerExtendDataSchema) {}\n\nexport const kanzhunDetailSchema = z\n  .object({\n    公司全称: z.string(),\n    联系方式: z.array(z.string()),\n    地址: z.string(),\n    简介: z.string(),\n  })\n  .partial()\n\nexport class kanzhunDetailSchemaDto extends createZodDto(kanzhunDetailSchema) {}\n\nexport const kanzhunItemSchema = z\n  .object({\n    id: z.number(),\n    name: z.string(),\n    detail: kanzhunDetailSchema,\n  })\n  .partial()\n\nexport class kanzhunItemSchemaDto extends createZodDto(kanzhunItemSchema) {}\n\nexport const kanzhunDataSchema = z\n  .object({\n    date: z.string(),\n    data: z.array(kanzhunItemSchema),\n  })\n  .partial()\n\nexport const sendSmsVerifyCodeSchema = z.object({ mobile: z.string() })\n\nexport class sendSmsVerifyCodeSchemaDto extends createZodDto(sendSmsVerifyCodeSchema) {}\n\nexport const refreshTokenSchema = z.object({ rt: z.string() })\n\nexport class refreshTokenSchemaDto extends createZodDto(refreshTokenSchema) {}\n\nexport const loginSchema = z.object({\n  username: z.string(),\n  password: z.string().min(4),\n})\n\nexport class loginSchemaDto extends createZodDto(loginSchema) {}\n\nexport const getMenuByTenantNameSchema = z.object({\n  tenantName: z.string(),\n})\n\nexport class getMenuByTenantNameSchemaDto extends createZodDto(getMenuByTenantNameSchema) {}\n\nexport const getMenuSchema = z.object({\n  tenantId: z.number(),\n})\n\nexport class getMenuSchemaDto extends createZodDto(getMenuSchema) {}\n\n// https://github.com/colinhacks/zod/discussions/2245\nexport const baseMenuItemSchema = z.object({\n  name: z.string(),\n  slug: z.string(),\n  id: z.string(),\n})\n\nexport type MenuItem = z.infer<typeof baseMenuItemSchema> & {\n  children?: MenuItem[]\n}\n\nexport const menuItemSchema: z.ZodType<MenuItem> = baseMenuItemSchema.extend({\n  children: z.lazy(() => menuItemSchema.array().optional()),\n})\n\nexport class menuItemSchemaDto extends createZodDto(menuItemSchema) {}\n\nexport const deploySiteToCosSchema = z.object({\n  siteId: z.number(),\n})\n\nexport class deploySiteToCosSchemaDto extends createZodDto(deploySiteToCosSchema) {}\n\nconst StartSchema = z.object({\n  tenantId: z.string(),\n  processDefKey: z.string(),\n  businessKey: z.union([z.number(), z.string()]),\n})\n\nexport class StartSchemaDto extends createZodDto(StartSchema) {}\n\nconst GetTaskFormSchema = z.object({\n  taskId: z.string(),\n})\n\nexport class GetTaskFormSchemaDto extends createZodDto(GetTaskFormSchema) {}\n\nexport const getTasksSchema = z.object({\n  tenantIdIn: z.array(z.string()),\n})\n","import { ContainerModule, interfaces } from 'inversify'\nimport { z } from 'zod'\n\nimport {\n  DataServiceSymbol,\n  DynamicTableSchemaTransformerSymbol,\n  LegacySchemaServiceSymbol,\n  PrismaSchemaServiceSymbol,\n  PrismaUtilsSymbol,\n  SchemaServiceSymbol,\n  SchemaTransformerSymbol,\n} from '@flowda-projects/flowda-shared-types'\nimport { PrismaSchemaService } from './services/schema/prismaSchema.service'\nimport { DataService } from './services/data/data.service'\nimport { LegacySchemaService } from './services/schema/legacySchemaService'\nimport { SchemaTransformer } from './services/schema/schemaTransformer'\nimport { PrismaUtils } from './services/schema/prismaUtils'\nimport { bindServiceSymbol } from '@flowda/schema'\nimport { DynamicTableSchemaTransformer } from './services/schema/dynamicTableSchemaTransformer'\nimport { SchemaService } from './services/schema/schema.service'\n\nexport const flowdaSharedModule = new ContainerModule((bind: interfaces.Bind) => {\n  bindServiceSymbol(bind, DataServiceSymbol, DataService)\n  bindServiceSymbol(bind, LegacySchemaServiceSymbol, LegacySchemaService)\n\n  bind(SchemaServiceSymbol).to(SchemaService).inSingletonScope()\n\n  bind<PrismaSchemaService>(PrismaSchemaServiceSymbol).to(PrismaSchemaService).inSingletonScope()\n  bind<PrismaUtils>(PrismaUtilsSymbol).to(PrismaUtils).inSingletonScope()\n\n  bind<SchemaTransformer>(SchemaTransformerSymbol).to(SchemaTransformer).inTransientScope()\n  bind<interfaces.Factory<SchemaTransformer>>('Factory<SchemaTransformer>').toFactory<SchemaTransformer, [any]>(\n    context => {\n      return (z: z.AnyZodObject) => {\n        const transformer = context.container.get<SchemaTransformer>(SchemaTransformerSymbol)\n        transformer.setZodType(z)\n        return transformer\n      }\n    },\n  )\n  bind<DynamicTableSchemaTransformer>(DynamicTableSchemaTransformerSymbol)\n    .to(DynamicTableSchemaTransformer)\n    .inTransientScope()\n})\n","export { DataServiceSymbol, SchemaServiceSymbol } from '@flowda-projects/flowda-shared-types'\n\nexport * from './flowdaShared.module'\nexport * from './utils/matchPath'\nexport * from './utils/browser-log-utils'\nexport * from './utils/ag-grid-utils'\nexport * from './utils/schema-utils'\nexport * from './utils/custom-error'\nexport * from './utils/dayjs-utils'\n\nexport * from './services/schema/meta'\nexport * from './services/schema/schemaTransformer'\nexport * from './services/schema/dynamicTableSchemaTransformer'\nexport * from './services/schema/legacySchemaService'\nexport * from './services/schema/schema.service'\nexport * from './services/data/data.service'\n","import { inject, injectable } from 'inversify'\nimport * as _ from 'radash'\nimport { lowerFirst } from 'lodash'\nimport type { LoggerService } from '@nestjs/common'\nimport type { PrismaSchemaService } from '../schema/prismaSchema.service'\nimport { PrismaClientSymbol } from '@flowda/types'\nimport { PrismaSchemaServiceSymbol } from '@flowda-projects/flowda-shared-types'\n// import * as db from '@prisma/client-cms_admin'\n\n/*\ntodo: 增加 reference_type 区分是如何做 nest\ne.g. Customer#weixinProfile 和 Order#customerId 的 nest 查询有区别\n */\n@injectable()\nexport class DataService {\n  private readonly logger\n\n  constructor(\n    // todo: prisma 要不要强类型\n    // @inject(PrismaClientSymbol) private prisma: db.PrismaClient,\n    @inject(PrismaClientSymbol) private prisma: any,\n    @inject(PrismaSchemaServiceSymbol) private prismaSchemaService: PrismaSchemaService,\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n  ) {\n    this.logger = loggerFactory(DataService.name)\n  }\n\n  async get(reqUser: any, pathname: string, query: Record<string, any>) {\n    this.logger.log(`get(reqUser ${JSON.stringify(reqUser)}, path: ${pathname}, query: ${JSON.stringify(query)})`)\n    const findParamRet = await this.prismaSchemaService.toFindParam(pathname, query)\n    if (_.isEmpty(findParamRet)) {\n      return {}\n    }\n    const { resource, action, param } = findParamRet\n    if (action === 'findUnique') {\n      const ret = await this.prisma[resource][action](param)\n      if (!ret || ret.isDeleted) return {}\n      return _.omit(ret, ['isDeleted']) as any\n    }\n    if (action === 'findMany') {\n      const [data, count] = await this.prisma.$transaction([\n        this.prisma[resource][action](param),\n        this.prisma[resource].count({ where: param.where }),\n      ])\n      return {\n        pagination: {\n          total: count,\n        },\n        data,\n      }\n    }\n  }\n\n  async put(reqUser: any, path: string, values: any) {\n    this.logger.log(`put(reqUser ${JSON.stringify(reqUser)}), path: ${path}, values: ${JSON.stringify(values)}`)\n    const updateParamRet = await this.prismaSchemaService.toUpdateParam(path, values)\n    const { resource, param } = updateParamRet\n    const prevRet = await this.prisma[resource].findUnique({\n      where: {\n        id: param.where.id,\n      },\n      select: _.mapValues(param.data, item => true),\n    })\n    const auditChanges = Object.keys(param.data).reduce<Record<string, [string, string]>>((acc, k) => {\n      acc[k] = [prevRet[k], param.data[k]]\n      return acc\n    }, {})\n    const ret = await this.prisma[resource].update(param)\n    const auditInfo = {\n      auditId: param.where.id as number,\n      auditType: resource,\n      userId: JSON.stringify(reqUser['user_id'] || reqUser['uid']), // todo: 暂时兼容 java 和 node\n      username: reqUser['user_name'],\n      action: 'update',\n      auditChanges: JSON.stringify(auditChanges),\n      version: 0,\n    }\n    this.logger.debug!(`audit ${JSON.stringify(auditInfo)}`)\n    try {\n      await this.prisma.audits.create({\n        data: auditInfo,\n      })\n    } catch (e) {\n      this.logger.warn(`audit create failed, ${JSON.stringify(auditInfo)}`)\n    }\n    return ret\n  }\n\n  async post(reqUser: any, path: string, values: any) {\n    this.logger.log(`[post] reqUser ${JSON.stringify(reqUser)}, path: ${path}, query: ${JSON.stringify(values)})`)\n    const createParamRet = await this.prismaSchemaService.toCreateParam(path, values)\n    const { resource, param } = createParamRet\n\n    if (createParamRet['x-unique']) {\n      const ref = createParamRet['x-unique']\n      const refId = values[ref.name!]\n      const refModelName = ref.reference!.model_name\n      const refData = await this.prisma[lowerFirst(refModelName)].findUnique({\n        where: {\n          id: refId,\n        },\n        include: {\n          [resource]: true,\n        },\n      })\n      const id = refData[resource].id\n      const ret = await this.prisma[resource].update({\n        where: {\n          id: id,\n        },\n        data: {\n          ...param.data,\n          ...{\n            isDeleted: false,\n          },\n        },\n      })\n\n      const auditInfo = {\n        auditId: id,\n        auditType: resource,\n        userId: JSON.stringify(reqUser['user_id'] || reqUser['uid']), // todo: 暂时兼容 java 和 node\n        username: reqUser['user_name'],\n        action: 'soft_delete_revert',\n        auditChanges: JSON.stringify(param.data),\n        version: 0,\n      }\n      this.logger.debug!(`audit ${JSON.stringify(auditInfo)}`)\n      try {\n        await this.prisma.audits.create({\n          data: auditInfo,\n        })\n      } catch (e) {\n        this.logger.warn(`audit create failed, ${JSON.stringify(auditInfo)}`)\n      }\n      return ret\n    } else {\n      const ret = await this.prisma[resource].create(param)\n      const auditInfo = {\n        auditId: ret.id,\n        auditType: resource,\n        userId: JSON.stringify(reqUser['user_id'] || reqUser['uid']), // todo: 暂时兼容 java 和 node\n        username: reqUser['user_name'],\n        action: 'create',\n        auditChanges: JSON.stringify(param.data),\n        version: 0,\n      }\n      this.logger.debug!(`audit ${JSON.stringify(auditInfo)}`)\n      try {\n        await this.prisma.audits.create({\n          data: auditInfo,\n        })\n      } catch (e) {\n        this.logger.warn(`audit create failed, ${JSON.stringify(auditInfo)}`)\n      }\n\n      return ret\n    }\n  }\n\n  async remove(reqUser: any, pathname: string) {\n    this.logger.log(`[remove] reqUser ${JSON.stringify(reqUser)}, path: ${pathname}`)\n    const assDelStrategy = await this.prismaSchemaService.getAssociationDeleteStrategy(pathname)\n    const { resource, param } = await this.prismaSchemaService.toRemoveParam(pathname)\n    for (const k of Object.keys(assDelStrategy)) {\n      const ass = assDelStrategy[k]\n      if (ass['x-onSoftDelete'] === 'Restrict') {\n        const ret = await this.prisma[lowerFirst(k)].findMany({\n          where: {\n            isDeleted: false,\n            [ass.name]: param.where.id,\n          },\n        })\n        if (ret.length > 0) {\n          throw new Error(`删除失败, 关联的<${ass.relatedDisplayName}>不为空`)\n        }\n      }\n    }\n\n    const prevRet = await this.prisma[resource].findUnique({\n      where: {\n        id: param.where.id,\n      },\n    })\n    const ret = await this.prisma[resource].update(param)\n\n    const auditInfo = {\n      auditId: param.where.id,\n      auditType: resource,\n      userId: JSON.stringify(reqUser['user_id'] || reqUser['uid']), // todo: 暂时兼容 java 和 node\n      username: reqUser['user_name'],\n      action: 'soft_delete',\n      auditChanges: JSON.stringify(prevRet),\n      version: 0,\n    }\n    this.logger.debug!(`audit ${JSON.stringify(auditInfo)}`)\n    try {\n      await this.prisma.audits.create({\n        data: auditInfo,\n      })\n    } catch (e) {\n      this.logger.warn(`audit create failed, ${JSON.stringify(auditInfo)}`)\n    }\n    return ret\n  }\n}\n","import type { LoggerService } from '@nestjs/common'\nimport { inject, injectable } from 'inversify'\nimport { toModelName, toPath, toSchemaName } from '../../utils/matchPath'\n\n@injectable()\nexport class DynamicTableSchemaTransformer {\n  private readonly logger: LoggerService\n\n  constructor(@inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService) {\n    this.logger = loggerFactory(DynamicTableSchemaTransformer.name)\n  }\n\n  transform(input: any) {\n    const cols = input.dynamicTableDefColumns.map((c: any) => {\n      return Object.assign(\n        {\n          name: c.name,\n          column_type: c.type,\n        },\n        c.extendedSchema,\n      )\n    })\n    return Object.assign(\n      {\n        name: toModelName(input.name),\n        slug: toPath(input.name),\n        schema_name: toSchemaName(input.name),\n        primary_key: 'id',\n        columns: cols,\n        prisma: false,\n        is_dynamic: true,\n      },\n      input.extendedSchema,\n    )\n  }\n}\n","import { z } from 'zod'\nimport { inject, injectable } from 'inversify'\nimport type { LoggerService } from '@nestjs/common'\nimport type { SchemaTransformer } from './schemaTransformer'\nimport { CustomZodSchemaSymbol } from '@flowda/types'\nimport type { IResourceSchema } from '@flowda-projects/flowda-shared-types'\n\n@injectable()\nexport class LegacySchemaService {\n  private readonly logger\n  private schemaCache?: Record<string, IResourceSchema>\n\n  constructor(\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n    @inject('Factory<SchemaTransformer>') private modelSchemaFactory: (z: z.AnyZodObject) => SchemaTransformer,\n    @inject(CustomZodSchemaSymbol) private czt: any,\n  ) {\n    this.logger = loggerFactory(LegacySchemaService.name)\n  }\n\n  getSchema(): Record<string, IResourceSchema> {\n    console.time('generate schema')\n    const schema = Object.keys(this.czt).reduce((acc: any, k) => {\n      const e = this.czt[k]\n      if (['ZodObject'].indexOf(e.constructor.name) > -1) {\n        const transformer = this.modelSchemaFactory(e)\n        acc[k] = transformer.buildSchema().toSchema(k)\n      } else {\n        this.logger.error('Wrong type', k)\n      }\n      return acc\n    }, {})\n    this.schemaCache = schema\n    console.timeEnd('generate schema')\n    return schema\n  }\n\n  async getSchemaCache(): Promise<Record<string, IResourceSchema>> {\n    if (!this.schemaCache) {\n      // 重启的话内存里就没有了，可以手动重新获取下\n      this.logger.log(`schemaCache is empty, getSchema again.`)\n      return this.getSchema()\n    } else {\n      return this.schemaCache\n    }\n  }\n}\n","import { z } from 'zod'\n// motor-admin JSON.parse(document.getElementById('app').dataset.schema)\n// todo: 目前尽量在后端定义，后续可以再开辟一条链路来储存 schema，并进行 merge\n// 当然如果后端定义链路保留，应该做成 decorator\n\nexport function meta(values: any) {\n  return z.unknown().optional().describe(JSON.stringify(values))\n}\n","import { LoggerService } from '@nestjs/common'\nimport { inject, injectable } from 'inversify'\nimport * as qs from 'qs'\nimport { isLikeNumber, matchPath, toModelName } from '../../utils/matchPath'\nimport type { LegacySchemaService } from './legacySchemaService'\nimport { forEach, isUndefined, omitBy, set } from 'lodash'\nimport * as _ from 'radash'\nimport type {\n  IPrismaFilterSchema,\n  IResourceSchema,\n  TAgFilterSchema,\n  TFilterFormValue,\n} from '@flowda-projects/flowda-shared-types'\nimport {\n  agFilter1Schema,\n  agFilter2Schema,\n  PrismaUtilsSymbol,\n  LegacySchemaServiceSymbol,\n} from '@flowda-projects/flowda-shared-types'\nimport type { PrismaUtils } from './prismaUtils'\n\n@injectable()\nexport class PrismaSchemaService {\n  private readonly logger\n\n  constructor(\n    @inject(PrismaUtilsSymbol) private prismaUtils: PrismaUtils,\n    @inject(LegacySchemaServiceSymbol) private schemaService: LegacySchemaService,\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n  ) {\n    this.logger = loggerFactory(PrismaSchemaService.name)\n  }\n\n  toPrismaSelect(fields: string | undefined, theResourceSchema: IResourceSchema) {\n    let fieldsArr: string[] = []\n    if (fields == null) {\n      fieldsArr = theResourceSchema\n        .columns!.filter(c => {\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          if (c?.['x-legacy']) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return c['x-legacy'].prisma !== false\n          }\n\n          return c.prisma !== false\n        })\n        .map(c => c.name!)\n    } else {\n      fieldsArr = fields.split(',')\n    }\n    return fieldsArr.reduce((acc: Record<string, boolean>, cur: string) => {\n      acc[cur] = true\n      return acc\n    }, {})\n  }\n\n  async toFindParam(\n    pathname: string,\n    query: qs.ParsedQs,\n  ): Promise<\n    | {\n        action: 'findUnique' | 'findMany'\n        resource: string\n        param: any\n      }\n    | Record<string, never>\n  > {\n    // if (!query['fields']) {\n    //   throw new Error('No query fields')\n    // }\n\n    this.logger.debug!(`[toFindParam] pathname: ${pathname}, query: ${JSON.stringify(query)}`)\n\n    const parsedPath = matchPath(pathname)\n    if (parsedPath.length === 0) return Promise.resolve({})\n    const last = parsedPath[parsedPath.length - 1]\n\n    const parent = parsedPath[parsedPath.length - 2]\n    // console.log(parent)\n    let lastResource = last.resource\n    let lastResourceSchema = last.resourceSchema\n    const schemaCache = await this.schemaService.getSchemaCache()\n\n    if (parent /* 如果是 association */) {\n      const parentSchema = schemaCache[parent.resourceSchema]\n      const assoRet = parentSchema.associations.find(ass => ass.slug === last.origin)\n      if (assoRet) {\n        lastResourceSchema = assoRet?.schema_name\n        lastResource = _.camel(assoRet.model_name)\n      }\n    }\n    const theResourceSchema = schemaCache[lastResourceSchema]\n\n    let action: 'findUnique' | 'findMany'\n    let param = {}\n\n    const queryFields = query['fields'] as qs.ParsedQs\n    const fields = this.toPrismaSelect(\n      queryFields && (queryFields[lastResource] as string | undefined),\n      theResourceSchema,\n    )\n\n    const include: Record<string, any> = {}\n\n    if (typeof query['include'] === 'string' && query['include'] !== '') {\n      query['include'].split(',').forEach((inc: string) => {\n        // this.logger.log(`[toFindParam] parse include ${inc}`)\n        const refSelect: any = this.getRefSelect(schemaCache, theResourceSchema, inc)\n        const selectRet = this.toPrismaSelect(queryFields[inc] as string, theResourceSchema)\n        include[inc] = {\n          // todo: 似乎 prisma nest select 不支持 order by 只有 include 支持，但是 include 不支持 nest select fields\n          // orderBy: [{ createdAt: 'desc' }],\n          select: { ...selectRet, ...refSelect },\n        }\n      })\n    }\n\n    if (last.id != null) {\n      action = 'findUnique'\n      const id2 = await this.prismaUtils.parseId(lastResource, last.id)\n      param = {\n        where: {\n          id: id2,\n        },\n        select: { ...fields, ...include, ...{ isDeleted: true } },\n      }\n    } else {\n      const filter = this.convertQueryToPrismaFilter(schemaCache, theResourceSchema, query)\n\n      const orderBy = this.convertToOrderBy(query)\n\n      action = 'findMany'\n      const skip = query['current'] ? (Number(query['current']) - 1) * Number(query['pageSize']) : undefined\n      const take = query['pageSize'] ? Number(query['pageSize']) : undefined\n      if (parsedPath.length > 1) {\n        // 情况1：根据前一个 resource id 搜索 list\n        const pResource = parsedPath[parsedPath.length - 2]\n        // this.logger.log(`${resource}.findMany`)\n        param = omitBy(\n          {\n            where: {\n              ...{\n                [`${pResource.resource}Id`]: pResource.id,\n                isDeleted: false,\n              },\n              ...filter,\n            },\n            orderBy,\n            skip,\n            take,\n            select: { ...fields, ...include },\n          },\n          isUndefined,\n        )\n      } else {\n        param = omitBy(\n          {\n            where: {\n              ...{\n                isDeleted: false,\n              },\n              ...filter,\n            },\n            orderBy,\n            skip,\n            take,\n            select: { ...fields, ...include },\n          },\n          isUndefined,\n        )\n      }\n    }\n    const ret = {\n      action,\n      param,\n      resource: lastResource,\n    }\n    this.logger.debug!(`[toFindParam] ret ${JSON.stringify(ret)}`)\n    return ret\n  }\n\n  convertToOrderBy(query: any) {\n    let sort: string\n    if (query.sort != null) {\n      sort = query.sort\n    } else {\n      return [{ createdAt: 'desc' }]\n    }\n\n    if (sort[0] === '-') {\n      return [{ [sort.slice(1)]: 'desc' }]\n    } else {\n      return [{ [sort]: 'asc' }]\n    }\n  }\n\n  /**\n   * 根据 resource 的 schema 中 columns 是 ref， e.g. resource(Receipt) 收货单关联的 ref(partVersion)\n   * 找到对应 refSchema 的 display_column 中的又 include e.g. display_column(partId)，得到 nest select\n   * { [include: partVersion]: { select { partId: true, [partId x-relationField: part]: { select: { id: true, [display_column*]: true} }}} }\n   *\n   * todo: 现在是根据 display_column 里如果有 ref 来计算的，后续可以改成所有 ref 都默认向下搜索一层\n   */\n  getRefSelect(schemaCache: Record<string, IResourceSchema>, resourceSchema: IResourceSchema, includeRef: string) {\n    const refSelect: any = {}\n    if (resourceSchema && resourceSchema.columns) {\n      // e.g. inc partVersion\n      const refColumn = resourceSchema.columns.find(\n        col => col.column_type === 'reference' && col.reference!['x-relationField'] === includeRef,\n      )\n      if (refColumn) {\n        // e.g. model_name PartVersion\n        // e.g. display_column partId,version\n        const { model_name, display_column } = refColumn.reference!\n        // e.g. PartVersionResourceSchema\n        const refSchema = schemaCache[model_name + 'ResourceSchema']\n        let displayCols: string[] = []\n        if (typeof display_column === 'string') {\n          displayCols = [display_column]\n        } else {\n          displayCols = (display_column as string[]) || []\n        }\n        displayCols.forEach(item => {\n          // e.g. item partId\n          const disCol = refSchema.columns!.find(col => col.name === item)\n          if (disCol == null) {\n            throw new Error(`schema '${model_name}', wrong display column '${item}'`)\n          } else if (disCol.column_type === 'reference') {\n            // e.g. name\n            const display_column = disCol!.reference!.display_column!\n            const relationField = disCol!.reference!['x-relationField']\n\n            let display_column2: string[]\n            if (Array.isArray(display_column)) {\n              display_column2 = display_column\n            } else {\n              display_column2 = [display_column]\n            }\n            const select = display_column2.reduce((acc, cur) => {\n              acc[cur] = true\n              return acc\n            }, {} as Record<string, boolean>)\n\n            refSelect[relationField] = {\n              select: Object.assign(\n                {\n                  id: true,\n                },\n                select,\n              ),\n            }\n          }\n        })\n      }\n    }\n    return refSelect\n  }\n\n  /*\n    [\n      {\n        type: { eq: 'UNSCHEDULE' },\n        status: { eq: 'DONE' },\n      },\n    ]\n   */\n  convertQueryToPrismaFilter(\n    schemaCache: Record<string, IResourceSchema>,\n    resourceSchema: IResourceSchema,\n    query: any,\n  ) {\n    if (query.filterModel) {\n      return this.convertAgFilterModelToPrismaFilter(query.filterModel)\n    } else if (query.filter && Array.isArray(query.filter) && query.filter.length > 0) {\n      // console.log(query.filter)\n      const filter = query.filter as TFilterFormValue[]\n      const andIdx = filter.findIndex(item => typeof item === 'string' && item === 'AND')\n      const orIdx = filter.findIndex(item => typeof item === 'string' && item === 'OR')\n      const ret: any = {}\n\n      if (andIdx === 0) {\n        ret['AND'] = []\n        if (orIdx === -1) {\n          const andFilter = filter.slice(1)\n          andFilter.forEach(item => ret['AND'].push(this.mapItemToPrismaFilter(schemaCache, resourceSchema, item)))\n        } else {\n          const andFilter = filter.slice(1, orIdx)\n          andFilter.forEach(item => ret['AND'].push(this.mapItemToPrismaFilter(schemaCache, resourceSchema, item)))\n          ret['OR'] = []\n          const orFilter = filter.slice(orIdx + 1)\n          orFilter.forEach(item => ret['OR'].push(this.mapItemToPrismaFilter(schemaCache, resourceSchema, item)))\n        }\n      } else if (orIdx === 0) {\n        ret['OR'] = []\n        if (andIdx === -1) {\n          const orFilter = filter.slice(1)\n          orFilter.forEach(item => ret['OR'].push(this.mapItemToPrismaFilter(schemaCache, resourceSchema, item)))\n        } else {\n          const orFilter = filter.slice(1, andIdx)\n          orFilter.forEach(item => ret['OR'].push(this.mapItemToPrismaFilter(schemaCache, resourceSchema, item)))\n          ret['AND'] = []\n          const andFilter = filter.slice(andIdx + 1)\n          andFilter.forEach(item => ret['AND'].push(this.mapItemToPrismaFilter(schemaCache, resourceSchema, item)))\n        }\n      } else {\n        throw new Error('Wrong filter')\n      }\n      return ret\n    } else if (\n      query.q != null &&\n      Array.isArray(resourceSchema.searchable_columns) &&\n      resourceSchema.searchable_columns.length > 0\n    ) {\n      return {\n        OR: resourceSchema.searchable_columns.reduce((acc, cur) => {\n          acc.push({ [cur]: { contains: query.q } })\n          return acc\n        }, [] as any[]),\n      }\n    } else {\n      return {}\n    }\n  }\n\n  convertAgFilterModelToPrismaFilter(agFilter: TAgFilterSchema) {\n    const parsedRet = agFilter1Schema.safeParse(agFilter)\n    if (parsedRet.success) {\n      return _.mapValues(parsedRet.data, (v, k) => {\n        return {\n          [v.type]: v.filter,\n        }\n      })\n    } else {\n      const parsedRet = agFilter2Schema.safeParse(agFilter)\n      if (parsedRet.success) {\n        const ret: IPrismaFilterSchema = {} as IPrismaFilterSchema\n        for (const k of Object.keys(parsedRet.data)) {\n          const item = parsedRet.data[k]\n          if (item.operator === 'OR') {\n            if (ret.OR == null) {\n              ret.OR = []\n            }\n            for (const cond of item.conditions) {\n              ret.OR.push({\n                [k]: {\n                  [cond.type]: cond.filter,\n                },\n              })\n            }\n          }\n        }\n        return ret\n      } else {\n        return {}\n      }\n    }\n  }\n\n  async toUpdateParam(pathname: string, values: any) {\n    this.logger.debug!(`pathname: ${pathname}, body: ${JSON.stringify(values)}`)\n\n    const matchRet = matchPath(pathname)\n    const { resource, id, resourceSchema } = matchRet[matchRet.length - 1]\n    const schemaCache = await this.schemaService.getSchemaCache()\n\n    this.removeRelationFields(schemaCache, resourceSchema, values)\n    const ret = {\n      resource,\n      param: {\n        where: { id: id },\n        data: values,\n      },\n    }\n    this.logger.debug!(JSON.stringify(ret))\n    return ret\n  }\n\n  // todo: 需要增加 relation name\n  async getAssociationDeleteStrategy(pathname: string) {\n    const matchRet = matchPath(pathname)\n    const { origin, resourceSchema } = matchRet[matchRet.length - 1]\n    const schemaCache = await this.schemaService.getSchemaCache()\n    const theResourceSchema = schemaCache[resourceSchema]\n    if (theResourceSchema.associations == null) {\n      return {}\n    }\n    const ret = theResourceSchema.associations.reduce((acc, cur) => {\n      const assSchema = schemaCache[cur.model_name + 'ResourceSchema']\n      if (assSchema == null) {\n        throw new Error(`${resourceSchema} associated schema ${cur.model_name} is null`)\n      }\n      const relCol = assSchema.columns!.find(\n        ac => ac.column_type === 'reference' && ac.reference!.model_name === toModelName(origin),\n      )\n      if (relCol == null) {\n        throw new Error('Cannot found related column')\n      }\n      if (relCol.reference!['x-onSoftDelete'] === 'Restrict') {\n        acc[cur.model_name] = {\n          'x-onSoftDelete': relCol.reference!['x-onSoftDelete'],\n          name: relCol.name,\n          relatedDisplayName: assSchema.display_name,\n        }\n        return acc\n      }\n      return acc\n    }, {} as any)\n    return ret\n  }\n\n  async toRemoveParam(pathname: string) {\n    const matchRet = matchPath(pathname)\n    const { resource, origin, id, resourceSchema } = matchRet[matchRet.length - 1]\n    const schemaCache = await this.schemaService.getSchemaCache()\n    const theResourceSchema = schemaCache[resourceSchema]\n    let assDisconnect: any = {}\n    let include: any\n    if (theResourceSchema.associations != null) {\n      assDisconnect = theResourceSchema.associations.reduce((acc, cur) => {\n        const assSchema = schemaCache[cur.model_name + 'ResourceSchema']\n        const relCol = assSchema.columns!.find(\n          ac => ac.column_type === 'reference' && ac.reference!.model_name === toModelName(origin),\n        )\n        if (relCol == null) {\n          throw new Error('Cannot found related column')\n        }\n        if (relCol.reference!['x-onSoftDelete'] !== 'Restrict' /* Restrict 已经确保 is_deleted 不需要解除关联 */) {\n          acc[cur.name] = {\n            set: [] /* disconnectAll 模拟 setNull */,\n          }\n          if (include == null) include = {}\n          include[cur.name] = true\n        }\n        return acc\n      }, {} as any)\n    }\n\n    let id2: string | number\n    if (id == null) {\n      throw new Error(`remove ${resource}, id null`)\n    } else {\n      id2 = await this.prismaUtils.parseId(resource, id)\n    }\n    const ret = {\n      resource,\n      param: {\n        where: {\n          id: id2,\n        },\n        data: Object.assign(\n          {\n            isDeleted: true,\n          },\n          assDisconnect,\n        ),\n        include,\n      },\n    }\n    this.logger.debug!(JSON.stringify(ret))\n    return ret\n  }\n\n  mapItemToPrismaFilter(\n    schemaCache: Record<string, Partial<IResourceSchema>>,\n    resourceSchema: Partial<IResourceSchema>,\n    item: any,\n  ) {\n    // 先初步转换\n    const k = Object.keys(item)[0]\n    // https://javascript.plainenglish.io/how-to-rename-object-keys-in-react-javascript-using-lodash-b73fb92ea24d\n    item[k] = _.mapKeys<string, string, string>(item[k], (k, v) => {\n      switch (k) {\n        case 'eq':\n          return 'equals'\n        case 'neq':\n          return 'not'\n        default:\n          return k\n      }\n    })\n\n    item[k] = _.mapValues<string, string, string | number>(item[k], v => {\n      // 得用 schema 判断下，主要就是 string 的 LIKE\n      const kk = k.split('.')\n      let col\n      if (kk.length === 2) {\n        const refCol = resourceSchema.columns!.find(col => {\n          return col.column_type === 'reference' && col.reference!['x-relationField'] === kk[0]\n        })\n        const refSchema = schemaCache[refCol!.reference!.model_name + 'ResourceSchema']\n        col = refSchema.columns!.find(item => item.name === kk[1])\n      } else {\n        col = resourceSchema.columns!.find(item => item.name === k)\n      }\n      if (col && ['string', 'textarea'].indexOf(col.column_type!) > -1) {\n        return v\n      } else if (isLikeNumber(v)) {\n        return Number(v)\n      } else {\n        return v\n      }\n    })\n\n    // 再将 . 改成嵌套（chatGPT 给出的方式）\n    const ret = {}\n    forEach(item, (value, key) => {\n      set(ret, key.replace(/\\./g, '.'), value)\n    })\n    return ret\n  }\n\n  async toCreateParam(pathname: string, values: any) {\n    const matchRet = matchPath(pathname)\n    // console.log(matchRet)\n    const { resource, resourceSchema } = matchRet[matchRet.length - 1]\n    const schemaCache = await this.schemaService.getSchemaCache()\n    this.removeRelationFields(schemaCache, resourceSchema, values)\n    const theResourceSchema = schemaCache[resourceSchema]\n    // console.log(theResourceSchema)\n\n    const uniqueCols = theResourceSchema.columns!.filter(col => {\n      return col.column_type === 'reference' && col.reference!['x-unique']\n    })\n\n    if (uniqueCols.length === 0) {\n      return {\n        action: 'create',\n        resource: resource,\n        param: {\n          data: values,\n        },\n      }\n    } else if (uniqueCols.length > 1) {\n      throw new Error('Not support multiple unique key')\n    } else {\n      const uniqueCol = uniqueCols[0]\n      // console.log(uniqueCol)\n      return {\n        action: 'update',\n        resource: resource,\n        param: {\n          data: values,\n        },\n        'x-unique': uniqueCol,\n      }\n    }\n  }\n\n  removeRelationFields(schemaCache: Record<string, Partial<IResourceSchema>>, resourceSchema: string, values: any) {\n    // todo: 目前是通过显式声明 x-relationField 来删除 put 时候的 reference 值\n    const relationFields: string[] = []\n    const theResourceSchema = schemaCache[resourceSchema]\n    // console.log(theResourceSchema)\n    if (theResourceSchema) {\n      Object.keys(values).forEach((k: string) => {\n        const kProp = theResourceSchema.columns && theResourceSchema.columns.find(col => col.name === k)\n        if (kProp && kProp.column_type === 'reference') {\n          const relationField = kProp.reference?.['x-relationField']\n          if (relationField) {\n            relationFields.push(relationField)\n          }\n        }\n      })\n    }\n    relationFields.forEach(k => {\n      delete values[k]\n    })\n  }\n}\n","import { inject, injectable } from 'inversify'\nimport { toModelName } from '../../utils/matchPath'\nimport { PrismaClientSymbol } from '@flowda/types'\nimport type { LoggerService } from '@nestjs/common'\n\n@injectable()\nexport class PrismaUtils {\n  private readonly logger\n\n  constructor(\n    // todo: prisma 要不要强类型\n    // @inject(PrismaClientSymbol) private prisma: db.PrismaClient,\n    @inject(PrismaClientSymbol) private prisma: any,\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n  ) {\n    this.logger = loggerFactory(PrismaUtils.name)\n  }\n\n  async parseId(resource: string, id: string | number) {\n    const modelName = toModelName(resource)\n    const dmmf = await this.prisma._getDmmf()\n    const idField = dmmf.modelMap[modelName].fields.find((item: any) => item.name === 'id')\n    // this.logger.log(`id: ${id}, type: ${idField.type}`)\n    return idField.type === 'Int' && typeof id !== 'number' ? parseInt(id) : id\n  }\n}\n","import { z } from 'zod'\nimport { inject, injectable } from 'inversify'\nimport type { LoggerService } from '@nestjs/common'\nimport type { SchemaTransformer } from './schemaTransformer'\nimport { CustomZodSchemaSymbol } from '@flowda/types'\nimport { ResourceUISchema } from '@flowda/types'\n\n@injectable()\nexport class SchemaService {\n  private readonly logger\n  private schemaCache?: Record<string, z.infer<typeof ResourceUISchema>>\n\n  constructor(\n    @inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService,\n    @inject('Factory<SchemaTransformer>') private modelSchemaFactory: (z: z.AnyZodObject) => SchemaTransformer,\n    @inject(CustomZodSchemaSymbol) private czt: any,\n  ) {\n    this.logger = loggerFactory(SchemaService.name)\n  }\n\n  getSchema(): Record<string, z.infer<typeof ResourceUISchema>> {\n    console.time('generate schema')\n    const schema = Object.keys(this.czt).reduce((acc: any, k) => {\n      const e = this.czt[k]\n      if (['ZodObject'].indexOf(e.constructor.name) > -1) {\n        const transformer = this.modelSchemaFactory(e)\n        acc[k] = transformer.buildSchema().toSchema(k)\n      } else {\n        this.logger.error('Wrong type', k)\n      }\n      return acc\n    }, {})\n    this.schemaCache = schema\n    console.timeEnd('generate schema')\n    return schema\n  }\n\n  async getSchemaCache(): Promise<Record<string, z.infer<typeof ResourceUISchema>>> {\n    if (!this.schemaCache) {\n      // 重启的话内存里就没有了，可以手动重新获取下\n      this.logger.log(`schemaCache is empty, getSchema again.`)\n      return this.getSchema()\n    } else {\n      return this.schemaCache\n    }\n  }\n}\n","import { z } from 'zod'\nimport { inject, injectable } from 'inversify'\nimport type { LoggerService } from '@nestjs/common'\nimport { SchemaTransformer as NewSchemaTransformer, zodToOpenAPI } from '@flowda/schema'\nimport { modelNameToSchemaName } from '../../utils/matchPath'\n\n@injectable()\nexport class SchemaTransformer {\n  private readonly logger\n  private zodType?: z.AnyZodObject\n  private jsonschema: any\n\n  constructor(@inject('Factory<Logger>') loggerFactory: (name: string) => LoggerService) {\n    this.logger = loggerFactory(SchemaTransformer.name)\n  }\n\n  setZodType(z: z.AnyZodObject) {\n    this.zodType = z\n  }\n\n  buildSchema(): SchemaTransformer {\n    if (!this.zodType) {\n      const errMsg = 'zodType is not initialized'\n      this.logger.error(errMsg)\n      throw new Error(errMsg)\n    }\n    this.jsonschema = zodToOpenAPI(this.zodType)\n    return this\n  }\n\n  toSchema(schemaName: string) {\n    const json = new NewSchemaTransformer().set(this.jsonschema).toJSON()\n    //    ^?\n    if (!json.slug) throw new Error(`no slug, ${JSON.stringify(json)}`)\n    return {\n      ...json,\n      schema_name: schemaName,\n      columns: json.columns\n        ?.filter(f => f.name !== 'isDeleted')\n        .map(col => {\n          return {\n            ...col,\n            // 'x-legacy': undefined, // Theia 使用 x-legacy\n            // 以下是兼容原来\n            ...(col as any)['x-legacy'],\n            prisma:\n              (col as any)?.['x-legacy']?.prisma && (col as any)['x-legacy'].prisma === 'false' ? false : undefined,\n          }\n        }),\n      associations: json.associations?.map(ass => {\n        return {\n          ...ass,\n          schema_name: modelNameToSchemaName(ass.model_name),\n        }\n      }),\n    }\n  }\n}\n","import type { TAgSortSchema } from '@flowda-projects/flowda-shared-types'\n\nexport function convertSortAgToMotor(sort: TAgSortSchema) {\n  return sort[0] != null ? (sort[0].sort === 'asc' ? sort[0].colId : '-' + sort[0].colId) : undefined\n}\n","const levelColorMap: Record<string, string> = {\n  0: '#c0392b', // Red\n  1: '#f39c12', // Yellow\n  3: '#00BCD4', // Cyan\n  4: '#ccc',\n}\n\nfunction style(level: number) {\n  return `\n  background: ${levelColorMap[level]};\n  border-radius: 0.5em;\n  color: white;\n  font-weight: bold;\n  padding: 2px 0.5em;\n`\n}\n\nexport function debug(msg: string) {\n  return [`%c debug `, style(4), '', msg]\n}\n\nexport function info(msg: string) {\n  return [`%c info `, style(3), '', msg]\n}\n\nexport function warn(msg: string) {\n  return [`%c warn `, style(1), '', msg]\n}\n\nexport function error(msg: string) {\n  return [`%c error `, style(0), '', msg]\n}\n","export class CustomError extends Error {\n  public override message\n\n  constructor(code: number, message: string, extra?: any) {\n    super(JSON.stringify({ code: code, message }))\n    this.message = JSON.stringify({ code, message, extra })\n  }\n}\n","import utc from 'dayjs/plugin/utc'\nimport timezone from 'dayjs/plugin/timezone'\nimport advancedFormat from 'dayjs/plugin/advancedFormat'\n\nimport dayjs from 'dayjs'\n\ndayjs.extend(utc)\ndayjs.extend(timezone)\ndayjs.extend(advancedFormat)\n\nexport function getTimeExpire(min: number) {\n  const fmt = dayjs().tz('Asia/Shanghai').add(min, 'minute').format('YYYY-MM-DDTHH:mm:ss+z')\n  const ret = fmt.match(/.*(GMT\\+(\\d))/)\n  if (ret == null) {\n    return ''\n  } else {\n    return ret[0].replace(ret[1], ret[2].padStart(2, '0') + ':00')\n  }\n}\n\nexport function getTimeByDay(day: number): Date {\n  return dayjs().tz('Asia/Shanghai').add(day, 'day').toDate()\n}\n","import * as plur from 'pluralize'\nimport * as _ from 'lodash'\n\nplur.addSingularRule(/data$/i, 'data')\nplur.addPluralRule(/data$/i, 'data')\nplur.addSingularRule(/def$/i, 'def')\nplur.addPluralRule(/def$/i, 'def')\nplur.addSingularRule(/sms$/i, 'sms')\nplur.addPluralRule(/sms$/i, 'sms')\n\n// 兼容用复数表示表，一般不用复数做表名称\nplur.addSingularRule(/ProjectUsers$/i, 'ProjectUsers')\nplur.addPluralRule(/ProjectUsers$/i, 'ProjectUsers')\n\n// s* equipment 不可数\nconst REG = /(([a-z_]+s*)\\/?([A-Za-z0-9-_:]+)?)+/g\n\nconst NUM_REG = /^-?\\d+(\\.\\d+)?$/\n\nexport type TMatchPath = {\n  origin: string\n  resource: string\n  resourceSchema: string\n  id?: string | number\n}\n\n// todo: 暂时没想到更精确的方法，这个应该能覆盖 100%\nexport function isLikeNumber(value: string) {\n  return NUM_REG.test(value)\n}\n\nexport function toModelName(slug: string) {\n  return _.startCase(_.camelCase(plur.singular(slug))).replace(/ /g, '')\n}\n\nexport function toPath(modelName: string) {\n  return plur.plural(_.snakeCase(modelName))\n}\n\n/**\n * @deprecated slug 转成 ResourceSchema 不准确\n * @see modelNameToSchemaName\n * @param slug\n */\nexport function toSchemaName(slug: string) {\n  const p = plur.singular(slug)\n  return toModelName(p) + 'ResourceSchema'\n}\n\nexport function modelNameToSchemaName(modelName: string) {\n  const p = plur.singular(modelName)\n  return p + 'ResourceSchema'\n}\n\nexport function matchPath(path: string): TMatchPath[] {\n  const ret1 = path.match(REG)\n  // console.log(ret1)\n  if (ret1 != null) {\n    const ret2 = ret1.map(item => {\n      const [resource, id] = item.split('/')\n\n      const p = plur.singular(resource)\n      return {\n        resource: _.camelCase(p),\n        resourceSchema: toSchemaName(resource),\n        origin: resource,\n        id: isLikeNumber(id) ? _.toNumber(id) : id,\n      }\n    })\n    return ret2\n  } else {\n    return []\n  }\n}\n","import { IResourceSchema } from '@flowda-projects/flowda-shared-types'\n\nexport function getSchemaByDisplayName(schemaCache: Record<string, IResourceSchema>, displayName: string) {\n  const k = Object.keys(schemaCache).find(k => {\n    return schemaCache[k].display_name === displayName\n  })\n  if (k) {\n    return schemaCache[k]\n  } else {\n    return null\n  }\n}\n","module.exports = require(\"@flowda/schema\");","module.exports = require(\"@flowda/types\");","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/core\");","module.exports = require(\"@trpc/client\");","module.exports = require(\"@trpc/server\");","module.exports = require(\"@trpc/server/adapters/express\");","module.exports = require(\"axios\");","module.exports = require(\"consola\");","module.exports = require(\"dayjs\");","module.exports = require(\"dayjs/plugin/advancedFormat\");","module.exports = require(\"dayjs/plugin/timezone\");","module.exports = require(\"dayjs/plugin/utc\");","module.exports = require(\"http-proxy-middleware\");","module.exports = require(\"inversify\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"lodash\");","module.exports = require(\"nestjs-zod\");","module.exports = require(\"passport-jwt\");","module.exports = require(\"pluralize\");","module.exports = require(\"qs\");","module.exports = require(\"radash\");","module.exports = require(\"tslib\");","module.exports = require(\"znv\");","module.exports = require(\"zod\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { Logger } from '@nestjs/common'\nimport { NestFactory } from '@nestjs/core'\n\nimport { AppModule } from './app/app.module'\nimport { FLOWDA_GATEWAY_ENV, TrpcRouter } from '@flowda-projects/flowda-gateway-trpc-server'\nimport { createProxyMiddleware } from 'http-proxy-middleware'\nimport { ExtractJwt } from 'passport-jwt'\nimport type { JwtPayload } from 'jsonwebtoken'\nimport * as jwt from 'jsonwebtoken'\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule)\n\n  app.enableCors()\n  const globalPrefix = 'flowda-gateway-api'\n  app.setGlobalPrefix(globalPrefix)\n\n  const trpc = app.get(TrpcRouter)\n  trpc.applyMiddleware(app, globalPrefix)\n\n  app.use((req, res, next) => {\n    if (req.originalUrl.includes('favicon.ico')) {\n      res.status(204).end()\n    } else if (req.url.indexOf(`/${globalPrefix}/camunda/engine-rest/`) > -1) {\n      const extract = ExtractJwt.fromAuthHeaderAsBearerToken()\n      const bearerToken = extract(req)\n      if (bearerToken) {\n        try {\n          const authed = jwt.verify(bearerToken, FLOWDA_GATEWAY_ENV.ACCESS_TOKEN_SECRET) as JwtPayload\n          if (authed) {\n            next()\n          } else {\n            res.status(401).json({\n              message: '[PROXY] Unauthorized',\n            })\n          }\n        } catch (e) {\n          res.status(401).json({\n            message: '[PROXY] Unauthorized',\n          })\n        }\n      } else {\n        res.status(401).json({\n          message: '[PROXY] Unauthorized',\n        })\n      }\n    } else {\n      next()\n    }\n  })\n\n  // Proxy endpoints\n  app.use(\n    `/${globalPrefix}/camunda/engine-rest`,\n    createProxyMiddleware({\n      logLevel: 'debug',\n      target: FLOWDA_GATEWAY_ENV.C7_REST_URL,\n      changeOrigin: true,\n      onProxyReq(proxyReq) {\n        // camunda rest api 需要设置请求头，否则报错 npe\n        proxyReq.setHeader('Content-Type', 'application/json')\n        proxyReq.setHeader('Accept', 'application/json')\n      },\n      pathRewrite: {\n        [`^/${globalPrefix}/camunda/engine-rest`]: '/engine-rest',\n      },\n    }),\n  )\n\n  const port = process.env.PORT || 3310\n  await app.listen(port)\n  Logger.log(`🚀 Application is running on: http://localhost:${port}/${globalPrefix}`)\n}\n\nbootstrap()\n"],"names":["AppController","constructor","hi","Get","Controller","AppModule","Module","imports","ServicesModule","controllers","providers","provide","APP_PIPE","useClass","ZodValidationPipe","console","log","Object","keys","FLOWDA_GATEWAY_ENV","forEach","k","container","load","flowdaGatewayTrpcServerModule","bind","toFactory","context","name","Logger","servicesContainer","Container","loadModule","services","getServices","Global","exports","axiosApiInstance","create","interceptors","request","use","config","url","info","path","qstr","split","method","JSON","stringify","qs","parse","data","error","Promise","reject","response","parseEnv","process","env","ACCESS_TOKEN_SECRET","z","string","min","FLOWDA_URL","CMS_ADMIN_URL","YONGCHENG_URL","TIANBAO_URL","C7_REST_URL","ContainerModule","AxiosInstanceSymbol","toConstantValue","GatewayRegisterSymbol","to","GatewayRegister","inSingletonScope","onActivation","injectable","register","id","trpcEndpoint","TrpcService","toSelf","ContextFactory","HelloRouter","bindService","TrpcRouter","flowdaTrpc","createTRPCProxyClient","links","httpBatchLink","headers","transformer","input","serialize","object","deserialize","output","loggerFactory","_services","this","logger","serv","Array","isArray","s","registerItem","find","warn","push","getTrpc","serviceId","Error","inject","trpc","axios","gatewayRegister","helloRouter","router","validate","procedure","username","password","mutation","user","mutate","createRoot","any","query","opts","visible","children","map","v","rest","selected","expanded","resolveChildren","protectedProcedure","pid","tenantName","parentId","menuData","menu","getMenuByTenantName","convertMenuToTheia","getResourceSchema","getResourceInputSchema","ctx","service","tenant","theSchema","result","schemaName","namespace","getResourceData","getResourceDataInputSchema","getSchema","uniqParam","findUniqueResourceDataInputSchema","safeParse","manyParam","findManyResourceDataInputSchema","success","slug","pageSize","current","sort","convertSortAgToMotor","filterModel","encodeURIComponent","putResourceData","putResourceDataInputSchema","values","updatedValue","mapMenuItemToTheiaMenu","menuItem","uri","length","undefined","toSchemaName","traverse","tree","visit","child","item","ret","createContext","diag","contextFactory","appRouter","hello","applyMiddleware","app","globalPrefix","trpcExpress","createExpressMiddleware","initTRPC","errorFormatter","at","processAt","req","authorization","payload","verifyAccessToken","jwt","userRet","findUnique","ctxUserSchema","e","TRPCError","code","next","mergeRouters","trim","PrismaSchemaServiceSymbol","Symbol","for","SchemaTransformerSymbol","PrismaUtilsSymbol","DataServiceSymbol","LegacySchemaServiceSymbol","SchemaServiceSymbol","DynamicTableSchemaTransformerSymbol","FlowdaTrpcClientSymbol","APISymbol","URLSymbol","ENVSymbol","K3CloudIdentifyInfoSymbol","COSSymbol","SmsClientSymbol","WechatOAuthSymbol","DynamicTableDataServiceSymbol","DynamicTableDefServiceSymbol","MenuServiceSymbol","WechatpayNodeV3Symbol","WechatpayNodeV3FactorySymbol","EPlan","Serial_Min","Serial_Max","schema","AugmentedZodDto","isZodDto","extendZod","wmsCustomerSchema","customerCode","openapi","description","customerName","masterId","contact","contactInfo","status","union","literal","organizationId","wmsGoodsSchema","goodsCode","goodsName","goodsTypeId","goodsAttribute","specification","measurementUnit","goodsPackageId","batchId","goodsInspectMode","number","width","high","volume","grossWeight","netWeight","minStock","maxStock","maxStorageTime","isAuto","choppedQuantity","choppedLayer","goodsPicture","fSeitBrand","fSeitCasePackage","fSeitMsl","fRefCost","fSeitMpn","wmsGoodsMslSchema","mslCode","wmsGoodsUtilSchema","unitId","wmsStockSchema","wmsSupplierSchema","supplierCode","supplierName","remark","wmsGoodsTypeSchema","goodsTypeCode","goodsTypeName","wmsWarehousingItemSchema","FBillNo","FDate","FDocumentStatus","FMaterialId","FQty","FLot","FStockId","wmsOEMReturnSchema","array","wmsOEMWarehousingSchema","wmsOtherWarehousingSchema","extend","FSupplierId","wmsProduceReturnWarehousingSchema","FAPPQty","wmsProduceWarehousingSchema","omit","FMustQty","FRealQty","wmsPurchaseWarehousingSchema","wmsSubReturnWarehousingSchema","wmsPRDFeedMtrlSchema","FActualQty","wmsUpdateWarehousingAuditToErpSchema","orderType","sourceOrderCode","wmsOEMAddOutWarehouseSchema","wmsOEMOutWarehouseSchema","wmsOtherOutWarehouseSchema","wmsProduceOutWarehouseSchema","wmsPurchaseReturnOutWarehouseSchema","FRMREALQTY","wmsSaleOutWarehouseSchema","FCustomerID","wcsNoticeMouldIntoStockSchema","noticeId","example","goodsList","containerCode","title","wcsNoticeMouldOutStockSchema","startLoc","optional","wmsMouldGetMouldTypeSchema","loc","type","wmsMouldGetMouldTypeOutput1Schema","boolean","endLoc","wmsMouldGetMouldTypeOutput2Schema","message","wmsMouldFinishSchema","wcsNoticeMaterialSendSchema","wcsNoticeProductIntoStockSchema","wcsNoticePlasticIntoStockSchema","instructionType","wcsNoticeProduceReturnSchema","wcsNoticeProductOutStockSchema","callbackNoticePlasticIntoStockInputSchema","okResponse","notOkResponse","materialCode","documentCode","srmGetDeliverDocListByCode","srmGetDeliverDocListByCodeOkRes","materialList","apsCheckMaterialRequirement","oaRequestMaterialNoExceedRequirement","note","oaNotPass","reason","sapCheckMinMax","qty","sapCheckMinMaxRes","max","oaRequestMaxStockApprove","todo","sapGetQualityAssurance","getTodoPreReceiptInventoryFormRes","getQmsStatusByDocumentCodeType1Res","getQmsStatusByDocumentCodeType2Res","getQmsStatusByDocumentCodeType3Res","getQmsStatusByDocumentCodeType4Res","getMaterialReturnRequestRes","isPlastic","selectOptionSchema","value","label","resourceAssociationSchema","foreign_key","model_name","primary_key","display_name","schema_name","resourceColumnSchema","access_type","enum","column_type","prisma","format","select_options","reference","display_column","validators","required","resourceSchema","is_dynamic","nullable","display_primary_key","searchable_columns","columns","associations","__jsonschema","agFilterInnerSchema","filterType","filter","agFilterInner2Schema","operator","conditions","agFilter1Schema","record","agFilter2Schema","agFilterSchema","or","_ref","agSortSchema","colId","prismaFilterSchema","OR","registerSchema","tenantId","RegisterDto","createZodDto","accountExistsSchema","AccountExistsSchemaDto","validateSchema","validateSchemaDto","getTenantByNameSchema","GetTenantByNameSchemaDto","findByUnionIdAndTenantIdSchema","unionid","FindByUnionIdAndTenantIdSchemaDto","registerByUnionIdSchema","RegisterByUnionIdSchemaDto","resetPasswordSchema","userId","_resetPasswordSchema","tid","resetPasswordSchemaDto","verifyMobileSchema","uid","mobile","verifyMobileSchemaDto","tenantJwtPayloadSchema","userJwtPayloadSchema","userJwtPayloadSchemaDto","customerPreSignupSchema","email","customerPreSignupSchemaDto","customerPreSignupTenantJwtPayloadSchemaDto","merge","customerSignupSchema","verifyCode","customerSignupSchemaDto","customerSignupTenantJwtPayloadSchemaDto","wxGetAccessTokenRes","access_token","expires_in","refresh_token","openid","scope","create_at","wxGetUserRes","nickname","sex","headimgurl","language","city","province","country","privilege","wxValidateUserSchema","wxValidateUserTenantJwtPayloadSchemaDto","generateRecoveryCodeSchema","generateRecoveryCodeSchemaDto","generateRecoveryCodeTenantJwtSchemaDto","GenerateRecoveryCodeDto","appId","resetPasswordWithRecoveryCodeSchema","recoveryCode","resetPasswordWithRecoveryCodeSchemaDto","resetPasswordWithRecoveryCodeTenantJwtSchemaDto","ResetPasswordDto","productCreateManyItemSchema","price","productType","amount","plan","extendedDescriptionData","restricted","fileSize","storeDuration","hasAds","tecSupport","SdkProductCreateManyItemDto","updatePaidProfileSchema","product","validityPeriod","updateFreeProfileSchema","wxPayQuerySchema","trade_state","transaction_id","payer","fwhLoginSchema","fwhLoginTenantJwtPayloadSchemaDto","amountUpdateSchema","action","count","amountUpdateSchemaDto","amountUpdateUserJwtPayloadSchemaDto","createOrderSchema","productId","SdkCreateOrderDto","createOrderUserJwtPayloadSchemaDto","transactionsNativeSchema","orderId","desc","total","transactionsNativeSchemaDto","createOrderJSAPISchema","SdkCreateOrderInJSAPIDto","createQuickOrderSchema","anonymousCustomerToken","SdkCreateQuickOrderDto","createQuickOrderTenantJWTPayloadSchemaDto","appCreateV4Schema","displayName","appCreateV4SchemaDto","validateTenantSchema","validateTenantSchemaDto","validateByEmailSchema","validateByEmailSchemaDto","_resetTenantPasswordSchema","_resetTenantPasswordSchemaDto","customerExtendDataSchema","biz","icp","phone","address","partial","companyName","customerExtendDataSchemaDto","kanzhunDetailSchema","kanzhunDetailSchemaDto","kanzhunItemSchema","detail","kanzhunItemSchemaDto","kanzhunDataSchema","date","sendSmsVerifyCodeSchema","sendSmsVerifyCodeSchemaDto","refreshTokenSchema","rt","refreshTokenSchemaDto","loginSchema","loginSchemaDto","getMenuByTenantNameSchema","getMenuByTenantNameSchemaDto","getMenuSchema","getMenuSchemaDto","baseMenuItemSchema","menuItemSchema","lazy","menuItemSchemaDto","deploySiteToCosSchema","siteId","deploySiteToCosSchemaDto","StartSchema","processDefKey","businessKey","StartSchemaDto","GetTaskFormSchema","taskId","GetTaskFormSchemaDto","getTasksSchema","tenantIdIn","flowdaSharedModule","bindServiceSymbol","DataService","LegacySchemaService","SchemaService","PrismaSchemaService","PrismaUtils","SchemaTransformer","inTransientScope","get","setZodType","DynamicTableSchemaTransformer","prismaSchemaService","reqUser","pathname","findParamRet","toFindParam","_","isEmpty","resource","param","isDeleted","$transaction","where","pagination","put","updateParamRet","toUpdateParam","prevRet","select","mapValues","auditChanges","reduce","acc","update","auditInfo","auditId","auditType","version","debug","audits","post","createParamRet","toCreateParam","ref","refId","refModelName","lowerFirst","include","remove","assDelStrategy","getAssociationDeleteStrategy","toRemoveParam","ass","findMany","relatedDisplayName","PrismaClientSymbol","transform","cols","dynamicTableDefColumns","c","assign","extendedSchema","toModelName","toPath","modelSchemaFactory","czt","time","indexOf","buildSchema","toSchema","schemaCache","timeEnd","getSchemaCache","CustomZodSchemaSymbol","unknown","describe","prismaUtils","schemaService","toPrismaSelect","fields","theResourceSchema","fieldsArr","cur","parsedPath","matchPath","resolve","last","parent","lastResource","lastResourceSchema","assoRet","origin","camel","queryFields","inc","refSelect","getRefSelect","selectRet","parseId","convertQueryToPrismaFilter","orderBy","convertToOrderBy","skip","Number","take","pResource","omitBy","isUndefined","createdAt","slice","includeRef","refColumn","col","refSchema","displayCols","disCol","relationField","display_column2","convertAgFilterModelToPrismaFilter","andIdx","findIndex","orIdx","mapItemToPrismaFilter","q","contains","agFilter","parsedRet","cond","matchRet","removeRelationFields","assSchema","relCol","ac","id2","assDisconnect","set","mapKeys","kk","refCol","isLikeNumber","key","replace","uniqueCols","uniqueCol","relationFields","kProp","modelName","_getDmmf","modelMap","parseInt","zodType","errMsg","jsonschema","zodToOpenAPI","json","toJSON","f","modelNameToSchemaName","levelColorMap","style","level","msg","CustomError","extra","super","tz","add","match","padStart","day","toDate","plur","addSingularRule","addPluralRule","REG","NUM_REG","test","startCase","camelCase","singular","plural","snakeCase","ret1","p","toNumber","module","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","NestFactory","enableCors","setGlobalPrefix","res","originalUrl","includes","end","bearerToken","ExtractJwt","fromAuthHeaderAsBearerToken","extract","verify","createProxyMiddleware","logLevel","target","changeOrigin","onProxyReq","proxyReq","setHeader","pathRewrite","port","PORT","listen","bootstrap"],"sourceRoot":""}